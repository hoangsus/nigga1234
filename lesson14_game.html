<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Game Luy·ªán T·∫≠p Ti·∫øng ƒê·ª©c - T·ª´ V·ª±ng & Chia ƒê·ªông T·ª´</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: #333;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      .header {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 30px;
        text-align: center;
        margin-bottom: 30px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        position: relative;
      }

      .header h1 {
        color: #4a47a3;
        font-size: 2.5em;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      }

      .header p {
        color: #666;
        font-size: 1.2em;
        margin-bottom: 20px;
      }

      .stats {
        display: flex;
        justify-content: center;
        gap: 30px;
        flex-wrap: wrap;
      }

      .stat-item {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 15px 25px;
        border-radius: 15px;
        text-align: center;
        min-width: 120px;
      }

      .stat-number {
        font-size: 2em;
        font-weight: bold;
        display: block;
      }

      .game-modes {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .game-mode {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 25px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        border: 3px solid transparent;
      }

      .game-mode:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        border-color: #667eea;
      }

      .game-mode.active {
        border-color: #4a47a3;
        background: linear-gradient(135deg, #f8f9ff 0%, #f0f2ff 100%);
      }

      .game-mode.conjugation {
        border-color: #ff6b6b;
      }

      .game-mode.conjugation:hover {
        border-color: #ff5252;
      }

      .game-mode.vocabulary {
        border-color: #28a745;
      }

      .game-mode.vocabulary:hover {
        border-color: #218838;
      }

      .mode-icon {
        font-size: 3em;
        margin-bottom: 15px;
        display: block;
      }

      .mode-title {
        font-size: 1.4em;
        font-weight: bold;
        color: #4a47a3;
        margin-bottom: 10px;
      }

      .game-mode.conjugation .mode-title {
        color: #ff6b6b;
      }

      .game-mode.vocabulary .mode-title {
        color: #28a745;
      }

      .mode-description {
        color: #666;
        font-size: 0.9em;
        line-height: 1.4;
      }

      .mode-progress {
        margin-top: 10px;
        font-size: 0.8em;
        color: #666;
        font-weight: bold;
      }

      .mode-progress.has-progress {
        color: #4a47a3;
      }

      .game-mode.conjugation .mode-progress.has-progress {
        color: #ff6b6b;
      }

      .game-mode.vocabulary .mode-progress.has-progress {
        color: #28a745;
      }

      .game-area {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        display: none;
      }

      .game-area.active {
        display: block;
      }

      .game-header {
        text-align: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 3px solid #667eea;
      }

      .game-header.conjugation {
        border-bottom-color: #ff6b6b;
      }

      .game-header.vocabulary {
        border-bottom-color: #28a745;
      }

      .game-title {
        font-size: 2em;
        color: #4a47a3;
        margin-bottom: 10px;
      }

      .game-title.conjugation {
        color: #ff6b6b;
      }

      .game-title.vocabulary {
        color: #28a745;
      }

      .game-progress {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #f8f9fa;
        padding: 15px 20px;
        border-radius: 15px;
        margin-bottom: 20px;
      }

      .progress-bar {
        flex: 1;
        height: 10px;
        background: #e9ecef;
        border-radius: 5px;
        margin: 0 20px;
        overflow: hidden;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        width: 0%;
        transition: width 0.3s ease;
      }

      .progress-fill.conjugation {
        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
      }

      .progress-fill.vocabulary {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      }

      .question-area {
        background: #fff8e1;
        border: 3px solid #ffc107;
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 25px;
        text-align: center;
      }

      .question-area.conjugation {
        background: #ffebee;
        border-color: #ff6b6b;
      }

      .question-area.vocabulary {
        background: #e8f5e8;
        border-color: #28a745;
      }

      .question {
        font-size: 1.5em;
        color: #2c3e50;
        margin-bottom: 20px;
        line-height: 1.4;
      }

      .example-sentence {
        background: #e8f5e8;
        border: 2px solid #28a745;
        border-radius: 10px;
        padding: 15px;
        margin-top: 15px;
        text-align: left;
      }

      .example-sentence h4 {
        color: #155724;
        margin-bottom: 8px;
        font-size: 1.1em;
      }

      .example-sentence p {
        color: #155724;
        margin: 5px 0;
        font-size: 1.05em;
        line-height: 1.4;
      }

      .sentence-type-selector {
        background: #fff;
        border: 2px solid #ff6b6b;
        border-radius: 15px;
        padding: 20px;
        margin: 20px 0;
      }

      .sentence-types {
        display: flex;
        justify-content: center;
        gap: 15px;
        flex-wrap: wrap;
        margin-bottom: 15px;
      }

      .sentence-type-btn {
        padding: 10px 20px;
        border: 2px solid #ff6b6b;
        background: white;
        color: #ff6b6b;
        border-radius: 25px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: bold;
      }

      .sentence-type-btn:hover {
        background: #ff6b6b;
        color: white;
      }

      .sentence-type-btn.active {
        background: #ff6b6b;
        color: white;
      }

      .sentence-preview {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 15px;
        margin-top: 10px;
        border-left: 4px solid #ff6b6b;
      }

      .conjugation-display {
        background: white;
        border: 2px solid #ff6b6b;
        border-radius: 15px;
        padding: 25px;
        margin: 20px 0;
        text-align: center;
      }

      .pronoun {
        font-size: 1.8em;
        font-weight: bold;
        color: #ff6b6b;
        margin-bottom: 10px;
      }

      .verb-infinitive {
        font-size: 1.4em;
        color: #666;
        margin-bottom: 15px;
        font-style: italic;
      }

      .conjugation-example {
        background: #f8f9fa;
        border-left: 4px solid #ff6b6b;
        padding: 15px;
        margin: 15px 0;
        border-radius: 8px;
      }

      .conjugation-example h4 {
        color: #ff6b6b;
        margin-bottom: 10px;
      }

      .conjugation-table {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-top: 15px;
      }

      .conjugation-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 12px;
        background: white;
        border-radius: 8px;
        border: 1px solid #dee2e6;
      }

      .conjugation-row .pronoun-small {
        font-weight: bold;
        color: #ff6b6b;
      }

      .conjugation-row .verb-form {
        color: #495057;
        font-weight: bold;
      }

      .german-word-display {
        font-size: 2.5em;
        font-weight: bold;
        color: #4a47a3;
        margin: 20px 0;
        cursor: pointer;
        padding: 15px;
        border-radius: 10px;
        transition: background-color 0.3s ease;
      }

      .german-word-display:hover {
        background-color: rgba(102, 126, 234, 0.1);
      }

      .options {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 25px;
      }

      .option {
        padding: 15px 20px;
        background: white;
        border: 2px solid #667eea;
        border-radius: 15px;
        cursor: pointer;
        text-align: center;
        transition: all 0.3s ease;
        font-size: 1.1em;
      }

      .option:hover {
        background: #667eea;
        color: white;
        transform: translateY(-2px);
      }

      .option.conjugation {
        border-color: #ff6b6b;
      }

      .option.conjugation:hover {
        background: #ff6b6b;
      }

      .option.correct {
        background: #28a745;
        color: white;
        border-color: #28a745;
      }

      .option.wrong {
        background: #dc3545;
        color: white;
        border-color: #dc3545;
      }

      .option.disabled {
        pointer-events: none;
        opacity: 0.6;
      }

      .input-area {
        margin-bottom: 25px;
      }

      .text-input {
        width: 100%;
        padding: 15px 20px;
        font-size: 1.2em;
        border: 2px solid #667eea;
        border-radius: 15px;
        outline: none;
        transition: border-color 0.3s ease;
      }

      .text-input:focus {
        border-color: #4a47a3;
        box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
      }

      .text-input.conjugation {
        border-color: #ff6b6b;
      }

      .text-input.conjugation:focus {
        border-color: #ff5252;
        box-shadow: 0 0 10px rgba(255, 107, 107, 0.3);
      }

      .controls {
        display: flex;
        justify-content: center;
        gap: 15px;
        flex-wrap: wrap;
        margin-bottom: 25px;
      }

      .btn {
        padding: 12px 25px;
        font-size: 1.1em;
        font-weight: bold;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
      }

      .btn-conjugation {
        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
        color: white;
      }

      .btn-conjugation:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(255, 107, 107, 0.3);
      }

      .btn-vocabulary {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        color: white;
      }

      .btn-vocabulary:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(40, 167, 69, 0.3);
      }

      .btn-secondary {
        background: #6c757d;
        color: white;
      }

      .btn-success {
        background: #28a745;
        color: white;
      }

      .btn-warning {
        background: #ffc107;
        color: #333;
      }

      .btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }

      .feedback {
        padding: 20px;
        border-radius: 15px;
        margin-bottom: 20px;
        text-align: center;
        font-size: 1.1em;
        font-weight: bold;
      }

      .feedback.correct {
        background: #d4edda;
        border: 2px solid #28a745;
        color: #155724;
      }

      .feedback.wrong {
        background: #f8d7da;
        border: 2px solid #dc3545;
        color: #721c24;
      }

      .results {
        background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
        border: 2px solid #28a745;
        border-radius: 20px;
        padding: 30px;
        text-align: center;
        margin-top: 30px;
      }

      .results h3 {
        color: #155724;
        font-size: 2em;
        margin-bottom: 20px;
      }

      .results-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .result-item {
        background: white;
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .result-number {
        font-size: 2.5em;
        font-weight: bold;
        color: #4a47a3;
        display: block;
      }

      .result-number.conjugation {
        color: #ff6b6b;
      }

      .result-number.vocabulary {
        color: #28a745;
      }

      .result-label {
        color: #666;
        font-size: 0.9em;
        margin-top: 5px;
      }

      .back-btn {
        position: absolute;
        top: 20px;
        left: 20px;
        background: rgba(255, 255, 255, 0.95);
        border: 2px solid #667eea;
        color: #4a47a3;
        padding: 12px 25px;
        border-radius: 25px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s ease;
        z-index: 1000;
        display: none;
        text-decoration: none;
        font-size: 1.1em;
      }

      .back-btn:hover {
        background: #667eea;
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
      }

      .back-btn:active {
        transform: translateY(0);
      }

      .back-btn.show {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .speech-recognition {
        background: #e3f2fd;
        border: 2px solid #2196f3;
        border-radius: 15px;
        padding: 20px;
        margin-bottom: 20px;
        text-align: center;
      }

      .mic-button {
        background: #f44336;
        color: white;
        border: none;
        border-radius: 50%;
        width: 80px;
        height: 80px;
        font-size: 2em;
        cursor: pointer;
        transition: all 0.3s ease;
        margin: 10px;
      }

      .mic-button:hover {
        transform: scale(1.1);
      }

      .mic-button.recording {
        background: #4caf50;
        animation: pulse 1s infinite;
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
        100% {
          transform: scale(1);
        }
      }

      .pronunciation-feedback {
        margin-top: 15px;
        padding: 15px;
        border-radius: 10px;
        font-weight: bold;
      }

      /* Audio visualizer */
      .audio-visualizer {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 3px;
        margin: 10px 0;
        height: 40px;
      }

      .audio-bar {
        width: 4px;
        background: #667eea;
        border-radius: 2px;
        transition: height 0.1s ease;
      }

      .audio-bar.conjugation {
        background: #ff6b6b;
      }

      .audio-bar.vocabulary {
        background: #28a745;
      }

      /* Translation help for conjugation */
      .translation-help {
        background: #e8f5e8;
        border: 2px solid #28a745;
        border-radius: 15px;
        padding: 20px;
        margin: 20px 0;
        text-align: left;
      }

      .translation-help h4 {
        color: #155724;
        margin-bottom: 15px;
        font-size: 1.2em;
      }

      .translation-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 12px;
        margin: 5px 0;
        background: white;
        border-radius: 8px;
        border-left: 4px solid #28a745;
      }

      .german-text {
        font-weight: bold;
        color: #2c3e50;
      }

      .vietnamese-text {
        color: #155724;
        font-style: italic;
      }

      /* Vocabulary Summary Styles */
      .vocabulary-summary {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        display: none;
      }

      .vocabulary-summary.active {
        display: block;
      }

      .vocabulary-header {
        text-align: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 3px solid #28a745;
      }

      .vocabulary-header h1 {
        color: #28a745;
        font-size: 2.5em;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      }

      .vocabulary-header .subtitle {
        color: #666;
        font-size: 1.2em;
        margin-bottom: 20px;
        font-style: italic;
      }

      .alphabet-nav {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 30px;
        padding: 20px;
        background: linear-gradient(135deg, #f8f9ff 0%, #f0f2ff 100%);
        border-radius: 15px;
        border: 2px solid #28a745;
      }

      .alphabet-btn {
        padding: 8px 12px;
        background: #28a745;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s ease;
        text-decoration: none;
      }

      .alphabet-btn:hover {
        background: #218838;
        transform: translateY(-2px);
      }

      .alphabet-btn.active {
        background: #e74c3c;
      }

      .search-container {
        text-align: center;
        margin-bottom: 30px;
      }

      .search-box {
        padding: 12px 20px;
        font-size: 16px;
        border: 2px solid #28a745;
        border-radius: 25px;
        width: 100%;
        max-width: 500px;
        outline: none;
        transition: border-color 0.3s ease;
      }

      .search-box:focus {
        border-color: #218838;
      }

      .category {
        margin-bottom: 35px;
        border: 2px solid #28a745;
        border-radius: 15px;
        padding: 25px;
        background: linear-gradient(135deg, #f8f9ff 0%, #f0f2ff 100%);
      }

      .category-title {
        font-size: 1.8em;
        font-weight: bold;
        color: #28a745;
        margin-bottom: 20px;
        text-align: center;
        border-bottom: 3px solid #28a745;
        padding-bottom: 10px;
      }

      .vocabulary-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 15px;
        margin-top: 20px;
      }

      .vocab-card {
        background: white;
        border-radius: 12px;
        padding: 15px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        border-left: 5px solid #28a745;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }

      .vocab-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      }

      .vocab-german-word {
        font-size: 1.4em;
        font-weight: bold;
        color: #2c3e50;
        margin-bottom: 5px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 8px;
        border-radius: 8px;
        transition: background-color 0.3s ease;
      }

      .vocab-german-word:hover {
        background-color: #e3f2fd;
      }

      .vocab-pronunciation {
        color: #8e44ad;
        font-size: 1.1em;
        margin-bottom: 8px;
        font-style: italic;
      }

      .vocab-vietnamese {
        color: #27ae60;
        font-size: 1.1em;
        font-weight: 500;
        margin-bottom: 12px;
      }

      .vocab-examples {
        background: #fff8e1;
        border-left: 3px solid #ffc107;
        padding: 12px;
        margin-top: 10px;
        border-radius: 0 8px 8px 0;
      }

      .vocab-example {
        margin: 8px 0;
        font-size: 0.95em;
        color: #856404;
        cursor: pointer;
        padding: 5px;
        border-radius: 5px;
        transition: background-color 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .vocab-example:hover {
        background-color: #fff3cd;
      }

      .vocab-example-german {
        font-weight: bold;
        color: #2c3e50;
      }

      .vocab-example-vietnamese {
        color: #27ae60;
        font-style: italic;
      }

      .vocab-priority {
        display: inline-block;
        padding: 3px 8px;
        border-radius: 12px;
        font-size: 0.8em;
        font-weight: bold;
        margin-bottom: 10px;
      }

      .vocab-high-priority {
        background: #e74c3c;
        color: white;
      }

      .vocab-medium-priority {
        background: #f39c12;
        color: white;
      }

      .vocab-basic-priority {
        background: #27ae60;
        color: white;
      }

      .vocab-lesson-tag {
        background: #28a745;
        color: white;
        padding: 2px 8px;
        border-radius: 12px;
        font-size: 0.7em;
        font-weight: bold;
        margin-top: 10px;
        display: inline-block;
      }

      .speaker-icon {
        color: #2196f3;
        font-size: 1.2em;
        cursor: pointer;
        transition: color 0.3s ease;
      }

      .speaker-icon:hover {
        color: #1976d2;
      }

      .playing {
        background-color: #e8f5e8 !important;
        animation: pulse 1s infinite;
      }

      .stats-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 30px;
      }

      .stat-card {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        color: white;
        padding: 20px;
        border-radius: 12px;
        text-align: center;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .stat-card-number {
        font-size: 2em;
        font-weight: bold;
        margin-bottom: 5px;
      }

      .stat-card-label {
        font-size: 0.9em;
        opacity: 0.9;
      }

      .hidden {
        display: none;
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .container {
          padding: 10px;
        }

        .header h1 {
          font-size: 1.8em;
        }

        .header p {
          font-size: 1em;
        }

        .stats {
          gap: 15px;
        }

        .stat-item {
          padding: 10px 15px;
          min-width: 100px;
        }

        .stat-number {
          font-size: 1.5em;
        }

        .game-modes {
          grid-template-columns: 1fr;
        }

        .german-word-display {
          font-size: 2em;
        }

        .options {
          grid-template-columns: 1fr;
        }

        .controls {
          flex-direction: column;
        }

        .back-btn {
          position: static;
          margin-bottom: 20px;
          align-self: flex-start;
        }

        .conjugation-table {
          grid-template-columns: 1fr;
        }

        .translation-item {
          flex-direction: column;
          align-items: flex-start;
          gap: 5px;
        }

        .vocabulary-grid {
          grid-template-columns: 1fr;
          gap: 12px;
        }

        .vocab-card {
          padding: 12px;
        }

        .vocab-german-word {
          font-size: 1.2em;
        }

        .alphabet-nav {
          gap: 5px;
        }

        .alphabet-btn {
          padding: 6px 10px;
          font-size: 0.9em;
        }

        .search-box {
          font-size: 14px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Back Button -->
      <a href="index.html" class="back-btn" id="backButton"> ‚Üê V·ªÅ trang ch·ªß </a>

      <!-- Main Menu -->
      <div id="mainMenu">
        <div class="header">
          <h1>üéÆ Game Luy·ªán T·∫≠p Ti·∫øng ƒê·ª©c</h1>
          <p>Luy·ªán t·∫≠p t·ª´ v·ª±ng + chia ƒë·ªông t·ª´ v·ªõi 210 t·ª´ v·ª±ng t·ª´ A-Z</p>
          <div class="stats">
            <div class="stat-item">
              <span class="stat-number">210</span>
              <span>T·ª´ v·ª±ng</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">6</span>
              <span>K·ªπ nƒÉng</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">3</span>
              <span>Ng·ªØ ph√°p</span>
            </div>
          </div>
        </div>

        <div class="game-modes">
          <div class="game-mode" onclick="startGame('listening')">
            <span class="mode-icon">üëÇ</span>
            <div class="mode-title">Luy·ªán Nghe</div>
            <div class="mode-description">
              Nghe t·∫•t c·∫£ 210 t·ª´ v·ª±ng ti·∫øng ƒê·ª©c v√† ch·ªçn nghƒ©a ƒë√∫ng b·∫±ng ti·∫øng
              Vi·ªát + Xem c√¢u v√≠ d·ª• th·ª±c t·∫ø
            </div>
            <div id="listeningProgress" class="mode-progress"></div>
          </div>

          <div class="game-mode" onclick="startGame('speaking')">
            <span class="mode-icon">üó£Ô∏è</span>
            <div class="mode-title">Luy·ªán N√≥i</div>
            <div class="mode-description">
              Ph√°t √¢m t·∫•t c·∫£ 210 t·ª´ v·ª±ng ti·∫øng ƒê·ª©c theo g·ª£i √Ω v·ªõi AI nh·∫≠n di·ªán
              gi·ªçng n√≥i
            </div>
            <div id="speakingProgress" class="mode-progress"></div>
          </div>

          <div class="game-mode" onclick="startGame('reading')">
            <span class="mode-icon">üëÅÔ∏è</span>
            <div class="mode-title">Luy·ªán ƒê·ªçc</div>
            <div class="mode-description">
              ƒê·ªçc t·∫•t c·∫£ 210 t·ª´ v·ª±ng ti·∫øng ƒê·ª©c v√† ch·ªçn nghƒ©a ti·∫øng Vi·ªát + Xem
              c√¢u v√≠ d·ª• th·ª±c t·∫ø
            </div>
            <div id="readingProgress" class="mode-progress"></div>
          </div>

          <div class="game-mode" onclick="startGame('writing')">
            <span class="mode-icon">‚úçÔ∏è</span>
            <div class="mode-title">Luy·ªán Vi·∫øt</div>
            <div class="mode-description">
              <strong>‚å®Ô∏è Nh·∫≠p t·ª´ b√†n ph√≠m:</strong> G√µ t·ª´ ti·∫øng ƒê·ª©c theo nghƒ©a
              ti·∫øng Vi·ªát v·ªõi ki·ªÉm tra ch√≠nh t·∫£ t·ª± ƒë·ªông
            </div>
            <div id="writingProgress" class="mode-progress"></div>
          </div>

          <div class="game-mode conjugation" onclick="startGame('conjugation')">
            <span class="mode-icon">üìù</span>
            <div class="mode-title">Chia ƒê·ªông T·ª´</div>
            <div class="mode-description">
              <strong>üí° H·ªçc c√≥ h·ªá th·ªëng:</strong> Quy t·∫Øc chia + m·∫πo ghi nh·ªõ +
              luy·ªán t·∫≠p c√¢u kh·∫≥ng ƒë·ªãnh, ph·ªß ƒë·ªãnh, nghi v·∫•n v·ªõi arbeiten, k√∂nnen,
              finden, leben + D·ªãch sang ti·∫øng Vi·ªát + Ph√°t √¢m
            </div>
            <div id="conjugationProgress" class="mode-progress"></div>
          </div>

          <div class="game-mode vocabulary" onclick="showVocabularySummary()">
            <span class="mode-icon">üìö</span>
            <div class="mode-title">T·ªïng H·ª£p T·ª´ V·ª±ng</div>
            <div class="mode-description">
              <strong>üìñ Tra c·ª©u v√† √¥n t·∫≠p:</strong> Xem t·∫•t c·∫£ 210 t·ª´ v·ª±ng theo
              alphabet + T√¨m ki·∫øm nhanh + Ph√°t √¢m + C√¢u v√≠ d·ª• th·ª±c t·∫ø cho t·ª´ng
              t·ª´ + Ph√¢n lo·∫°i theo ƒë·ªô quan tr·ªçng
            </div>
            <div id="vocabularyProgress" class="mode-progress">
              üìñ S·∫µn s√†ng tra c·ª©u 210 t·ª´ v·ª±ng!
            </div>
          </div>
        </div>
      </div>

      <!-- Vocabulary Summary Area -->
      <div id="vocabularySummary" class="vocabulary-summary">
        <div class="vocabulary-header">
          <h1>üìö T·ªïng h·ª£p t·ª´ v·ª±ng ti·∫øng ƒê·ª©c</h1>
          <div class="subtitle">
            **210 t·ª´ v·ª±ng** t·ª´ A-Z - C√≥ ph√°t √¢m v√† v√≠ d·ª•
          </div>

          <div class="stats-container">
            <div class="stat-card">
              <div class="stat-card-number">210</div>
              <div class="stat-card-label">T·ª´ v·ª±ng</div>
            </div>
            <div class="stat-card">
              <div class="stat-card-number">26</div>
              <div class="stat-card-label">Ch·ªØ c√°i alphabet</div>
            </div>
            <div class="stat-card">
              <div class="stat-card-number">100%</div>
              <div class="stat-card-label">C√≥ ph√°t √¢m</div>
            </div>
            <div class="stat-card">
              <div class="stat-card-number">A-Z</div>
              <div class="stat-card-label">ƒê·∫ßy ƒë·ªß b·∫£ng ch·ªØ c√°i</div>
            </div>
          </div>

          <div
            style="
              background: #f0f8ff;
              border: 1px solid #2196f3;
              border-radius: 8px;
              padding: 10px;
              margin-bottom: 20px;
              text-align: center;
            "
          >
            <strong>üîä T√≠nh nƒÉng ph√°t √¢m:</strong> B·∫•m v√†o üîä ƒë·ªÉ nghe ph√°t √¢m
            ti·∫øng ƒê·ª©c
          </div>
        </div>

        <div class="search-container">
          <input
            type="text"
            class="search-box"
            id="vocabularySearchBox"
            placeholder="üîç T√¨m ki·∫øm t·ª´ v·ª±ng (ti·∫øng ƒê·ª©c ho·∫∑c ti·∫øng Vi·ªát)..."
          />
        </div>

        <div class="alphabet-nav" id="vocabularyAlphabetNav">
          <!-- Alphabet navigation will be generated by JavaScript -->
        </div>

        <div id="vocabularyContainer">
          <!-- Vocabulary sections will be generated by JavaScript -->
        </div>

        <div class="controls">
          <button class="btn btn-vocabulary" onclick="showMainMenu()">
            üè† V·ªÅ menu ch√≠nh
          </button>
        </div>
      </div>

      <!-- Game Area -->
      <div id="gameArea" class="game-area">
        <div class="game-header" id="gameHeader">
          <div class="game-title" id="gameTitle">Luy·ªán Nghe</div>
          <div class="game-progress">
            <span>C√¢u <span id="currentQuestion">1</span></span>
            <div class="progress-bar">
              <div class="progress-fill" id="progressFill"></div>
            </div>
            <span>T·ªïng: <span id="totalQuestions">210</span></span>
          </div>
          <div>
            <span style="color: #28a745"
              >‚úì ƒê√∫ng: <span id="correctCount">0</span></span
            >
            |
            <span style="color: #dc3545"
              >‚úó Sai: <span id="wrongCount">0</span></span
            >
            |
            <span style="color: #ffc107"
              >‚≠ê ƒêi·ªÉm: <span id="score">0</span></span
            >
          </div>
        </div>

        <div class="question-area" id="questionArea">
          <div class="question" id="question">
            Nghe t·ª´ v·ª±ng v√† ch·ªçn nghƒ©a ƒë√∫ng:
          </div>

          <!-- Sentence Type Selector for Conjugation -->
          <div
            class="sentence-type-selector"
            id="sentenceTypeSelector"
            style="display: none"
          >
            <h4 style="text-align: center; margin-bottom: 15px; color: #ff6b6b">
              üéØ Ch·ªçn lo·∫°i c√¢u:
            </h4>
            <div class="sentence-types">
              <button class="sentence-type-btn active" data-type="statement">
                Kh·∫≥ng ƒë·ªãnh
              </button>
              <button class="sentence-type-btn" data-type="negative">
                Ph·ªß ƒë·ªãnh
              </button>
              <button class="sentence-type-btn" data-type="question">
                Nghi v·∫•n
              </button>
            </div>
            <div class="sentence-preview" id="sentencePreview">
              <strong>V√≠ d·ª•:</strong>
              <span id="previewText">Ich arbeite jeden Tag.</span>
            </div>
          </div>

          <!-- Conjugation Display Area -->
          <div
            class="conjugation-display"
            id="conjugationDisplay"
            style="display: none"
          >
            <div class="pronoun" id="pronounDisplay">ich</div>
            <div class="verb-infinitive" id="verbInfinitive">
              arbeiten (l√†m vi·ªác)
            </div>
            <div class="conjugation-example">
              <h4>üìö B·∫£ng chia ƒë·ªông t·ª´:</h4>
              <div class="conjugation-table" id="conjugationTable">
                <!-- Will be populated by JavaScript -->
              </div>
            </div>
          </div>

          <!-- Translation Help for Conjugation -->
          <div
            class="translation-help"
            id="translationHelp"
            style="display: none"
          >
            <h4>üåç D·ªãch nghƒ©a c√¢u:</h4>
            <div id="translationContent">
              <!-- Will be populated by JavaScript -->
            </div>
          </div>

          <div
            class="german-word-display"
            id="germanWord"
            onclick="speakWord(currentWord.german)"
            style="display: none"
          >
            Klicken Sie hier zum Anh√∂ren üîä
          </div>

          <!-- Example Sentence Display -->
          <div
            class="example-sentence"
            id="exampleSentence"
            style="display: none"
          >
            <h4>üìñ C√¢u v√≠ d·ª•:</h4>
            <p>
              <strong>üá©üá™ Ti·∫øng ƒê·ª©c:</strong> <span id="germanSentence"></span>
            </p>
            <p>
              <strong>üáªüá≥ Ti·∫øng Vi·ªát:</strong>
              <span id="vietnameseSentence"></span>
            </p>
            <button
              class="btn btn-primary"
              style="margin-top: 10px; font-size: 0.9em"
              onclick="speakSentence()"
            >
              üîä Nghe c√¢u v√≠ d·ª•
            </button>
          </div>

          <!-- Speech Recognition Area -->
          <div class="speech-recognition" id="speechArea" style="display: none">
            <p>Ph√°t √¢m t·ª´ ti·∫øng ƒê·ª©c sau:</p>
            <div class="german-word-display" id="speakingWord"></div>
            <div class="audio-visualizer" id="audioVisualizer">
              <div class="audio-bar"></div>
              <div class="audio-bar"></div>
              <div class="audio-bar"></div>
              <div class="audio-bar"></div>
              <div class="audio-bar"></div>
            </div>
            <button
              class="mic-button"
              id="micButton"
              onclick="toggleRecording()"
            >
              üé§
            </button>
            <p id="recognitionStatus">Nh·∫•n v√†o micro ƒë·ªÉ b·∫Øt ƒë·∫ßu</p>
            <div
              class="pronunciation-feedback"
              id="pronunciationFeedback"
              style="display: none"
            ></div>
          </div>

          <!-- Input Area for Writing and Conjugation -->
          <div class="input-area" id="inputArea" style="display: none">
            <input
              type="text"
              class="text-input"
              id="textInput"
              placeholder="Nh·∫≠p t·ª´ ti·∫øng ƒê·ª©c..."
              maxlength="100"
            />
          </div>
        </div>

        <div class="options" id="options">
          <!-- Options will be generated by JavaScript -->
        </div>

        <div class="feedback" id="feedback" style="display: none"></div>

        <div class="controls">
          <button
            class="btn btn-primary"
            id="playButton"
            onclick="playCurrentWord()"
          >
            üîä Ph√°t √¢m
          </button>
          <button
            class="btn btn-success"
            id="submitButton"
            onclick="submitAnswer()"
            style="display: none"
          >
            ‚úì Ki·ªÉm tra
          </button>
          <button
            class="btn btn-primary"
            id="nextButton"
            onclick="nextQuestion()"
            style="display: none"
          >
            ‚û°Ô∏è C√¢u ti·∫øp theo
          </button>
          <button class="btn btn-warning" onclick="skipQuestion()">
            ‚è≠Ô∏è B·ªè qua (<span id="remainingCount">210</span> c√≤n l·∫°i)
          </button>
          <button class="btn btn-secondary" onclick="showMainMenu()">
            üè† Menu ch√≠nh
          </button>
        </div>
      </div>

      <!-- Results -->
      <div id="results" class="results" style="display: none">
        <h3>üéâ K·∫øt qu·∫£ luy·ªán t·∫≠p</h3>
        <div class="results-stats">
          <div class="result-item">
            <span class="result-number" id="finalScore">0</span>
            <div class="result-label">ƒêi·ªÉm s·ªë</div>
          </div>
          <div class="result-item">
            <span class="result-number" id="finalCorrect">0</span>
            <div class="result-label">C√¢u ƒë√∫ng</div>
          </div>
          <div class="result-item">
            <span class="result-number" id="finalWrong">0</span>
            <div class="result-label">C√¢u sai</div>
          </div>
          <div class="result-item">
            <span class="result-number" id="finalAccuracy">0%</span>
            <div class="result-label">ƒê·ªô ch√≠nh x√°c</div>
          </div>
        </div>
        <div class="controls">
          <button class="btn btn-primary" onclick="restartGame()">
            üîÑ Ch∆°i l·∫°i
          </button>
          <button class="btn btn-secondary" onclick="showMainMenu()">
            üè† V·ªÅ menu ch√≠nh
          </button>
        </div>
      </div>
    </div>

    <script>
      // Vocabulary database with 210 words from A-Z
      const vocabulary = [
        // A
        { german: "aber", vietnamese: "nh∆∞ng", lesson: "A" },
        { german: "ach", vietnamese: "√¥i", lesson: "A" },
        { german: "acht", vietnamese: "t√°m", lesson: "A" },
        { german: "achtzehn", vietnamese: "m∆∞·ªùi t√°m", lesson: "A" },
        { german: "Akkordeon", vietnamese: "ƒë√†n accordion", lesson: "A" },
        { german: "alt", vietnamese: "gi√†", lesson: "A" },
        { german: "das Alter", vietnamese: "tu·ªïi t√°c", lesson: "A" },
        { german: "am", vietnamese: "v√†o l√∫c", lesson: "A" },
        { german: "arbeiten", vietnamese: "l√†m vi·ªác", lesson: "A" },
        { german: "ich arbeite", vietnamese: "t√¥i l√†m vi·ªác", lesson: "A" },
        { german: "der Arbeitstag", vietnamese: "ng√†y l√†m vi·ªác", lesson: "A" },
        { german: "die Ausbildung", vietnamese: "s·ª± ƒë√†o t·∫°o", lesson: "A" },
        {
          german: "der Auszubildende",
          vietnamese: "h·ªçc vi√™n nam",
          lesson: "A",
        },
        { german: "die Auszubildende", vietnamese: "h·ªçc vi√™n n·ªØ", lesson: "A" },

        // B
        { german: "Baby", vietnamese: "em b√©", lesson: "B" },
        { german: "die Bank", vietnamese: "ng√¢n h√†ng", lesson: "B" },
        { german: "der Beruf", vietnamese: "ngh·ªÅ nghi·ªáp", lesson: "B" },
        { german: "die Betonung", vietnamese: "s·ª± nh·∫•n √¢m", lesson: "B" },
        { german: "Bilder", vietnamese: "nh·ªØng b·ª©c tranh", lesson: "B" },
        { german: "bis bald", vietnamese: "h·∫πn g·∫∑p l·∫°i s·ªõm", lesson: "B" },
        { german: "bis sp√§ter", vietnamese: "h·∫πn g·∫∑p l·∫°i sau", lesson: "B" },
        { german: "Brief", vietnamese: "th∆∞", lesson: "B" },
        { german: "Briefumschlag", vietnamese: "phong b√¨", lesson: "B" },
        { german: "Bruder", vietnamese: "anh em trai", lesson: "B" },

        // C
        { german: "Cent", vietnamese: "xu", lesson: "C" },
        { german: "Chef", vietnamese: "√¥ng ch·ªß", lesson: "C" },
        {
          german: "Computer spielen",
          vietnamese: "ch∆°i m√°y t√≠nh",
          lesson: "C",
        },
        { german: "Cousin", vietnamese: "anh em h·ªç", lesson: "C" },
        { german: "Cousine", vietnamese: "ch·ªã em h·ªç", lesson: "C" },

        // D
        { german: "da", vietnamese: "·ªü ƒë√≥", lesson: "D" },
        { german: "denn", vietnamese: "v√¨", lesson: "D" },
        {
          german: "der Deutschkurs",
          vietnamese: "l·ªõp h·ªçc ti·∫øng ƒê·ª©c",
          lesson: "D",
        },
        {
          german: "deutschsprachige L√§nder",
          vietnamese: "c√°c n∆∞·ªõc n√≥i ti·∫øng ƒê·ª©c",
          lesson: "D",
        },
        { german: "drei", vietnamese: "ba", lesson: "D" },
        { german: "dreizehn", vietnamese: "m∆∞·ªùi ba", lesson: "D" },
        { german: "Dynamit", vietnamese: "thu·ªëc n·ªï", lesson: "D" },

        // E
        { german: "die Ehefrau", vietnamese: "v·ª£", lesson: "E" },
        { german: "eins", vietnamese: "m·ªôt", lesson: "E" },
        { german: "Elefant", vietnamese: "con voi", lesson: "E" },
        { german: "elf", vietnamese: "m∆∞·ªùi m·ªôt", lesson: "E" },
        { german: "Eltern", vietnamese: "cha m·∫π", lesson: "E" },
        { german: "Enkel", vietnamese: "ch√°u trai", lesson: "E" },
        { german: "Enkelin", vietnamese: "ch√°u g√°i", lesson: "E" },
        { german: "entdecken", vietnamese: "kh√°m ph√°", lesson: "E" },

        // F
        { german: "falsch", vietnamese: "sai", lesson: "F" },
        {
          german: "der Familienstand",
          vietnamese: "t√¨nh tr·∫°ng h√¥n nh√¢n",
          lesson: "F",
        },
        {
          german: "Familienmitglieder",
          vietnamese: "th√†nh vi√™n gia ƒë√¨nh",
          lesson: "F",
        },
        { german: "Familienfotos", vietnamese: "·∫£nh gia ƒë√¨nh", lesson: "F" },
        { german: "Fernsehen", vietnamese: "xem tivi", lesson: "F" },
        { german: "Filme schauen", vietnamese: "xem phim", lesson: "F" },
        { german: "finden", vietnamese: "t√¨m th·∫•y", lesson: "F" },
        { german: "Fl√∂te", vietnamese: "s√°o", lesson: "F" },
        { german: "Formular", vietnamese: "bi·ªÉu m·∫´u", lesson: "F" },
        { german: "Frau", vietnamese: "ph·ª• n·ªØ", lesson: "F" },
        { german: "Freund", vietnamese: "b·∫°n nam", lesson: "F" },
        { german: "Freundin", vietnamese: "b·∫°n n·ªØ", lesson: "F" },
        { german: "f√ºllen", vietnamese: "ƒëi·ªÅn v√†o", lesson: "F" },
        { german: "f√ºnf", vietnamese: "nƒÉm", lesson: "F" },
        { german: "f√ºnfzehn", vietnamese: "m∆∞·ªùi lƒÉm", lesson: "F" },

        // G
        { german: "die Geburt", vietnamese: "s·ª± sinh", lesson: "G" },
        { german: "der Geburtsort", vietnamese: "n∆°i sinh", lesson: "G" },
        { german: "geht's", vietnamese: "th·∫ø n√†o", lesson: "G" },
        { german: "genau", vietnamese: "ch√≠nh x√°c", lesson: "G" },
        { german: "gern", vietnamese: "th√≠ch", lesson: "G" },
        { german: "gern geschehen", vietnamese: "kh√¥ng c√≥ g√¨", lesson: "G" },
        { german: "gerne", vietnamese: "th√≠ch", lesson: "G" },
        { german: "geschieden", vietnamese: "ƒë√£ ly h√¥n", lesson: "G" },
        { german: "Geschwister", vietnamese: "anh ch·ªã em", lesson: "G" },
        { german: "gibt es viele", vietnamese: "c√≥ nhi·ªÅu", lesson: "G" },
        { german: "Gitarre", vietnamese: "ƒë√†n guitar", lesson: "G" },
        { german: "gleich", vietnamese: "ngay", lesson: "G" },
        {
          german: "die Gl√ºckw√ºnsche",
          vietnamese: "l·ªùi ch√∫c m·ª´ng",
          lesson: "G",
        },
        { german: "Gro√üeltern", vietnamese: "√¥ng b√†", lesson: "G" },

        // H
        {
          german: "ein Handy",
          vietnamese: "m·ªôt ƒëi·ªán tho·∫°i di ƒë·ªông",
          lesson: "H",
        },
        { german: "hast du", vietnamese: "b·∫°n c√≥", lesson: "H" },
        { german: "hat", vietnamese: "c√≥", lesson: "H" },
        { german: "die Hauptstadt", vietnamese: "th·ªß ƒë√¥", lesson: "H" },
        { german: "das Hobby", vietnamese: "s·ªü th√≠ch", lesson: "H" },

        // I
        { german: "Informationen", vietnamese: "th√¥ng tin", lesson: "I" },
        { german: "Insekt", vietnamese: "c√¥n tr√πng", lesson: "I" },

        // J
        { german: "Jaguar", vietnamese: "b√°o ƒë·ªëm", lesson: "J" },
        { german: "die Jahre", vietnamese: "nh·ªØng nƒÉm", lesson: "J" },
        { german: "jung", vietnamese: "tr·∫ª", lesson: "J" },

        // K
        { german: "Kamera", vietnamese: "m√°y ·∫£nh", lesson: "K" },
        { german: "kannst du", vietnamese: "b·∫°n c√≥ th·ªÉ", lesson: "K" },
        { german: "keine Ursache", vietnamese: "kh√¥ng c√≥ g√¨", lesson: "K" },
        { german: "Kettenspiel", vietnamese: "tr√≤ ch∆°i chu·ªói", lesson: "K" },
        { german: "Kind", vietnamese: "tr·∫ª em", lesson: "K" },
        { german: "Kinder", vietnamese: "tr·∫ª em", lesson: "K" },
        {
          german: "die Klassenlehrerin",
          vietnamese: "c√¥ gi√°o ch·ªß nhi·ªám",
          lesson: "K",
        },
        { german: "klopfen", vietnamese: "g√µ c·ª≠a", lesson: "K" },
        { german: "kochen", vietnamese: "n·∫•u ƒÉn", lesson: "K" },
        { german: "k√∂nnen", vietnamese: "c√≥ th·ªÉ", lesson: "K" },

        // L
        { german: "Landkarte", vietnamese: "b·∫£n ƒë·ªì", lesson: "L" },
        { german: "lebt", vietnamese: "s·ªëng", lesson: "L" },
        { german: "ledig", vietnamese: "ƒë·ªôc th√¢n", lesson: "L" },
        {
          german: "eine Lehrstelle",
          vietnamese: "m·ªôt v·ªã tr√≠ h·ªçc vi·ªác",
          lesson: "L",
        },
        { german: "Lied", vietnamese: "b√†i h√°t", lesson: "L" },
        { german: "liegt", vietnamese: "n·∫±m", lesson: "L" },
        { german: "Liste", vietnamese: "danh s√°ch", lesson: "L" },
        { german: "Lokomotive", vietnamese: "ƒë·∫ßu m√°y xe l·ª≠a", lesson: "L" },
        { german: "Los", vietnamese: "b·∫Øt ƒë·∫ßu", lesson: "L" },

        // M
        { german: "mal", vietnamese: "l·∫ßn", lesson: "M" },
        { german: "man", vietnamese: "ng∆∞·ªùi ta", lesson: "M" },
        { german: "Mann", vietnamese: "ƒë√†n √¥ng", lesson: "M" },
        { german: "meinen", vietnamese: "√Ω ki·∫øn", lesson: "M" },
        { german: "Mikrofon", vietnamese: "micro", lesson: "M" },
        { german: "Musik h√∂ren", vietnamese: "nghe nh·∫°c", lesson: "M" },
        { german: "Mutter", vietnamese: "m·∫π", lesson: "M" },

        // N
        { german: "Na", vietnamese: "n√†y", lesson: "N" },
        { german: "nat√ºrlich", vietnamese: "t·ª± nhi√™n", lesson: "N" },
        { german: "Natur", vietnamese: "thi√™n nhi√™n", lesson: "N" },
        { german: "nett", vietnamese: "t·ªët b·ª•ng", lesson: "N" },
        { german: "neun", vietnamese: "ch√≠n", lesson: "N" },
        { german: "neunzehn", vietnamese: "m∆∞·ªùi ch√≠n", lesson: "N" },
        { german: "nichts zu danken", vietnamese: "kh√¥ng c√≥ g√¨", lesson: "N" },
        { german: "der Norden", vietnamese: "ph√≠a b·∫Øc", lesson: "N" },
        { german: "notieren", vietnamese: "ghi ch√∫", lesson: "N" },
        { german: "null", vietnamese: "kh√¥ng", lesson: "N" },
        { german: "die Nummer", vietnamese: "s·ªë", lesson: "N" },
        { german: "nur", vietnamese: "ch·ªâ", lesson: "N" },

        // O
        { german: "Oje", vietnamese: "√¥i tr·ªùi", lesson: "O" },
        { german: "Oma", vietnamese: "b√†", lesson: "O" },
        { german: "ohne Ton an", vietnamese: "kh√¥ng c√≥ √¢m thanh", lesson: "O" },
        { german: "Opa", vietnamese: "√¥ng", lesson: "O" },
        { german: "der Osten", vietnamese: "ph√≠a ƒë√¥ng", lesson: "O" },
        { german: "Ostpolen", vietnamese: "Ba Lan ph√≠a ƒë√¥ng", lesson: "O" },
        { german: "Ozean", vietnamese: "ƒë·∫°i d∆∞∆°ng", lesson: "O" },

        // P
        { german: "Paar", vietnamese: "c·∫∑p ƒë√¥i", lesson: "P" },
        { german: "Paare", vietnamese: "c√°c c·∫∑p ƒë√¥i", lesson: "P" },
        { german: "Partner", vietnamese: "ƒë·ªëi t√°c", lesson: "P" },
        { german: "Partnerin", vietnamese: "ƒë·ªëi t√°c n·ªØ", lesson: "P" },
        {
          german: "Partnerinterview",
          vietnamese: "ph·ªèng v·∫•n ƒë·ªëi t√°c",
          lesson: "P",
        },
        { german: "passt", vietnamese: "ph√π h·ª£p", lesson: "P" },
        { german: "die Pause", vietnamese: "gi·ªù ngh·ªâ", lesson: "P" },
        { german: "perfekt", vietnamese: "ho√†n h·∫£o", lesson: "P" },
        { german: "Phonetik", vietnamese: "ng·ªØ √¢m h·ªçc", lesson: "P" },
        { german: "Polizei", vietnamese: "c·∫£nh s√°t", lesson: "P" },
        { german: "Punkte", vietnamese: "ƒëi·ªÉm", lesson: "P" },

        // Q
        { german: "Quartett", vietnamese: "t·ª© t·∫•u", lesson: "Q" },

        // R
        { german: "Radio", vietnamese: "ƒë√†i radio", lesson: "R" },
        { german: "R√§tsel", vietnamese: "c√¢u ƒë·ªë", lesson: "R" },
        { german: "Rhythmus", vietnamese: "nh·ªãp ƒëi·ªáu", lesson: "R" },
        { german: "die Rufnummer", vietnamese: "s·ªë ƒëi·ªán tho·∫°i", lesson: "R" },

        // S
        { german: "Satzakzent", vietnamese: "tr·ªçng √¢m c√¢u", lesson: "S" },
        { german: "Satzmelodie", vietnamese: "giai ƒëi·ªáu c√¢u", lesson: "S" },
        { german: "S√§tze", vietnamese: "c√¢u", lesson: "S" },
        { german: "Satzzeichen", vietnamese: "d·∫•u c√¢u", lesson: "S" },
        { german: "Saxofon", vietnamese: "k√®n saxophone", lesson: "S" },
        { german: "sch√∂n", vietnamese: "ƒë·∫πp", lesson: "S" },
        { german: "sich sch√∂n machen", vietnamese: "trang ƒëi·ªÉm", lesson: "S" },
        {
          german: "sch√∂nen Tag noch",
          vietnamese: "ch√∫c m·ªôt ng√†y t·ªët l√†nh",
          lesson: "S",
        },
        {
          german: "sch√∂nen Abend noch",
          vietnamese: "ch√∫c m·ªôt bu·ªïi t·ªëi t·ªët l√†nh",
          lesson: "S",
        },
        { german: "schon", vietnamese: "ƒë√£", lesson: "S" },
        { german: "schon lange", vietnamese: "ƒë√£ l√¢u", lesson: "S" },
        { german: "schreibt", vietnamese: "vi·∫øt", lesson: "S" },
        { german: "Schwester", vietnamese: "ch·ªã em g√°i", lesson: "S" },
        { german: "sechs", vietnamese: "s√°u", lesson: "S" },
        { german: "sechzehn", vietnamese: "m∆∞·ªùi s√°u", lesson: "S" },
        { german: "sehr", vietnamese: "r·∫•t", lesson: "S" },
        { german: "sieben", vietnamese: "b·∫£y", lesson: "S" },
        { german: "siebzehn", vietnamese: "m∆∞·ªùi b·∫£y", lesson: "S" },
        { german: "sicher", vietnamese: "ch·∫Øc ch·∫Øn", lesson: "S" },
        { german: "sich √§ndern", vietnamese: "thay ƒë·ªïi", lesson: "S" },
        { german: "so", vietnamese: "nh∆∞ v·∫≠y", lesson: "S" },
        { german: "Sohn", vietnamese: "con trai", lesson: "S" },
        { german: "die Sprachen", vietnamese: "ng√¥n ng·ªØ", lesson: "S" },
        { german: "stolz", vietnamese: "t·ª± h√†o", lesson: "S" },
        { german: "der Student", vietnamese: "sinh vi√™n nam", lesson: "S" },
        { german: "die Studentin", vietnamese: "sinh vi√™n n·ªØ", lesson: "S" },
        { german: "der S√ºden", vietnamese: "ph√≠a nam", lesson: "S" },

        // T
        { german: "Tabelle", vietnamese: "b·∫£ng", lesson: "T" },
        { german: "das Telefon", vietnamese: "ƒëi·ªán tho·∫°i", lesson: "T" },
        {
          german: "die Telefonauskunft",
          vietnamese: "tra c·ª©u ƒëi·ªán tho·∫°i",
          lesson: "T",
        },
        {
          german: "die Telefonnummer",
          vietnamese: "s·ªë ƒëi·ªán tho·∫°i",
          lesson: "T",
        },
        { german: "Tochter", vietnamese: "con g√°i", lesson: "T" },

        // U
        { german: "√ºber", vietnamese: "tr√™n", lesson: "U" },
        { german: "Uhu", vietnamese: "c√∫ m√®o", lesson: "U" },

        // V
        { german: "Varianten", vietnamese: "c√°c bi·∫øn th·ªÉ", lesson: "V" },
        { german: "Vater", vietnamese: "cha", lesson: "V" },
        { german: "verbinden", vietnamese: "k·∫øt n·ªëi", lesson: "V" },
        { german: "verheiratet", vietnamese: "ƒë√£ k·∫øt h√¥n", lesson: "V" },
        { german: "verstehst", vietnamese: "hi·ªÉu", lesson: "V" },
        { german: "verwitwet", vietnamese: "g√≥a v·ª£/ch·ªìng", lesson: "V" },
        { german: "vier", vietnamese: "b·ªën", lesson: "V" },
        { german: "vierzehn", vietnamese: "m∆∞·ªùi b·ªën", lesson: "V" },
        { german: "Vielen Dank", vietnamese: "c·∫£m ∆°n nhi·ªÅu", lesson: "V" },
        { german: "Volksmusik", vietnamese: "nh·∫°c d√¢n gian", lesson: "V" },
        { german: "von", vietnamese: "t·ª´", lesson: "V" },
        { german: "die Vorwahl", vietnamese: "m√£ v√πng", lesson: "V" },

        // W
        { german: "w√§hlen", vietnamese: "ch·ªçn", lesson: "W" },
        { german: "war", vietnamese: "ƒë√£ l√†", lesson: "W" },
        { german: "waren", vietnamese: "ƒë√£ l√† (s·ªë nhi·ªÅu)", lesson: "W" },
        { german: "weiter", vietnamese: "ti·∫øp t·ª•c", lesson: "W" },
        { german: "der Westen", vietnamese: "ph√≠a t√¢y", lesson: "W" },
        { german: "Westpolen", vietnamese: "Ba Lan ph√≠a t√¢y", lesson: "W" },
        { german: "wirklich", vietnamese: "th·ª±c s·ª±", lesson: "W" },
        { german: "wo", vietnamese: "·ªü ƒë√¢u", lesson: "W" },
        { german: "der Wohnort", vietnamese: "n∆°i c∆∞ tr√∫", lesson: "W" },
        { german: "W√∂rter", vietnamese: "t·ª´ v·ª±ng", lesson: "W" },

        // X
        { german: "Xylofon", vietnamese: "ƒë√†n m·ªôc c·∫ßm", lesson: "X" },

        // Z
        { german: "zahlen", vietnamese: "tr·∫£ ti·ªÅn", lesson: "Z" },
        { german: "zehn", vietnamese: "m∆∞·ªùi", lesson: "Z" },
        { german: "Zettel", vietnamese: "t·ªù gi·∫•y", lesson: "Z" },
        { german: "Zirkus", vietnamese: "r·∫°p xi·∫øc", lesson: "Z" },
        { german: "zusammen", vietnamese: "c√πng nhau", lesson: "Z" },
        { german: "zwanzig", vietnamese: "hai m∆∞·ªùi", lesson: "Z" },
        { german: "zwei", vietnamese: "hai", lesson: "Z" },
        { german: "zweite", vietnamese: "th·ª© hai", lesson: "Z" },
        {
          german: "zwischendurch mal",
          vietnamese: "th·ªânh tho·∫£ng",
          lesson: "Z",
        },
        { german: "zw√∂lf", vietnamese: "m∆∞·ªùi hai", lesson: "Z" },
      ];

      // Enhanced example sentences with realistic usage contexts
      const exampleSentences = {
        aber: {
          german: "Ich m√∂chte kommen, aber ich habe keine Zeit.",
          vietnamese: "T√¥i mu·ªën ƒë·∫øn, nh∆∞ng t√¥i kh√¥ng c√≥ th·ªùi gian.",
        },
        ach: {
          german: "Ach so! Jetzt verstehe ich das Problem.",
          vietnamese: "√Ä v·∫≠y! B√¢y gi·ªù t√¥i hi·ªÉu v·∫•n ƒë·ªÅ r·ªìi.",
        },
        acht: {
          german: "Ich stehe jeden Tag um acht Uhr auf.",
          vietnamese: "T√¥i d·∫≠y l√∫c t√°m gi·ªù m·ªói ng√†y.",
        },
        arbeiten: {
          german: "Ich arbeite in einem gro√üen B√ºro in der Stadt.",
          vietnamese: "T√¥i l√†m vi·ªác trong m·ªôt vƒÉn ph√≤ng l·ªõn ·ªü th√†nh ph·ªë.",
        },
        alt: {
          german: "Mein Gro√üvater ist schon sehr alt, aber noch gesund.",
          vietnamese: "√îng t√¥i ƒë√£ r·∫•t gi√†, nh∆∞ng v·∫´n kh·ªèe m·∫°nh.",
        },
        Baby: {
          german: "Das Baby schl√§ft friedlich in seinem Bett.",
          vietnamese: "Em b√© ng·ªß y√™n trong gi∆∞·ªùng c·ªßa m√¨nh.",
        },
        Beruf: {
          german: "Was ist dein Beruf? Ich bin Lehrerin.",
          vietnamese: "Ngh·ªÅ nghi·ªáp c·ªßa b·∫°n l√† g√¨? T√¥i l√† gi√°o vi√™n.",
        },
        Bruder: {
          german: "Mein Bruder studiert Medizin an der Universit√§t.",
          vietnamese: "Anh trai t√¥i h·ªçc y khoa ·ªü tr∆∞·ªùng ƒë·∫°i h·ªçc.",
        },
        Chef: {
          german: "Mein Chef ist sehr nett und hilfsbereit.",
          vietnamese: "√îng ch·ªß c·ªßa t√¥i r·∫•t t·ªët b·ª•ng v√† hay gi√∫p ƒë·ª°.",
        },
        da: {
          german: "Da steht ein sch√∂nes Auto vor dem Haus.",
          vietnamese: "·ªû ƒë√≥ c√≥ m·ªôt chi·∫øc xe ƒë·∫πp tr∆∞·ªõc nh√†.",
        },
        drei: {
          german: "Wir haben drei Kinder: zwei S√∂hne und eine Tochter.",
          vietnamese: "Ch√∫ng t√¥i c√≥ ba ƒë·ª©a con: hai con trai v√† m·ªôt con g√°i.",
        },
        eins: {
          german: "Eins plus eins ist zwei - das ist einfach!",
          vietnamese: "M·ªôt c·ªông m·ªôt b·∫±ng hai - ƒëi·ªÅu ƒë√≥ ƒë∆°n gi·∫£n!",
        },
        Eltern: {
          german: "Meine Eltern leben in einem kleinen Dorf.",
          vietnamese: "Cha m·∫π t√¥i s·ªëng ·ªü m·ªôt ng√¥i l√†ng nh·ªè.",
        },
        falsch: {
          german: "Das ist falsch! Die richtige Antwort ist 'ja'.",
          vietnamese: "ƒêi·ªÅu ƒë√≥ sai! C√¢u tr·∫£ l·ªùi ƒë√∫ng l√† 'ja'.",
        },
        Freund: {
          german: "Mein bester Freund wohnt in M√ºnchen.",
          vietnamese: "B·∫°n th√¢n nh·∫•t c·ªßa t√¥i s·ªëng ·ªü Munich.",
        },
        genau: {
          german: "Genau! Das ist die richtige L√∂sung.",
          vietnamese: "Ch√≠nh x√°c! ƒê√≥ l√† gi·∫£i ph√°p ƒë√∫ng.",
        },
        Gitarre: {
          german: "Am Abend spiele ich gerne Gitarre.",
          vietnamese: "Bu·ªïi t·ªëi t√¥i th√≠ch ch∆°i ƒë√†n guitar.",
        },
        Handy: {
          german: "Mein Handy ist kaputt, ich brauche ein neues.",
          vietnamese: "ƒêi·ªán tho·∫°i c·ªßa t√¥i b·ªã h·ªèng, t√¥i c·∫ßn m·ªôt c√°i m·ªõi.",
        },
        jung: {
          german: "Sie ist noch sehr jung, aber schon sehr klug.",
          vietnamese: "C√¥ ·∫•y c√≤n r·∫•t tr·∫ª, nh∆∞ng ƒë√£ r·∫•t th√¥ng minh.",
        },
        k√∂nnen: {
          german:
            "Ich kann drei Sprachen sprechen: Deutsch, Englisch und Franz√∂sisch.",
          vietnamese: "T√¥i c√≥ th·ªÉ n√≥i ba th·ª© ti·∫øng: ƒê·ª©c, Anh v√† Ph√°p.",
        },
        ledig: {
          german: "Ich bin noch ledig, aber ich habe eine Freundin.",
          vietnamese: "T√¥i v·∫´n c√≤n ƒë·ªôc th√¢n, nh∆∞ng t√¥i c√≥ b·∫°n g√°i.",
        },
        Mann: {
          german: "Der Mann dort dr√ºben ist mein Nachbar.",
          vietnamese: "Ng∆∞·ªùi ƒë√†n √¥ng ·ªü ƒë·∫±ng kia l√† h√†ng x√≥m c·ªßa t√¥i.",
        },
        Mutter: {
          german: "Meine Mutter kocht das beste Essen der Welt.",
          vietnamese: "M·∫π t√¥i n·∫•u nh·ªØng m√≥n ƒÉn ngon nh·∫•t th·∫ø gi·ªõi.",
        },
        nett: {
          german: "Die neue Kollegin ist sehr nett und freundlich.",
          vietnamese: "ƒê·ªìng nghi·ªáp m·ªõi r·∫•t t·ªët b·ª•ng v√† th√¢n thi·ªán.",
        },
        Oma: {
          german: "Meine Oma erz√§hlt immer interessante Geschichten.",
          vietnamese: "B√† t√¥i lu√¥n k·ªÉ nh·ªØng c√¢u chuy·ªán th√∫ v·ªã.",
        },
        Partner: {
          german: "Mein Partner und ich reisen gerne zusammen.",
          vietnamese: "ƒê·ªëi t√°c c·ªßa t√¥i v√† t√¥i th√≠ch ƒëi du l·ªãch c√πng nhau.",
        },
        Radio: {
          german: "Morgens h√∂re ich immer Radio beim Fr√ºhst√ºck.",
          vietnamese: "Bu·ªïi s√°ng t√¥i lu√¥n nghe radio khi ƒÉn s√°ng.",
        },
        sch√∂n: {
          german: "Das Wetter ist heute wirklich sch√∂n und warm.",
          vietnamese: "Th·ªùi ti·∫øt h√¥m nay th·ª±c s·ª± ƒë·∫πp v√† ·∫•m √°p.",
        },
        Schwester: {
          german: "Meine Schwester ist √Ñrztin im Krankenhaus.",
          vietnamese: "Ch·ªã g√°i t√¥i l√† b√°c sƒ© ·ªü b·ªánh vi·ªán.",
        },
        Telefon: {
          german: "Das Telefon klingelt - wer ruft uns an?",
          vietnamese: "ƒêi·ªán tho·∫°i ƒëang reo - ai g·ªçi cho ch√∫ng ta?",
        },
        Vater: {
          german: "Mein Vater arbeitet als Ingenieur bei BMW.",
          vietnamese: "Cha t√¥i l√†m k·ªπ s∆∞ ·ªü BMW.",
        },
        wirklich: {
          german: "Ist das wirklich wahr? Das kann ich nicht glauben!",
          vietnamese: "ƒêi·ªÅu ƒë√≥ c√≥ th·ª±c s·ª± ƒë√∫ng kh√¥ng? T√¥i kh√¥ng th·ªÉ tin ƒë∆∞·ª£c!",
        },
        zwei: {
          german: "Ich habe zwei Geschwister: einen Bruder und eine Schwester.",
          vietnamese: "T√¥i c√≥ hai anh ch·ªã em: m·ªôt anh trai v√† m·ªôt ch·ªã g√°i.",
        },
      };

      // Pronoun data (same as before)
      const pronouns = [
        { german: "ich", vietnamese: "t√¥i", type: "1st_singular" },
        { german: "du", vietnamese: "b·∫°n", type: "2nd_singular_informal" },
        {
          german: "Sie",
          vietnamese: "b·∫°n/anh/ch·ªã",
          type: "2nd_singular_formal",
        },
        { german: "er", vietnamese: "anh ·∫•y", type: "3rd_singular_masculine" },
        { german: "sie", vietnamese: "c√¥ ·∫•y", type: "3rd_singular_feminine" },
        { german: "es", vietnamese: "n√≥", type: "3rd_singular_neuter" },
        { german: "wir", vietnamese: "ch√∫ng t√¥i", type: "1st_plural" },
        { german: "ihr", vietnamese: "c√°c b·∫°n", type: "2nd_plural_informal" },
        {
          german: "Sie",
          vietnamese: "c√°c b·∫°n/qu√Ω v·ªã",
          type: "2nd_plural_formal",
        },
        { german: "sie", vietnamese: "h·ªç", type: "3rd_plural" },
      ];

      // Verb conjugation data
      const verbConjugations = {
        arbeiten: {
          infinitive: "arbeiten",
          vietnamese: "l√†m vi·ªác",
          conjugations: {
            ich: "arbeite",
            du: "arbeitest",
            Sie_formal: "arbeiten",
            er: "arbeitet",
            sie_fem: "arbeitet",
            es: "arbeitet",
            wir: "arbeiten",
            ihr: "arbeitet",
            sie_plural: "arbeiten",
          },
          sentences: {
            statement: {
              ich: "Ich arbeite jeden Tag von acht bis f√ºnf.",
              du: "Du arbeitest in einem interessanten Beruf.",
              Sie_formal: "Sie arbeiten in der N√§he von hier.",
              er: "Er arbeitet als Lehrer an einer Schule.",
              sie_fem: "Sie arbeitet im Marketing bei einer gro√üen Firma.",
              es: "Es arbeitet nicht richtig, das Ger√§t ist kaputt.",
              wir: "Wir arbeiten zusammen an diesem Projekt.",
              ihr: "Ihr arbeitet sehr effizient als Team.",
              sie_plural: "Sie arbeiten alle in derselben Abteilung.",
            },
            negative: {
              ich: "Ich arbeite nicht am Wochenende.",
              du: "Du arbeitest nicht mehr in der alten Firma.",
              Sie_formal: "Sie arbeiten nicht von zu Hause aus.",
              er: "Er arbeitet nicht gerne unter Zeitdruck.",
              sie_fem: "Sie arbeitet nicht mehr Vollzeit.",
              es: "Es arbeitet nicht, wenn der Strom ausf√§llt.",
              wir: "Wir arbeiten nicht an Feiertagen.",
              ihr: "Ihr arbeitet nicht so lange wie fr√ºher.",
              sie_plural: "Sie arbeiten nicht in der Nachtschicht.",
            },
            question: {
              ich: "Arbeite ich zu viel in letzter Zeit?",
              du: "Arbeitest du gerne in deinem neuen Job?",
              Sie_formal: "Arbeiten Sie schon lange in dieser Position?",
              er: "Arbeitet er heute auch im B√ºro?",
              sie_fem: "Arbeitet sie noch bei der Bank?",
              es: "Arbeitet es wieder richtig nach der Reparatur?",
              wir: "Arbeiten wir morgen an dem wichtigen Projekt?",
              ihr: "Arbeitet ihr auch am Samstag?",
              sie_plural: "Arbeiten sie alle im gleichen Geb√§ude?",
            },
          },
          translations: {
            statement: {
              ich: "T√¥i l√†m vi·ªác m·ªói ng√†y t·ª´ t√°m ƒë·∫øn nƒÉm gi·ªù.",
              du: "B·∫°n l√†m vi·ªác trong m·ªôt ngh·ªÅ th√∫ v·ªã.",
              Sie_formal: "Anh/ch·ªã l√†m vi·ªác g·∫ßn ƒë√¢y.",
              er: "Anh ·∫•y l√†m vi·ªác nh∆∞ m·ªôt gi√°o vi√™n ·ªü tr∆∞·ªùng.",
              sie_fem: "C√¥ ·∫•y l√†m vi·ªác trong marketing ·ªü m·ªôt c√¥ng ty l·ªõn.",
              es: "N√≥ kh√¥ng ho·∫°t ƒë·ªông ƒë√∫ng, thi·∫øt b·ªã b·ªã h·ªèng.",
              wir: "Ch√∫ng t√¥i l√†m vi·ªác c√πng nhau trong d·ª± √°n n√†y.",
              ihr: "C√°c b·∫°n l√†m vi·ªác r·∫•t hi·ªáu qu·∫£ nh∆∞ m·ªôt ƒë·ªôi.",
              sie_plural: "H·ªç ƒë·ªÅu l√†m vi·ªác trong c√πng m·ªôt b·ªô ph·∫≠n.",
            },
            negative: {
              ich: "T√¥i kh√¥ng l√†m vi·ªác v√†o cu·ªëi tu·∫ßn.",
              du: "B·∫°n kh√¥ng c√≤n l√†m vi·ªác ·ªü c√¥ng ty c≈© n·ªØa.",
              Sie_formal: "Anh/ch·ªã kh√¥ng l√†m vi·ªác t·ª´ nh√†.",
              er: "Anh ·∫•y kh√¥ng th√≠ch l√†m vi·ªác d∆∞·ªõi √°p l·ª±c th·ªùi gian.",
              sie_fem: "C√¥ ·∫•y kh√¥ng c√≤n l√†m vi·ªác to√†n th·ªùi gian n·ªØa.",
              es: "N√≥ kh√¥ng ho·∫°t ƒë·ªông khi m·∫•t ƒëi·ªán.",
              wir: "Ch√∫ng t√¥i kh√¥ng l√†m vi·ªác v√†o c√°c ng√†y l·ªÖ.",
              ihr: "C√°c b·∫°n kh√¥ng l√†m vi·ªác l√¢u nh∆∞ tr∆∞·ªõc n·ªØa.",
              sie_plural: "H·ªç kh√¥ng l√†m vi·ªác ca ƒë√™m.",
            },
            question: {
              ich: "T√¥i c√≥ l√†m vi·ªác qu√° nhi·ªÅu g·∫ßn ƒë√¢y kh√¥ng?",
              du: "B·∫°n c√≥ th√≠ch l√†m vi·ªác ·ªü c√¥ng vi·ªác m·ªõi kh√¥ng?",
              Sie_formal: "Anh/ch·ªã ƒë√£ l√†m vi·ªác ·ªü v·ªã tr√≠ n√†y l√¢u ch∆∞a?",
              er: "Anh ·∫•y h√¥m nay c≈©ng l√†m vi·ªác ·ªü vƒÉn ph√≤ng kh√¥ng?",
              sie_fem: "C√¥ ·∫•y v·∫´n c√≤n l√†m vi·ªác ·ªü ng√¢n h√†ng kh√¥ng?",
              es: "N√≥ c√≥ ho·∫°t ƒë·ªông tr·ªü l·∫°i ƒë√∫ng c√°ch sau khi s·ª≠a ch·ªØa kh√¥ng?",
              wir: "Ch√∫ng ta c√≥ l√†m vi·ªác trong d·ª± √°n quan tr·ªçng ng√†y mai kh√¥ng?",
              ihr: "C√°c b·∫°n c≈©ng l√†m vi·ªác v√†o th·ª© b·∫£y kh√¥ng?",
              sie_plural: "H·ªç c√≥ ƒë·ªÅu l√†m vi·ªác trong c√πng m·ªôt t√≤a nh√† kh√¥ng?",
            },
          },
        },
        k√∂nnen: {
          infinitive: "k√∂nnen",
          vietnamese: "c√≥ th·ªÉ",
          conjugations: {
            ich: "kann",
            du: "kannst",
            Sie_formal: "k√∂nnen",
            er: "kann",
            sie_fem: "kann",
            es: "kann",
            wir: "k√∂nnen",
            ihr: "k√∂nnt",
            sie_plural: "k√∂nnen",
          },
          sentences: {
            statement: {
              ich: "Ich kann drei Sprachen sprechen.",
              du: "Du kannst sehr gut kochen.",
              Sie_formal: "Sie k√∂nnen mir sicher helfen.",
              er: "Er kann ausgezeichnet Klavier spielen.",
              sie_fem: "Sie kann sehr schnell laufen.",
              es: "Es kann heute regnen.",
              wir: "Wir k√∂nnen morgen zusammen arbeiten.",
              ihr: "Ihr k√∂nnt stolz auf eure Leistung sein.",
              sie_plural: "Sie k√∂nnen alle sehr gut Deutsch sprechen.",
            },
            negative: {
              ich: "Ich kann heute nicht kommen.",
              du: "Du kannst das nicht alleine machen.",
              Sie_formal: "Sie k√∂nnen nicht alles gleichzeitig erledigen.",
              er: "Er kann nicht Auto fahren.",
              sie_fem: "Sie kann nicht schwimmen.",
              es: "Es kann nicht funktionieren ohne Strom.",
              wir: "Wir k√∂nnen nicht l√§nger warten.",
              ihr: "Ihr k√∂nnt nicht immer Recht haben.",
              sie_plural: "Sie k√∂nnen nicht alle zur gleichen Zeit sprechen.",
            },
            question: {
              ich: "Kann ich Ihnen dabei helfen?",
              du: "Kannst du mir das Buch leihen?",
              Sie_formal: "K√∂nnen Sie mir den Weg zeigen?",
              er: "Kann er uns morgen besuchen?",
              sie_fem: "Kann sie Chinesisch sprechen?",
              es: "Kann es wirklich so schwer sein?",
              wir: "K√∂nnen wir das Problem gemeinsam l√∂sen?",
              ihr: "K√∂nnt ihr uns beim Umzug helfen?",
              sie_plural: "K√∂nnen sie alle p√ºnktlich sein?",
            },
          },
          translations: {
            statement: {
              ich: "T√¥i c√≥ th·ªÉ n√≥i ba th·ª© ti·∫øng.",
              du: "B·∫°n c√≥ th·ªÉ n·∫•u ƒÉn r·∫•t ngon.",
              Sie_formal: "Anh/ch·ªã ch·∫Øc ch·∫Øn c√≥ th·ªÉ gi√∫p t√¥i.",
              er: "Anh ·∫•y c√≥ th·ªÉ ch∆°i piano r·∫•t xu·∫•t s·∫Øc.",
              sie_fem: "C√¥ ·∫•y c√≥ th·ªÉ ch·∫°y r·∫•t nhanh.",
              es: "H√¥m nay c√≥ th·ªÉ m∆∞a.",
              wir: "Ch√∫ng ta c√≥ th·ªÉ l√†m vi·ªác c√πng nhau ng√†y mai.",
              ihr: "C√°c b·∫°n c√≥ th·ªÉ t·ª± h√†o v·ªÅ th√†nh t√≠ch c·ªßa m√¨nh.",
              sie_plural: "H·ªç ƒë·ªÅu c√≥ th·ªÉ n√≥i ti·∫øng ƒê·ª©c r·∫•t t·ªët.",
            },
            negative: {
              ich: "T√¥i kh√¥ng th·ªÉ ƒë·∫øn h√¥m nay.",
              du: "B·∫°n kh√¥ng th·ªÉ l√†m ƒëi·ªÅu ƒë√≥ m·ªôt m√¨nh.",
              Sie_formal: "Anh/ch·ªã kh√¥ng th·ªÉ x·ª≠ l√Ω t·∫•t c·∫£ c√πng m·ªôt l√∫c.",
              er: "Anh ·∫•y kh√¥ng th·ªÉ l√°i xe.",
              sie_fem: "C√¥ ·∫•y kh√¥ng th·ªÉ b∆°i.",
              es: "N√≥ kh√¥ng th·ªÉ ho·∫°t ƒë·ªông m√† kh√¥ng c√≥ ƒëi·ªán.",
              wir: "Ch√∫ng t√¥i kh√¥ng th·ªÉ ƒë·ª£i l√¢u h∆°n n·ªØa.",
              ihr: "C√°c b·∫°n kh√¥ng th·ªÉ lu√¥n ƒë√∫ng.",
              sie_plural: "H·ªç kh√¥ng th·ªÉ t·∫•t c·∫£ c√πng n√≥i m·ªôt l√∫c.",
            },
            question: {
              ich: "T√¥i c√≥ th·ªÉ gi√∫p anh/ch·ªã vi·ªác ƒë√≥ kh√¥ng?",
              du: "B·∫°n c√≥ th·ªÉ cho t√¥i m∆∞·ª£n cu·ªën s√°ch kh√¥ng?",
              Sie_formal: "Anh/ch·ªã c√≥ th·ªÉ ch·ªâ ƒë∆∞·ªùng cho t√¥i kh√¥ng?",
              er: "Anh ·∫•y c√≥ th·ªÉ ƒë·∫øn thƒÉm ch√∫ng ta ng√†y mai kh√¥ng?",
              sie_fem: "C√¥ ·∫•y c√≥ th·ªÉ n√≥i ti·∫øng Trung kh√¥ng?",
              es: "C√≥ th·ªÉ n√†o n√≥ l·∫°i kh√≥ nh∆∞ v·∫≠y?",
              wir: "Ch√∫ng ta c√≥ th·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ c√πng nhau kh√¥ng?",
              ihr: "C√°c b·∫°n c√≥ th·ªÉ gi√∫p ch√∫ng t√¥i chuy·ªÉn nh√† kh√¥ng?",
              sie_plural: "H·ªç c√≥ th·ªÉ ƒë·ªÅu ƒë√∫ng gi·ªù kh√¥ng?",
            },
          },
        },
        finden: {
          infinitive: "finden",
          vietnamese: "t√¨m th·∫•y",
          conjugations: {
            ich: "finde",
            du: "findest",
            Sie_formal: "finden",
            er: "findet",
            sie_fem: "findet",
            es: "findet",
            wir: "finden",
            ihr: "findet",
            sie_plural: "finden",
          },
        },
        leben: {
          infinitive: "leben",
          vietnamese: "s·ªëng",
          conjugations: {
            ich: "lebe",
            du: "lebst",
            Sie_formal: "leben",
            er: "lebt",
            sie_fem: "lebt",
            es: "lebt",
            wir: "leben",
            ihr: "lebt",
            sie_plural: "leben",
          },
        },
      };

      // Game state variables
      let currentGameMode = "";
      let currentQuestionIndex = 0;
      let currentWord = null;
      let currentConjugation = null;
      let currentSentenceType = "statement";
      let questionsData = [];
      let totalQuestions = 210;
      let isAnswered = false;

      // Game progress for each mode (separate tracking)
      let gameProgress = {
        listening: {
          correctAnswers: 0,
          wrongAnswers: 0,
          score: 0,
          currentIndex: 0,
          questionsData: [],
        },
        speaking: {
          correctAnswers: 0,
          wrongAnswers: 0,
          score: 0,
          currentIndex: 0,
          questionsData: [],
        },
        reading: {
          correctAnswers: 0,
          wrongAnswers: 0,
          score: 0,
          currentIndex: 0,
          questionsData: [],
        },
        writing: {
          correctAnswers: 0,
          wrongAnswers: 0,
          score: 0,
          currentIndex: 0,
          questionsData: [],
        },
        conjugation: {
          correctAnswers: 0,
          wrongAnswers: 0,
          score: 0,
          currentIndex: 0,
          questionsData: [],
        },
      };

      // Speech recognition variables
      let recognition = null;
      let isRecording = false;

      // Audio context for sound effects
      let audioContext = null;
      let gainNode = null;

      // Text-to-Speech function
      function speakWord(text) {
        if ("speechSynthesis" in window) {
          speechSynthesis.cancel();
          const utterance = new SpeechSynthesisUtterance(text);
          const voices = speechSynthesis.getVoices();
          const germanVoice = voices.find(
            (voice) =>
              voice.lang.includes("de") ||
              voice.name.toLowerCase().includes("german") ||
              voice.name.toLowerCase().includes("deutsch")
          );

          if (germanVoice) {
            utterance.voice = germanVoice;
          }

          utterance.lang = "de-DE";
          utterance.rate = 0.8;
          utterance.pitch = 1;
          utterance.volume = 1;

          speechSynthesis.speak(utterance);
        }
      }

      // Show vocabulary summary
      function showVocabularySummary() {
        document.getElementById("mainMenu").style.display = "none";
        document.getElementById("gameArea").style.display = "none";
        document.getElementById("results").style.display = "none";
        document.getElementById("vocabularySummary").style.display = "block";
        document.getElementById("backButton").classList.add("show");

        // Initialize vocabulary display
        initializeVocabularyDisplay();
      }

      // Initialize vocabulary display
      function initializeVocabularyDisplay() {
        const groups = groupVocabularyByAlphabet(vocabulary);
        const alphabetNav = document.getElementById("vocabularyAlphabetNav");
        const vocabularyContainer = document.getElementById(
          "vocabularyContainer"
        );

        // Generate alphabet navigation
        const letters = Object.keys(groups).sort();
        alphabetNav.innerHTML = letters
          .map(
            (letter) =>
              `<a href="#vocab-section-${letter}" class="alphabet-btn">${letter}</a>`
          )
          .join("");

        // Generate vocabulary sections
        vocabularyContainer.innerHTML = letters
          .map(
            (letter) => `
          <div class="category" id="vocab-section-${letter}">
            <div class="category-title">üìñ CH·ªÆ ${letter} (${
              groups[letter].length
            } t·ª´)</div>
            <div class="vocabulary-grid">
              ${groups[letter]
                .map((word) => generateVocabularyCard(word))
                .join("")}
            </div>
          </div>
        `
          )
          .join("");

        // Add search event listener
        document
          .getElementById("vocabularySearchBox")
          .addEventListener("input", searchVocabulary);
      }

      // Group vocabulary by first letter
      function groupVocabularyByAlphabet(vocab) {
        const groups = {};
        vocab.forEach((word) => {
          const firstLetter = word.german.charAt(0).toUpperCase();
          if (!groups[firstLetter]) {
            groups[firstLetter] = [];
          }
          groups[firstLetter].push(word);
        });

        // Sort within each group
        Object.keys(groups).forEach((letter) => {
          groups[letter].sort((a, b) => a.german.localeCompare(b.german));
        });

        return groups;
      }

      // Generate vocabulary card
      function generateVocabularyCard(word) {
        const example =
          exampleSentences[word.german] || createContextualExample(word);
        const priority = getPriorityLevel(word);

        return `
          <div class="vocab-card">
            <div class="vocab-priority vocab-${priority}-priority">${getPriorityText(
          priority
        )}</div>
            <div class="vocab-german-word" onclick="speakWord('${
              word.german
            }')">
              ${word.german} <span class="speaker-icon">üîä</span>
            </div>
            <div class="vocab-pronunciation">[${getPhonetic(word.german)}]</div>
            <div class="vocab-vietnamese">${word.vietnamese}</div>
            <div class="vocab-examples">
              <div class="vocab-example" onclick="speakWord('${
                example.german.split(" = ")[0]
              }')">
                üîä <span class="vocab-example-german">${
                  example.german
                }</span><br>
                <span class="vocab-example-vietnamese">${
                  example.vietnamese
                }</span>
              </div>
            </div>
            <div class="vocab-lesson-tag">Nh√≥m ${word.lesson}</div>
          </div>
        `;
      }

      // Get priority level for word
      function getPriorityLevel(word) {
        const highPriority = [
          "aber",
          "arbeiten",
          "alt",
          "drei",
          "eins",
          "zwei",
          "k√∂nnen",
          "finden",
          "Mann",
          "Frau",
          "Kind",
          "Mutter",
          "Vater",
        ];
        const mediumPriority = [
          "Beruf",
          "Chef",
          "Eltern",
          "Freund",
          "genau",
          "jung",
          "nett",
          "sch√∂n",
          "Telefon",
          "wirklich",
        ];

        if (highPriority.includes(word.german)) return "high";
        if (mediumPriority.includes(word.german)) return "medium";
        return "basic";
      }

      // Get priority text
      function getPriorityText(priority) {
        const texts = {
          high: "SI√äU QUAN TR·ªåNG",
          medium: "QUAN TR·ªåNG",
          basic: "C∆† B·∫¢N",
        };
        return texts[priority];
      }

      // Get phonetic pronunciation
      function getPhonetic(german) {
        const phonetics = {
          aber: "a-b…ôr",
          ach: "akh",
          acht: "akht",
          arbeiten: "ar-bai-t…ôn",
          alt: "alt",
          Baby: "be-bi",
          Beruf: "b…ô-ruf",
          Bruder: "bru-d…ôr",
          Chef: " É…õf",
          da: "da",
          drei: "drai",
          eins: "ains",
          Eltern: "…õl-t…ôrn",
          falsch: "fal É",
          Freund: "fr…îint",
          genau: "g…ô-nau",
          Gitarre: "gi-ta-r…ô",
          Handy: "h…õn-di",
          jung: "j ä≈ã",
          k√∂nnen: "k≈ì-n…ôn",
          Mann: "man",
          Mutter: "mu-t…ôr",
          nett: "n…õt",
          Oma: "o-ma",
          sch√∂n: " É√∏n",
          Telefon: "te-le-fon",
          Vater: "fa-t…ôr",
          wirklich: "virk-likh",
          zwei: "tsvai",
        };
        return phonetics[german] || german.toLowerCase();
      }

      // Create contextual examples for words
      function createContextualExample(word) {
        return {
          german: `Ich lerne das Wort "${word.german}".`,
          vietnamese: `T√¥i h·ªçc t·ª´ "${word.german}" nghƒ©a l√† ${word.vietnamese}.`,
        };
      }

      // Search vocabulary function
      function searchVocabulary() {
        const searchTerm = document
          .getElementById("vocabularySearchBox")
          .value.toLowerCase();
        const allCards = document.querySelectorAll(".vocab-card");

        allCards.forEach((card) => {
          const germanWord = card
            .querySelector(".vocab-german-word")
            .textContent.toLowerCase();
          const vietnamese = card
            .querySelector(".vocab-vietnamese")
            .textContent.toLowerCase();
          const examples = Array.from(card.querySelectorAll(".vocab-example"))
            .map((ex) => ex.textContent.toLowerCase())
            .join(" ");

          if (
            germanWord.includes(searchTerm) ||
            vietnamese.includes(searchTerm) ||
            examples.includes(searchTerm)
          ) {
            card.style.display = "block";
          } else {
            card.style.display = "none";
          }
        });

        // Hide empty categories
        document.querySelectorAll(".category").forEach((category) => {
          const visibleCards = category.querySelectorAll(
            '.vocab-card[style="display: block"], .vocab-card:not([style*="display: none"])'
          );
          category.style.display = visibleCards.length > 0 ? "block" : "none";
        });
      }

      // Initialize game functions
      function startGame(mode) {
        currentGameMode = mode;

        // Get current progress for this mode
        const progress = gameProgress[mode];
        currentQuestionIndex = progress.currentIndex;

        // Generate questions based on mode
        if (mode === "conjugation") {
          if (
            progress.questionsData.length === 0 ||
            currentQuestionIndex >= progress.questionsData.length
          ) {
            progress.questionsData = generateConjugationQuestions();
            progress.currentIndex = 0;
            currentQuestionIndex = 0;
          }
          questionsData = progress.questionsData;
          totalQuestions = questionsData.length;
        } else {
          // Regular vocabulary questions
          if (
            progress.questionsData.length === 0 ||
            currentQuestionIndex >= progress.questionsData.length
          ) {
            progress.questionsData = generateQuestions();
            progress.currentIndex = 0;
            currentQuestionIndex = 0;
          }
          questionsData = progress.questionsData;
          totalQuestions = questionsData.length;
        }

        isAnswered = false;

        // Show game area
        document.getElementById("mainMenu").style.display = "none";
        document.getElementById("vocabularySummary").style.display = "none";
        document.getElementById("gameArea").style.display = "block";
        document.getElementById("results").style.display = "none";
        document.getElementById("backButton").classList.add("show");

        // Set game styles for different modes
        const gameHeader = document.getElementById("gameHeader");
        const gameTitle = document.getElementById("gameTitle");
        const questionArea = document.getElementById("questionArea");
        const progressFill = document.getElementById("progressFill");

        // Reset all mode classes
        gameHeader.classList.remove("conjugation", "vocabulary");
        gameTitle.classList.remove("conjugation", "vocabulary");
        questionArea.classList.remove("conjugation", "vocabulary");
        progressFill.classList.remove("conjugation", "vocabulary");

        if (mode === "conjugation") {
          gameHeader.classList.add("conjugation");
          gameTitle.classList.add("conjugation");
          questionArea.classList.add("conjugation");
          progressFill.classList.add("conjugation");
        }

        // Set game title
        const titles = {
          listening: "üëÇ Luy·ªán Nghe",
          speaking: "üó£Ô∏è Luy·ªán N√≥i",
          reading: "üëÅÔ∏è Luy·ªán ƒê·ªçc",
          writing: "‚úçÔ∏è Luy·ªán Vi·∫øt",
          conjugation: "üìù Chia ƒê·ªông T·ª´",
        };
        gameTitle.textContent = titles[mode];

        // Initialize speech recognition for speaking mode
        if (mode === "speaking") {
          initializeSpeechRecognition();
        }

        // Setup sentence type selector for conjugation mode
        if (mode === "conjugation") {
          setupSentenceTypeSelector();
        }

        // Update score display
        updateScore();

        // Load current question
        loadQuestion();
      }

      // Generate conjugation questions
      function generateConjugationQuestions() {
        const questions = [];
        const verbs = Object.keys(verbConjugations);
        const pronounKeys = [
          "ich",
          "du",
          "Sie_formal",
          "er",
          "sie_fem",
          "es",
          "wir",
          "ihr",
          "sie_plural",
        ];
        const sentenceTypes = ["statement", "negative", "question"];

        // Generate questions for each verb, pronoun, and sentence type combination
        verbs.forEach((verb) => {
          pronounKeys.forEach((pronounKey) => {
            sentenceTypes.forEach((sentenceType) => {
              const pronoun = getPronounDisplay(pronounKey);
              const correctAnswer = buildCorrectSentence(
                verb,
                pronounKey,
                sentenceType
              );

              questions.push({
                verb: verb,
                pronoun: pronoun,
                pronounKey: pronounKey,
                sentenceType: sentenceType,
                correctAnswer: correctAnswer,
                verbData: verbConjugations[verb],
              });
            });
          });
        });

        return questions.sort(() => 0.5 - Math.random());
      }

      // Build correct sentence based on verb, pronoun, and sentence type
      function buildCorrectSentence(verb, pronounKey, sentenceType) {
        const verbData = verbConjugations[verb];
        if (
          verbData.sentences &&
          verbData.sentences[sentenceType] &&
          verbData.sentences[sentenceType][pronounKey]
        ) {
          return verbData.sentences[sentenceType][pronounKey];
        }

        // Fallback to basic conjugation
        const pronoun = getPronounDisplay(pronounKey);
        const conjugatedVerb = verbData.conjugations[pronounKey];

        switch (sentenceType) {
          case "statement":
            return `${pronoun} ${conjugatedVerb}.`;
          case "negative":
            return `${pronoun} ${conjugatedVerb} nicht.`;
          case "question":
            return `${
              conjugatedVerb.charAt(0).toUpperCase() + conjugatedVerb.slice(1)
            } ${pronoun.toLowerCase()}?`;
          default:
            return `${pronoun} ${conjugatedVerb}.`;
        }
      }

      // Get pronoun display text
      function getPronounDisplay(pronounKey) {
        const pronounMap = {
          ich: "ich",
          du: "du",
          Sie_formal: "Sie",
          er: "er",
          sie_fem: "sie",
          es: "es",
          wir: "wir",
          ihr: "ihr",
          sie_plural: "sie",
        };
        return pronounMap[pronounKey] || pronounKey;
      }

      // Generate random questions for vocabulary modes
      function generateQuestions() {
        const shuffled = [...vocabulary].sort(() => 0.5 - Math.random());
        return shuffled;
      }

      // Initialize speech recognition
      function initializeSpeechRecognition() {
        if (
          "webkitSpeechRecognition" in window ||
          "SpeechRecognition" in window
        ) {
          const SpeechRecognition =
            window.SpeechRecognition || window.webkitSpeechRecognition;
          recognition = new SpeechRecognition();
          recognition.lang = "de-DE";
          recognition.continuous = false;
          recognition.interimResults = false;

          recognition.onstart = function () {
            isRecording = true;
            document.getElementById("micButton").classList.add("recording");
            document.getElementById("recognitionStatus").textContent =
              "ƒêang nghe... H√£y ph√°t √¢m t·ª´ ti·∫øng ƒê·ª©c";
          };

          recognition.onresult = function (event) {
            const transcript = event.results[0][0].transcript.toLowerCase();
            const targetWord = currentWord.german.toLowerCase();
            const progress = gameProgress[currentGameMode];

            document.getElementById(
              "recognitionStatus"
            ).textContent = `B·∫°n ƒë√£ n√≥i: "${transcript}"`;

            // Simple pronunciation check
            const similarity = calculateSimilarity(transcript, targetWord);
            const feedback = document.getElementById("pronunciationFeedback");
            feedback.style.display = "block";

            if (similarity > 0.7) {
              feedback.innerHTML = "üéâ Xu·∫•t s·∫Øc! Ph√°t √¢m r·∫•t t·ªët!";
              feedback.style.background = "#d4edda";
              feedback.style.color = "#155724";
              progress.correctAnswers++;
              progress.score += 10;
            } else if (similarity > 0.4) {
              feedback.innerHTML = "üëç T·ªët! H√£y th·ª≠ l·∫ßn n·ªØa ƒë·ªÉ ho√†n thi·ªán h∆°n.";
              feedback.style.background = "#fff3cd";
              feedback.style.color = "#856404";
              progress.score += 5;
            } else {
              feedback.innerHTML =
                "üí™ C·∫ßn luy·ªán t·∫≠p th√™m. H√£y nghe v√† th·ª≠ l·∫°i!";
              feedback.style.background = "#f8d7da";
              feedback.style.color = "#721c24";
              progress.wrongAnswers++;
            }

            updateScore();
            showNextButton();
          };

          recognition.onerror = function (event) {
            document.getElementById("recognitionStatus").textContent =
              "L·ªói nh·∫≠n di·ªán gi·ªçng n√≥i. Vui l√≤ng th·ª≠ l·∫°i.";
          };

          recognition.onend = function () {
            isRecording = false;
            document.getElementById("micButton").classList.remove("recording");
          };
        }
      }

      // Calculate similarity between two strings
      function calculateSimilarity(str1, str2) {
        const longer = str1.length > str2.length ? str1 : str2;
        const shorter = str1.length > str2.length ? str2 : str1;
        const editDistance = getEditDistance(longer, shorter);
        return (longer.length - editDistance) / longer.length;
      }

      // Calculate edit distance
      function getEditDistance(str1, str2) {
        const matrix = [];
        for (let i = 0; i <= str2.length; i++) {
          matrix[i] = [i];
        }
        for (let j = 0; j <= str1.length; j++) {
          matrix[0][j] = j;
        }
        for (let i = 1; i <= str2.length; i++) {
          for (let j = 1; j <= str1.length; j++) {
            if (str2.charAt(i - 1) === str1.charAt(j - 1)) {
              matrix[i][j] = matrix[i - 1][j - 1];
            } else {
              matrix[i][j] = Math.min(
                matrix[i - 1][j - 1] + 1,
                matrix[i][j - 1] + 1,
                matrix[i - 1][j] + 1
              );
            }
          }
        }
        return matrix[str2.length][str1.length];
      }

      // Load current question
      function loadQuestion() {
        if (currentQuestionIndex >= questionsData.length) {
          showResults();
          return;
        }

        if (currentGameMode === "conjugation") {
          currentConjugation = questionsData[currentQuestionIndex];
        } else {
          currentWord = questionsData[currentQuestionIndex];
        }

        isAnswered = false;

        // Update progress
        document.getElementById("currentQuestion").textContent =
          currentQuestionIndex + 1;
        document.getElementById("totalQuestions").textContent =
          questionsData.length;
        document.getElementById("remainingCount").textContent =
          questionsData.length - currentQuestionIndex;
        const progress = (currentQuestionIndex / questionsData.length) * 100;
        document.getElementById("progressFill").style.width = progress + "%";

        // Hide feedback and next button
        document.getElementById("feedback").style.display = "none";
        document.getElementById("nextButton").style.display = "none";
        document.getElementById("exampleSentence").style.display = "none";

        // Setup question based on game mode
        setupQuestionByMode();
      }

      // Setup question based on game mode
      function setupQuestionByMode() {
        const questionEl = document.getElementById("question");
        const germanWordEl = document.getElementById("germanWord");
        const optionsEl = document.getElementById("options");
        const speechAreaEl = document.getElementById("speechArea");
        const inputAreaEl = document.getElementById("inputArea");
        const conjugationDisplayEl =
          document.getElementById("conjugationDisplay");
        const sentenceTypeSelectorEl = document.getElementById(
          "sentenceTypeSelector"
        );
        const translationHelpEl = document.getElementById("translationHelp");
        const playButtonEl = document.getElementById("playButton");
        const submitButtonEl = document.getElementById("submitButton");

        // Reset all areas
        germanWordEl.style.display = "none";
        speechAreaEl.style.display = "none";
        inputAreaEl.style.display = "none";
        conjugationDisplayEl.style.display = "none";
        sentenceTypeSelectorEl.style.display = "none";
        translationHelpEl.style.display = "none";
        optionsEl.style.display = "grid";
        playButtonEl.style.display = "inline-flex";
        submitButtonEl.style.display = "none";

        // Remove conjugation classes from elements
        const textInput = document.getElementById("textInput");
        textInput.classList.remove("conjugation");
        optionsEl.querySelectorAll(".option").forEach((option) => {
          option.classList.remove("conjugation");
        });

        switch (currentGameMode) {
          case "listening":
            questionEl.textContent = "Nghe t·ª´ v·ª±ng v√† ch·ªçn nghƒ©a ƒë√∫ng:";
            germanWordEl.style.display = "block";
            germanWordEl.textContent = "üîä Nh·∫•n ƒë·ªÉ nghe";
            generateOptions();
            setTimeout(() => speakWord(currentWord.german), 500);
            break;

          case "speaking":
            questionEl.textContent = "Ph√°t √¢m t·ª´ ti·∫øng ƒê·ª©c sau:";
            speechAreaEl.style.display = "block";
            optionsEl.style.display = "none";
            playButtonEl.style.display = "none";
            document.getElementById("speakingWord").textContent =
              currentWord.german;
            document.getElementById("recognitionStatus").textContent =
              "Nh·∫•n v√†o micro ƒë·ªÉ b·∫Øt ƒë·∫ßu";
            document.getElementById("pronunciationFeedback").style.display =
              "none";
            break;

          case "reading":
            questionEl.textContent =
              "ƒê·ªçc t·ª´ v·ª±ng ti·∫øng ƒê·ª©c v√† ch·ªçn nghƒ©a ƒë√∫ng:";
            germanWordEl.style.display = "block";
            germanWordEl.textContent = currentWord.german;
            generateOptions();
            break;

          case "writing":
            questionEl.textContent = `G√µ t·ª´ ti·∫øng ƒê·ª©c c√≥ nghƒ©a: "${currentWord.vietnamese}"`;
            inputAreaEl.style.display = "block";
            optionsEl.style.display = "none";
            playButtonEl.style.display = "none";
            submitButtonEl.style.display = "inline-flex";

            // Setup input for writing
            const writingInput = document.getElementById("textInput");
            writingInput.value = "";
            writingInput.placeholder = `Nh·∫≠p t·ª´ ti·∫øng ƒê·ª©c c√≥ nghƒ©a "${currentWord.vietnamese}"...`;
            writingInput.focus();
            break;

          case "conjugation":
            // Reset sentence type to statement
            currentSentenceType = "statement";
            const activeBtn = document.querySelector(
              ".sentence-type-btn.active"
            );
            if (activeBtn) activeBtn.classList.remove("active");
            document
              .querySelector('.sentence-type-btn[data-type="statement"]')
              .classList.add("active");

            questionEl.innerHTML = `
              <div style="margin-bottom: 20px;">
                <h3 style="color: #ff6b6b; margin-bottom: 15px;">üìù T·∫°o c√¢u kh·∫≥ng ƒë·ªãnh v·ªõi ƒë·ªông t·ª´ "${currentConjugation.verbData.infinitive}" v√† ƒë·∫°i t·ª´ "${currentConjugation.pronoun}"</h3>
              </div>
            `;

            sentenceTypeSelectorEl.style.display = "block";
            conjugationDisplayEl.style.display = "block";
            translationHelpEl.style.display = "block";
            inputAreaEl.style.display = "block";
            optionsEl.style.display = "none";
            playButtonEl.style.display = "none";
            submitButtonEl.style.display = "inline-flex";

            // Display conjugation info
            document.getElementById("pronounDisplay").textContent =
              currentConjugation.pronoun;
            document.getElementById(
              "verbInfinitive"
            ).textContent = `${currentConjugation.verbData.infinitive} (${currentConjugation.verbData.vietnamese})`;

            // Setup input
            const conjugationInput = document.getElementById("textInput");
            conjugationInput.classList.add("conjugation");
            conjugationInput.value = "";
            conjugationInput.placeholder = `Nh·∫≠p c√¢u kh·∫≥ng ƒë·ªãnh...`;
            conjugationInput.focus();
            break;
        }
      }

      // Setup sentence type selector
      function setupSentenceTypeSelector() {
        const buttons = document.querySelectorAll(".sentence-type-btn");
        buttons.forEach((button) => {
          button.addEventListener("click", () => {
            // Remove active class from all buttons
            buttons.forEach((btn) => btn.classList.remove("active"));

            // Add active class to clicked button
            button.classList.add("active");

            // Update current sentence type
            currentSentenceType = button.dataset.type;

            // Update preview
            updateSentencePreview();
          });
        });
      }

      // Update sentence preview
      function updateSentencePreview() {
        if (!currentConjugation) return;

        const previewText = document.getElementById("previewText");
        const exampleSentence = buildCorrectSentence(
          currentConjugation.verb,
          currentConjugation.pronounKey,
          currentSentenceType
        );

        previewText.textContent = exampleSentence;
      }

      // Generate options for multiple choice questions
      function generateOptions() {
        const optionsEl = document.getElementById("options");
        optionsEl.innerHTML = "";

        // Get 3 wrong answers
        const wrongAnswers = vocabulary
          .filter((word) => word.vietnamese !== currentWord.vietnamese)
          .sort(() => 0.5 - Math.random())
          .slice(0, 3);

        // Combine with correct answer and shuffle
        const allOptions = [currentWord, ...wrongAnswers].sort(
          () => 0.5 - Math.random()
        );

        allOptions.forEach((option) => {
          const optionEl = document.createElement("div");
          optionEl.className = "option";
          optionEl.textContent = option.vietnamese;
          optionEl.onclick = () =>
            selectOption(
              optionEl,
              option.vietnamese === currentWord.vietnamese
            );
          optionsEl.appendChild(optionEl);
        });
      }

      // Select option
      function selectOption(optionEl, isCorrect) {
        if (isAnswered) return;

        isAnswered = true;
        const progress = gameProgress[currentGameMode];
        const allOptions = document.querySelectorAll(".option");

        allOptions.forEach((option) => {
          option.classList.add("disabled");
          if (option.textContent === currentWord.vietnamese) {
            option.classList.add("correct");
          }
        });

        if (isCorrect) {
          optionEl.classList.add("correct");
          showFeedback(true, "üéâ Ch√≠nh x√°c! Tuy·ªát v·ªùi!");
          progress.correctAnswers++;
          progress.score += 10;

          // Show example sentence after correct answer
          setTimeout(() => {
            showExampleSentence();
          }, 1000);
        } else {
          optionEl.classList.add("wrong");
          showFeedback(
            false,
            `‚ùå Sai r·ªìi! ƒê√°p √°n ƒë√∫ng l√†: "${currentWord.vietnamese}"`
          );
          progress.wrongAnswers++;

          // Show example sentence after wrong answer too
          setTimeout(() => {
            showExampleSentence();
          }, 1500);
        }

        updateScore();
        showNextButton();
      }

      // Show example sentence
      function showExampleSentence() {
        const exampleSentenceEl = document.getElementById("exampleSentence");
        const germanSentenceEl = document.getElementById("germanSentence");
        const vietnameseSentenceEl =
          document.getElementById("vietnameseSentence");

        // Get example sentence for current word
        const example =
          exampleSentences[currentWord.german] ||
          createContextualExample(currentWord);

        germanSentenceEl.textContent = example.german;
        vietnameseSentenceEl.textContent = example.vietnamese;

        exampleSentenceEl.style.display = "block";
      }

      // Submit answer for writing and conjugation modes
      function submitAnswer() {
        if (isAnswered) return;

        const progress = gameProgress[currentGameMode];

        if (currentGameMode === "conjugation") {
          const userAnswer = document
            .getElementById("textInput")
            .value.trim()
            .toLowerCase();

          isAnswered = true;

          // Build expected answer based on current sentence type
          const correctAnswer = buildCorrectSentence(
            currentConjugation.verb,
            currentConjugation.pronounKey,
            currentSentenceType
          ).toLowerCase();

          // Normalize for comparison
          const normalizedUserAnswer = userAnswer.replace(/[.,!?]/g, "").trim();
          const normalizedCorrectAnswer = correctAnswer
            .replace(/[.,!?]/g, "")
            .trim();

          if (normalizedUserAnswer === normalizedCorrectAnswer) {
            showFeedback(true, `üéâ Ch√≠nh x√°c! C√¢u ƒë√∫ng: "${correctAnswer}"`);
            progress.correctAnswers++;
            progress.score += 10;
          } else {
            showFeedback(
              false,
              `‚ùå Ch∆∞a ƒë√∫ng! ƒê√°p √°n ƒë√∫ng: "${correctAnswer}"`
            );
            progress.wrongAnswers++;
          }
        } else if (currentGameMode === "writing") {
          const userAnswer = document
            .getElementById("textInput")
            .value.trim()
            .toLowerCase();

          isAnswered = true;
          const correctAnswer = currentWord.german.toLowerCase();

          if (userAnswer === correctAnswer) {
            showFeedback(true, "üéâ Ch√≠nh x√°c! B·∫°n ƒë√£ vi·∫øt ƒë√∫ng!");
            progress.correctAnswers++;
            progress.score += 10;

            // Show example sentence after correct answer
            setTimeout(() => {
              showExampleSentence();
            }, 1000);
          } else {
            showFeedback(
              false,
              `‚ùå Sai r·ªìi! ƒê√°p √°n ƒë√∫ng l√†: "${currentWord.german}"`
            );
            progress.wrongAnswers++;

            // Show example sentence after wrong answer too
            setTimeout(() => {
              showExampleSentence();
            }, 1500);
          }
        }

        updateScore();
        showNextButton();
        document.getElementById("submitButton").style.display = "none";
      }

      // Show feedback
      function showFeedback(isCorrect, message) {
        const feedbackEl = document.getElementById("feedback");
        feedbackEl.style.display = "block";
        feedbackEl.textContent = message;
        feedbackEl.className = `feedback ${isCorrect ? "correct" : "wrong"}`;
      }

      // Show next button
      function showNextButton() {
        document.getElementById("nextButton").style.display = "inline-flex";
      }

      // Update score display
      function updateScore() {
        const progress = gameProgress[currentGameMode];
        document.getElementById("correctCount").textContent =
          progress.correctAnswers;
        document.getElementById("wrongCount").textContent =
          progress.wrongAnswers;
        document.getElementById("score").textContent = progress.score;
      }

      // Next question
      function nextQuestion() {
        currentQuestionIndex++;
        gameProgress[currentGameMode].currentIndex = currentQuestionIndex;
        loadQuestion();
      }

      // Skip question
      function skipQuestion() {
        if (!isAnswered) {
          gameProgress[currentGameMode].wrongAnswers++;
          updateScore();
        }
        nextQuestion();
      }

      // Play current word
      function playCurrentWord() {
        if (currentWord) {
          speakWord(currentWord.german);
        }
      }

      // Speak sentence
      function speakSentence() {
        const germanSentence =
          document.getElementById("germanSentence").textContent;
        if (germanSentence) {
          speakWord(germanSentence);
        }
      }

      // Toggle recording for speaking mode
      function toggleRecording() {
        if (!recognition) {
          alert("Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ nh·∫≠n di·ªán gi·ªçng n√≥i");
          return;
        }

        if (isRecording) {
          recognition.stop();
        } else {
          recognition.start();
        }
      }

      // Show results
      function showResults() {
        document.getElementById("gameArea").style.display = "none";
        document.getElementById("results").style.display = "block";

        const progress = gameProgress[currentGameMode];
        const totalAnswered = progress.correctAnswers + progress.wrongAnswers;
        const accuracy =
          totalAnswered > 0
            ? Math.round((progress.correctAnswers / totalAnswered) * 100)
            : 0;

        // Add styling to results if needed
        const finalScore = document.getElementById("finalScore");
        if (currentGameMode === "conjugation") {
          finalScore.classList.add("conjugation");
        } else if (currentGameMode === "vocabulary") {
          finalScore.classList.add("vocabulary");
        } else {
          finalScore.classList.remove("conjugation", "vocabulary");
        }

        document.getElementById("finalScore").textContent = progress.score;
        document.getElementById("finalCorrect").textContent =
          progress.correctAnswers;
        document.getElementById("finalWrong").textContent =
          progress.wrongAnswers;
        document.getElementById("finalAccuracy").textContent = accuracy + "%";
      }

      // Restart game
      function restartGame() {
        // Reset progress for current mode
        gameProgress[currentGameMode] = {
          correctAnswers: 0,
          wrongAnswers: 0,
          score: 0,
          currentIndex: 0,
          questionsData: [],
        };
        startGame(currentGameMode);
      }

      // Show main menu
      function showMainMenu() {
        document.getElementById("mainMenu").style.display = "block";
        document.getElementById("gameArea").style.display = "none";
        document.getElementById("vocabularySummary").style.display = "none";
        document.getElementById("results").style.display = "none";
        document.getElementById("backButton").classList.remove("show");

        // Update progress display for each mode
        updateModeProgress();
      }

      // Update progress display for each game mode
      function updateModeProgress() {
        const modes = [
          "listening",
          "speaking",
          "reading",
          "writing",
          "conjugation",
        ];

        modes.forEach((mode) => {
          const progress = gameProgress[mode];
          const progressEl = document.getElementById(mode + "Progress");

          if (
            progress.currentIndex > 0 ||
            progress.correctAnswers > 0 ||
            progress.wrongAnswers > 0
          ) {
            const totalAnswered =
              progress.correctAnswers + progress.wrongAnswers;
            const accuracy =
              totalAnswered > 0
                ? Math.round((progress.correctAnswers / totalAnswered) * 100)
                : 0;

            if (mode === "conjugation") {
              progressEl.textContent = `üìä ${progress.currentIndex}/${
                Object.keys(verbConjugations).length * 9 * 3
              } - ‚úÖ ${progress.correctAnswers} - ‚≠ê ${
                progress.score
              } - üéØ ${accuracy}%`;
            } else {
              progressEl.textContent = `üìä ${progress.currentIndex}/210 - ‚úÖ ${progress.correctAnswers} - ‚≠ê ${progress.score} - üéØ ${accuracy}%`;
            }
            progressEl.classList.add("has-progress");
          } else {
            progressEl.textContent =
              "üî• Ch∆∞a b·∫Øt ƒë·∫ßu - H√£y th·ª≠ th√°ch b·∫£n th√¢n!";
            progressEl.classList.remove("has-progress");
          }
        });
      }

      // Initialize page
      document.addEventListener("DOMContentLoaded", function () {
        // Text input handler
        document
          .getElementById("textInput")
          .addEventListener("keypress", function (e) {
            if (e.key === "Enter" && !isAnswered) {
              submitAnswer();
            }
          });

        // Load voices when page loads
        if ("speechSynthesis" in window) {
          speechSynthesis.addEventListener("voiceschanged", function () {
            console.log("Voices loaded:", speechSynthesis.getVoices().length);
          });
        }

        // Initialize progress display on page load
        updateModeProgress();
      });

      // Keyboard shortcuts
      document.addEventListener("keydown", function (e) {
        // Only if game area or vocabulary summary is visible
        if (
          document.getElementById("gameArea").style.display === "block" ||
          document.getElementById("vocabularySummary").style.display === "block"
        ) {
          switch (e.key) {
            case " ": // Spacebar for audio
              e.preventDefault();
              if (
                currentGameMode === "listening" ||
                currentGameMode === "reading"
              ) {
                playCurrentWord();
              }
              break;
            case "Enter":
              e.preventDefault();
              if (
                document.getElementById("nextButton").style.display !== "none"
              ) {
                nextQuestion();
              } else if (
                document.getElementById("submitButton").style.display !== "none"
              ) {
                submitAnswer();
              }
              break;
            case "Escape":
              e.preventDefault();
              showMainMenu();
              break;
          }
        }
      });
    </script>
  </body>
</html>
