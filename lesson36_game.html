<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Luy·ªán t·∫≠p H·ªôi tho·∫°i Ti·∫øng ƒê·ª©c - Mua b√°n T·ªß l·∫°nh</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #4a90e2 0%, #9013fe 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 1000px;
        margin: 0 auto;
        background: #f9f9fb;
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        overflow: hidden;
      }

      .header {
        background: linear-gradient(135deg, #ff6b6b, #ffd93d);
        color: #fff;
        padding: 30px;
        text-align: center;
      }

      .header h1 {
        font-size: 2.5em;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .header p {
        color: #fefefe;
        font-size: 1.2em;
      }

      .content {
        padding: 30px;
      }

      .practice-card {
        background: linear-gradient(135deg, #a8edea, #fed6e3);
        color: #333;
        border-radius: 20px;
        padding: 30px;
        margin: 20px 0;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
      }

      .role-section {
        margin: 20px 0;
        padding: 20px;
        border-radius: 15px;
        border-left: 5px solid;
      }

      .noll {
        background: #e6f3ff;
        border-left-color: #1e88e5;
      }

      .jenny {
        background: #fce4ec;
        border-left-color: #d81b60;
      }

      .role-title {
        font-size: 1.3em;
        font-weight: bold;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 10px;
        color: #333;
      }

      .dialog-item {
        background: #fff;
        border-radius: 10px;
        padding: 15px;
        margin: 10px 0;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        position: relative;
      }

      .dialog-number {
        position: absolute;
        top: -10px;
        left: 15px;
        background: #1e88e5;
        color: #fff;
        width: 25px;
        height: 25px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9em;
        font-weight: bold;
      }

      .dialog-number.triangle {
        border-radius: 0;
        clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
        background: #d81b60;
      }

      .dialog-text {
        font-size: 1.2em;
        line-height: 1.4;
        margin-top: 10px;
      }

      .german-text {
        font-weight: bold;
        margin-bottom: 8px;
        color: #222;
      }

      .vietnamese-text {
        font-size: 0.95em;
        color: #555;
        font-style: italic;
      }

      .improved-translation {
        border-left: 3px solid #28a745;
        padding-left: 10px;
        margin-top: 8px;
        font-style: italic;
        color: #28a745;
        font-size: 0.9em;
        background: rgba(255, 255, 255, 0.7);
        border-radius: 0 5px 5px 0;
      }

      .stats-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin: 20px 0;
      }

      .stat-box {
        background: #fff;
        border-radius: 15px;
        padding: 15px;
        text-align: center;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      .stat-number {
        font-size: 1.8em;
        font-weight: 900;
        margin-bottom: 5px;
        color: #333;
      }

      .stat-label {
        font-size: 0.9em;
        color: #666;
      }

      .timer-warning {
        color: #e91e63 !important;
        animation: pulse 1s infinite;
      }

      @keyframes pulse {
        0% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
        100% {
          opacity: 1;
        }
      }

      .sentence-counter {
        font-size: 1.5em;
        margin-bottom: 20px;
        font-weight: 600;
        text-align: center;
        color: #333;
      }

      .progress-bar {
        background: rgba(0, 0, 0, 0.1);
        border-radius: 10px;
        overflow: hidden;
        margin: 20px 0;
        height: 20px;
      }

      .progress-fill {
        background: linear-gradient(135deg, #28a745, #20c997);
        height: 100%;
        transition: width 0.5s ease;
        border-radius: 10px;
      }

      .controls {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin: 20px 0;
        flex-wrap: wrap;
      }

      .btn {
        background: linear-gradient(135deg, #1e88e5, #1976d2);
        color: #fff;
        border: none;
        padding: 12px 25px;
        border-radius: 25px;
        font-size: 1em;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
      }

      .btn-play {
        background: linear-gradient(135deg, #28a745, #20c997);
      }

      .btn-back {
        background: linear-gradient(135deg, #78909c, #546e7a);
      }

      .btn-correct {
        background: linear-gradient(135deg, #28a745, #20c997);
      }

      .btn-incorrect {
        background: linear-gradient(135deg, #e91e63, #d81b60);
      }

      .instructions {
        background: #fff;
        border-radius: 15px;
        padding: 20px;
        margin: 20px 0;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        color: #333;
      }

      .instructions h3 {
        color: #1e88e5;
        margin-bottom: 15px;
      }

      .instructions ul {
        list-style: none;
        padding: 0;
      }

      .instructions li {
        margin: 8px 0;
        padding-left: 25px;
        position: relative;
        color: #444;
      }

      .instructions li::before {
        content: "üé≠";
        position: absolute;
        left: 0;
      }

      .practice-mode-selector {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin: 20px 0;
      }

      .mode-btn {
        background: rgba(255, 255, 255, 0.3);
        border: 2px solid #fff;
        color: #fff;
        padding: 15px 25px;
        border-radius: 15px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: bold;
      }

      .mode-btn.active {
        background: #fff;
        color: #1e88e5;
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      }

      .mode-btn:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      }

      .full-conversation {
        background: #f8f9fa;
        border-radius: 15px;
        padding: 20px;
        margin: 20px 0;
      }

      .conversation-line {
        margin-bottom: 15px;
        padding: 10px;
        border-radius: 8px;
      }

      .noll-line {
        background-color: #e6f3ff;
        border-left: 4px solid #1e88e5;
      }

      .jenny-line {
        background-color: #fce4ec;
        border-left: 4px solid #d81b60;
      }

      .speaker {
        font-weight: bold;
        margin-bottom: 5px;
        display: flex;
        align-items: center;
        gap: 10px;
        color: #333;
      }

      .original-text {
        font-weight: bold;
        color: #222;
      }

      .translated-text {
        color: #555;
        font-style: italic;
        margin-top: 5px;
      }

      .roleplay-practice {
        display: none;
        background: #f8f9fa;
        border-radius: 15px;
        padding: 20px;
        margin: 20px 0;
      }

      .current-dialog {
        background: #fff;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 15px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      .answer-section {
        display: none;
        background: #fff;
        border-radius: 10px;
        padding: 20px;
        margin-top: 15px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        border-left: 4px solid #28a745;
      }

      .completion-screen {
        text-align: center;
        display: none;
      }

      .completion-screen.show {
        display: block;
        animation: fadeIn 0.5s ease;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .completion-emoji {
        font-size: 5em;
        margin: 20px 0;
      }

      .result-success {
        color: #28a745;
      }

      .result-failure {
        color: #e91e63;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 20px;
        margin: 30px 0;
      }

      @media (max-width: 768px) {
        .header h1 {
          font-size: 2em;
        }

        .dialog-text {
          font-size: 1.1em;
        }

        .practice-mode-selector {
          flex-direction: column;
        }

        .stats-row {
          grid-template-columns: 1fr 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üé≠ Luy·ªán t·∫≠p H·ªôi tho·∫°i Ti·∫øng ƒê·ª©c</h1>
        <p>Mua b√°n t·ªß l·∫°nh - Frau Noll v√† Jenny (5 ph√∫t)</p>
      </div>

      <div class="content">
        <div class="practice-card">
          <div class="instructions">
            <h3>üìñ H∆∞·ªõng d·∫´n luy·ªán t·∫≠p</h3>
            <ul>
              <li>
                <strong>Ch·∫ø ƒë·ªô ƒê·ªçc hi·ªÉu:</strong> Xem to√†n b·ªô h·ªôi tho·∫°i v·ªõi b·∫£n
                d·ªãch t·ª± nhi√™n
              </li>
              <li>
                <strong>Ch·∫ø ƒë·ªô ƒê√≥ng vai:</strong> Th·ª±c h√†nh n√≥i m·ªôt vai trong 5
                ph√∫t, t·ª± ƒë√°nh gi√°
              </li>
              <li>
                <strong>Ch·∫ø ƒë·ªô Full:</strong> Xem h·ªôi tho·∫°i ƒë·∫ßy ƒë·ªß v·ªõi b·∫£n d·ªãch
                c·∫£i ti·∫øn
              </li>
              <li>Nh·∫•n üîä ƒë·ªÉ nghe ph√°t √¢m ti·∫øng ƒê·ª©c chu·∫©n</li>
              <li>
                Ph√≠m t·∫Øt (ƒê√≥ng vai): Space (ph√°t √¢m), 1 (ƒë√∫ng), 2 (sai), Enter
                (ti·∫øp), Escape (quay l·∫°i)
              </li>
            </ul>
          </div>

          <div class="practice-mode-selector">
            <div
              class="mode-btn active"
              id="reading-btn"
              onclick="setMode('reading')"
            >
              üìñ ƒê·ªçc hi·ªÉu
            </div>
            <div
              class="mode-btn"
              id="roleplay-btn"
              onclick="setMode('roleplay')"
            >
              üé≠ ƒê√≥ng vai
            </div>
            <div class="mode-btn" id="full-btn" onclick="setMode('full')">
              üìÑ Full Conversation
            </div>
          </div>

          <!-- Ch·∫ø ƒë·ªô ƒê·ªçc hi·ªÉu -->
          <div id="reading-content">
            <div class="role-section noll">
              <div class="role-title">üîµ FRAU NOLL (Ng∆∞·ªùi b√°n - 8 l∆∞·ª£t)</div>
              <div class="dialog-item">
                <div class="dialog-number">1</div>
                <div class="dialog-text">
                  <div class="german-text">Noll.</div>
                  <div class="vietnamese-text">Noll xin nghe.</div>
                </div>
                <button class="btn btn-play" onclick="speakGerman('Noll.')">
                  üîä
                </button>
              </div>
              <div class="dialog-item">
                <div class="dialog-number">2</div>
                <div class="dialog-text">
                  <div class="german-text">Ja, der ist noch da.</div>
                  <div class="vietnamese-text">
                    V√¢ng, t·ªß l·∫°nh v·∫´n c√≤n b√°n ·∫°.
                  </div>
                </div>
                <button
                  class="btn btn-play"
                  onclick="speakGerman('Ja, der ist noch da.')"
                >
                  üîä
                </button>
              </div>
              <div class="dialog-item">
                <div class="dialog-number">3</div>
                <div class="dialog-text">
                  <div class="german-text">Ach, vielleicht zwei Jahre.</div>
                  <div class="vietnamese-text">
                    √Ä, t·ªß m·ªõi d√πng kho·∫£ng 2 nƒÉm th√¥i ·∫°.
                  </div>
                </div>
                <button
                  class="btn btn-play"
                  onclick="speakGerman('Ach, vielleicht zwei Jahre.')"
                >
                  üîä
                </button>
              </div>
              <div class="dialog-item">
                <div class="dialog-number">4</div>
                <div class="dialog-text">
                  <div class="german-text">Aber nat√ºrlich!</div>
                  <div class="vietnamese-text">
                    Dƒ© nhi√™n l√† v·∫´n ho·∫°t ƒë·ªông t·ªët ·∫°!
                  </div>
                </div>
                <button
                  class="btn btn-play"
                  onclick="speakGerman('Aber nat√ºrlich!')"
                >
                  üîä
                </button>
              </div>
              <div class="dialog-item">
                <div class="dialog-number">5</div>
                <div class="dialog-text">
                  <div class="german-text">
                    Klar, kommen Sie am besten heute noch vorbei. Passt Ihnen
                    18.00 Uhr?
                  </div>
                  <div class="vietnamese-text">
                    V√¢ng, ch·ªã c·ª© qua xem h√¥m nay ƒëi ·∫°. Kho·∫£ng 6 gi·ªù t·ªëi c√≥ ƒë∆∞·ª£c
                    kh√¥ng ·∫°?
                  </div>
                </div>
                <button
                  class="btn btn-play"
                  onclick="speakGerman('Klar, kommen Sie am besten heute noch vorbei. Passt Ihnen 18.00 Uhr?')"
                >
                  üîä
                </button>
              </div>
              <div class="dialog-item">
                <div class="dialog-number">6</div>
                <div class="dialog-text">
                  <div class="german-text">
                    Von mir aus. Ich bin ab 16 Uhr zu Hause.
                  </div>
                  <div class="vietnamese-text">
                    C≈©ng ƒë∆∞·ª£c ·∫°. T·ª´ 4 gi·ªù t√¥i c√≥ ·ªü nh√†.
                  </div>
                </div>
                <button
                  class="btn btn-play"
                  onclick="speakGerman('Von mir aus. Ich bin ab 16 Uhr zu Hause.')"
                >
                  üîä
                </button>
              </div>
              <div class="dialog-item">
                <div class="dialog-number">7</div>
                <div class="dialog-text">
                  <div class="german-text">Romanstra√üe 12.</div>
                  <div class="vietnamese-text">S·ªë 12 ƒë∆∞·ªùng Romanstra√üe ·∫°.</div>
                </div>
                <button
                  class="btn btn-play"
                  onclick="speakGerman('Romanstra√üe 12.')"
                >
                  üîä
                </button>
              </div>
              <div class="dialog-item">
                <div class="dialog-number">8</div>
                <div class="dialog-text">
                  <div class="german-text">
                    K√∂nnen Sie den K√ºhlschrank denn gleich mitnehmen? Sie
                    bekommen ihn dann noch ein bisschen billiger. Sagen wir 130
                    Euro?
                  </div>
                  <div class="vietnamese-text">
                    Ch·ªã c√≥ th·ªÉ l·∫•y t·ªß ngay kh√¥ng? N·∫øu l·∫•y ngay em gi·∫£m c√≤n 130
                    euro nh√©?
                  </div>
                </div>
                <button
                  class="btn btn-play"
                  onclick="speakGerman('K√∂nnen Sie den K√ºhlschrank denn gleich mitnehmen? Sie bekommen ihn dann noch ein bisschen billiger. Sagen wir 130 Euro?')"
                >
                  üîä
                </button>
              </div>
              <div class="dialog-item">
                <div class="dialog-number">9</div>
                <div class="dialog-text">
                  <div class="german-text">Auf Wiederh√∂ren.</div>
                  <div class="vietnamese-text">T·∫°m bi·ªát ch·ªã nh√©!</div>
                </div>
                <button
                  class="btn btn-play"
                  onclick="speakGerman('Auf Wiederh√∂ren.')"
                >
                  üîä
                </button>
              </div>
            </div>

            <div class="role-section jenny">
              <div class="role-title">üî¥ JENNY (Ng∆∞·ªùi mua - 8 l∆∞·ª£t)</div>
              <div class="dialog-item">
                <div class="dialog-number triangle">1</div>
                <div class="dialog-text">
                  <div class="german-text">
                    Guten Tag, mein Name ist St√∂lken.
                  </div>
                  <div class="vietnamese-text">Xin ch√†o, t√¥i l√† St√∂lken.</div>
                </div>
                <button
                  class="btn btn-play"
                  onclick="speakGerman('Guten Tag, mein Name ist St√∂lken.')"
                >
                  üîä
                </button>
              </div>
              <div class="dialog-item">
                <div class="dialog-number triangle">2</div>
                <div class="dialog-text">
                  <div class="german-text">
                    Ich habe Ihre Anzeige gelesen. Gibt es den K√ºhlschrank noch?
                  </div>
                  <div class="vietnamese-text">
                    T√¥i th·∫•y qu·∫£ng c√°o t·ªß l·∫°nh c·ªßa ch·ªã. T·ªß n√†y c√≤n kh√¥ng ·∫°?
                  </div>
                </div>
                <button
                  class="btn btn-play"
                  onclick="speakGerman('Ich habe Ihre Anzeige gelesen. Gibt es den K√ºhlschrank noch?')"
                >
                  üîä
                </button>
              </div>
              <div class="dialog-item">
                <div class="dialog-number triangle">3</div>
                <div class="dialog-text">
                  <div class="german-text">
                    In der Anzeige steht: fast neu. Wie alt ist der K√ºhlschrank
                    denn?
                  </div>
                  <div class="vietnamese-text">
                    Qu·∫£ng c√°o ghi l√† 'g·∫ßn nh∆∞ m·ªõi'. T·ªß d√πng ƒë∆∞·ª£c m·∫•y nƒÉm r·ªìi
                    ch·ªã?
                  </div>
                </div>
                <button
                  class="btn btn-play"
                  onclick="speakGerman('In der Anzeige steht: fast neu. Wie alt ist der K√ºhlschrank denn?')"
                >
                  üîä
                </button>
              </div>
              <div class="dialog-item">
                <div class="dialog-number triangle">4</div>
                <div class="dialog-text">
                  <div class="german-text">Und er ist v√∂llig in Ordnung?</div>
                  <div class="vietnamese-text">T·ªß v·∫´n ch·∫°y t·ªët ch·ª© ch·ªã?</div>
                </div>
                <button
                  class="btn btn-play"
                  onclick="speakGerman('Und er ist v√∂llig in Ordnung?')"
                >
                  üîä
                </button>
              </div>
              <div class="dialog-item">
                <div class="dialog-number triangle">5</div>
                <div class="dialog-text">
                  <div class="german-text">
                    Hm. 150 Euro sind ein bisschen viel f√ºr mich. Kann ich ihn
                    mir denn mal ansehen?
                  </div>
                  <div class="vietnamese-text">
                    150 euro h∆°i cao v·ªõi t√¥i. T√¥i c√≥ th·ªÉ qua xem tr∆∞·ªõc ƒë∆∞·ª£c
                    kh√¥ng?
                  </div>
                </div>
                <button
                  class="btn btn-play"
                  onclick="speakGerman('Hm. 150 Euro sind ein bisschen viel f√ºr mich. Kann ich ihn mir denn mal ansehen?')"
                >
                  üîä
                </button>
              </div>
              <div class="dialog-item">
                <div class="dialog-number triangle">6</div>
                <div class="dialog-text">
                  <div class="german-text">18.00 Uhr? Geht es auch fr√ºher?</div>
                  <div class="vietnamese-text">
                    6 gi·ªù t·ªëi ·∫°? C√≥ th·ªÉ s·ªõm h∆°n ƒë∆∞·ª£c kh√¥ng?
                  </div>
                </div>
                <button
                  class="btn btn-play"
                  onclick="speakGerman('18.00 Uhr? Geht es auch fr√ºher?')"
                >
                  üîä
                </button>
              </div>
              <div class="dialog-item">
                <div class="dialog-number triangle">7</div>
                <div class="dialog-text">
                  <div class="german-text">Wie ist denn Ihre Adresse?</div>
                  <div class="vietnamese-text">
                    Ch·ªã cho h·ªèi ƒë·ªãa ch·ªâ nh√† ch·ªã l√† g√¨ ·∫°?
                  </div>
                </div>
                <button
                  class="btn btn-play"
                  onclick="speakGerman('Wie ist denn Ihre Adresse?')"
                >
                  üîä
                </button>
              </div>
              <div class="dialog-item">
                <div class="dialog-number triangle">8</div>
                <div class="dialog-text">
                  <div class="german-text">
                    Romanstra√üe? Das ist ja ganz in der N√§he.
                  </div>
                  <div class="vietnamese-text">
                    ƒê∆∞·ªùng Romanstra√üe √†? G·∫ßn ƒë√¢y th√¥i nh·ªâ.
                  </div>
                </div>
                <button
                  class="btn btn-play"
                  onclick="speakGerman('Romanstra√üe? Das ist ja ganz in der N√§he.')"
                >
                  üîä
                </button>
              </div>
              <div class="dialog-item">
                <div class="dialog-number triangle">9</div>
                <div class="dialog-text">
                  <div class="german-text">
                    Ich sehe ihn mir erst mal an. Bis sp√§ter. Tsch√ºs.
                  </div>
                  <div class="vietnamese-text">
                    T√¥i s·∫Ω qua xem th·ª≠ nh√©. H·∫πn g·∫∑p l·∫°i ch·ªã. T·∫°m bi·ªát!
                  </div>
                </div>
                <button
                  class="btn btn-play"
                  onclick="speakGerman('Ich sehe ihn mir erst mal an. Bis sp√§ter. Tsch√ºs.')"
                >
                  üîä
                </button>
              </div>
            </div>
          </div>

          <!-- Ch·∫ø ƒë·ªô ƒê√≥ng vai -->
          <div id="roleplay-content" class="roleplay-practice">
            <div class="instructions">
              <h3>üé≠ Ch·∫ø ƒë·ªô ƒê√≥ng vai (5 ph√∫t)</h3>
              <p>
                Ch·ªçn vai, ƒë·ªçc to c√¢u ti·∫øng ƒê·ª©c, t·ª± ƒë√°nh gi√° v√† ki·ªÉm tra ƒë√°p √°n
              </p>
            </div>

            <div class="stats-row">
              <div class="stat-box">
                <div class="stat-number" id="timer">05:00</div>
                <div class="stat-label">‚è∞ Th·ªùi gian</div>
              </div>
              <div class="stat-box">
                <div class="stat-number" id="correct-count">0</div>
                <div class="stat-label">‚úÖ C√¢u ƒë√∫ng</div>
              </div>
              <div class="stat-box">
                <div class="stat-number" id="total-answered">0</div>
                <div class="stat-label">üìù ƒê√£ l√†m</div>
              </div>
            </div>

            <div class="sentence-counter" id="counter">C√¢u 1 / 0</div>

            <div class="progress-bar">
              <div class="progress-fill" id="progress" style="width: 0%"></div>
            </div>

            <div class="controls">
              <button
                class="btn"
                id="practice-noll-btn"
                onclick="startRoleplay('noll')"
              >
                üîµ ƒê√≥ng vai Frau Noll
              </button>
              <button
                class="btn"
                id="practice-jenny-btn"
                onclick="startRoleplay('jenny')"
              >
                üî¥ ƒê√≥ng vai Jenny
              </button>
            </div>

            <div id="roleplay-area" style="display: none">
              <div class="current-dialog">
                <div id="current-prompt"></div>
              </div>

              <div class="controls">
                <button
                  class="btn btn-play"
                  id="speak-btn"
                  onclick="speakCurrentGerman()"
                >
                  üîä Ph√°t √¢m
                </button>
                <button
                  class="btn btn-correct"
                  id="correct-btn"
                  onclick="markAnswer(true)"
                >
                  ‚úÖ Hi·ªÉu & ƒê√∫ng
                </button>
                <button
                  class="btn btn-incorrect"
                  id="incorrect-btn"
                  onclick="markAnswer(false)"
                >
                  ‚ùå Ch∆∞a hi·ªÉu
                </button>
                <button
                  class="btn"
                  id="next-btn"
                  onclick="nextDialog()"
                  style="display: none"
                >
                  ‚û°Ô∏è C√¢u ti·∫øp theo
                </button>
              </div>

              <div class="answer-section" id="answer-section">
                <div id="correct-answer"></div>
                <button
                  class="btn btn-play"
                  onclick="speakCurrentGerman()"
                  style="margin-top: 10px"
                >
                  üîä Nghe ƒë√°p √°n
                </button>
              </div>
            </div>
          </div>

          <!-- Ch·∫ø ƒë·ªô Full Conversation -->
          <div
            id="full-content"
            class="full-conversation"
            style="display: none"
          >
            <div class="conversation-line noll-line">
              <div class="speaker">
                üîµ Frau Noll: <span class="original-text">Noll.</span>
              </div>
              <div class="translated-text">Noll xin nghe.</div>
              <button
                class="btn btn-play"
                onclick="speakGerman('Noll.')"
                style="margin-top: 5px; padding: 5px 10px; font-size: 0.9em"
              >
                üîä
              </button>
            </div>
            <div class="conversation-line jenny-line">
              <div class="speaker">
                üî¥ Jenny:
                <span class="original-text"
                  >Guten Tag, mein Name ist St√∂lken.</span
                >
              </div>
              <div class="translated-text">Xin ch√†o, t√¥i l√† St√∂lken.</div>
              <button
                class="btn btn-play"
                onclick="speakGerman('Guten Tag, mein Name ist St√∂lken.')"
                style="margin-top: 5px; padding: 5px 10px; font-size: 0.9em"
              >
                üîä
              </button>
            </div>
            <div class="conversation-line jenny-line">
              <div class="speaker">
                üî¥ Jenny:
                <span class="original-text"
                  >Ich habe Ihre Anzeige gelesen. Gibt es den K√ºhlschrank
                  noch?</span
                >
              </div>
              <div class="translated-text">
                T√¥i th·∫•y qu·∫£ng c√°o t·ªß l·∫°nh c·ªßa ch·ªã. T·ªß n√†y c√≤n kh√¥ng ·∫°?
              </div>
              <button
                class="btn btn-play"
                onclick="speakGerman('Ich habe Ihre Anzeige gelesen. Gibt es den K√ºhlschrank noch?')"
                style="margin-top: 5px; padding: 5px 10px; font-size: 0.9em"
              >
                üîä
              </button>
            </div>
            <div class="conversation-line noll-line">
              <div class="speaker">
                üîµ Frau Noll:
                <span class="original-text">Ja, der ist noch da.</span>
              </div>
              <div class="translated-text">V√¢ng, t·ªß l·∫°nh v·∫´n c√≤n b√°n ·∫°.</div>
              <button
                class="btn btn-play"
                onclick="speakGerman('Ja, der ist noch da.')"
                style="margin-top: 5px; padding: 5px 10px; font-size: 0.9em"
              >
                üîä
              </button>
            </div>
            <div class="conversation-line jenny-line">
              <div class="speaker">
                üî¥ Jenny:
                <span class="original-text"
                  >In der Anzeige steht: fast neu.</span
                >
              </div>
              <div class="translated-text">Qu·∫£ng c√°o ghi l√† 'g·∫ßn nh∆∞ m·ªõi'.</div>
              <button
                class="btn btn-play"
                onclick="speakGerman('In der Anzeige steht: fast neu.')"
                style="margin-top: 5px; padding: 5px 10px; font-size: 0.9em"
              >
                üîä
              </button>
            </div>
            <div class="conversation-line jenny-line">
              <div class="speaker">
                üî¥ Jenny:
                <span class="original-text"
                  >Wie alt ist der K√ºhlschrank denn?</span
                >
              </div>
              <div class="translated-text">T·ªß d√πng ƒë∆∞·ª£c m·∫•y nƒÉm r·ªìi ch·ªã?</div>
              <button
                class="btn btn-play"
                onclick="speakGerman('Wie alt ist der K√ºhlschrank denn?')"
                style="margin-top: 5px; padding: 5px 10px; font-size: 0.9em"
              >
                üîä
              </button>
            </div>
            <div class="conversation-line noll-line">
              <div class="speaker">
                üîµ Frau Noll:
                <span class="original-text">Ach, vielleicht zwei Jahre.</span>
              </div>
              <div class="translated-text">
                √Ä, t·ªß m·ªõi d√πng kho·∫£ng 2 nƒÉm th√¥i ·∫°.
              </div>
              <button
                class="btn btn-play"
                onclick="speakGerman('Ach, vielleicht zwei Jahre.')"
                style="margin-top: 5px; padding: 5px 10px; font-size: 0.9em"
              >
                üîä
              </button>
            </div>
            <div class="conversation-line jenny-line">
              <div class="speaker">
                üî¥ Jenny:
                <span class="original-text">Und er ist v√∂llig in Ordnung?</span>
              </div>
              <div class="translated-text">T·ªß v·∫´n ch·∫°y t·ªët ch·ª© ch·ªã?</div>
              <button
                class="btn btn-play"
                onclick="speakGerman('Und er ist v√∂llig in Ordnung?')"
                style="margin-top: 5px; padding: 5px 10px; font-size: 0.9em"
              >
                üîä
              </button>
            </div>
            <div class="conversation-line noll-line">
              <div class="speaker">
                üîµ Frau Noll: <span class="original-text">Aber nat√ºrlich!</span>
              </div>
              <div class="translated-text">
                Dƒ© nhi√™n l√† v·∫´n ho·∫°t ƒë·ªông t·ªët ·∫°!
              </div>
              <button
                class="btn btn-play"
                onclick="speakGerman('Aber nat√ºrlich!')"
                style="margin-top: 5px; padding: 5px 10px; font-size: 0.9em"
              >
                üîä
              </button>
            </div>
            <div class="conversation-line jenny-line">
              <div class="speaker">
                üî¥ Jenny:
                <span class="original-text"
                  >Hm. 150 Euro sind ein bisschen viel f√ºr mich. Kann ich ihn
                  mir denn mal ansehen?</span
                >
              </div>
              <div class="translated-text">
                150 euro h∆°i cao v·ªõi t√¥i. T√¥i c√≥ th·ªÉ qua xem tr∆∞·ªõc ƒë∆∞·ª£c kh√¥ng?
              </div>
              <button
                class="btn btn-play"
                onclick="speakGerman('Hm. 150 Euro sind ein bisschen viel f√ºr mich. Kann ich ihn mir denn mal ansehen?')"
                style="margin-top: 5px; padding: 5px 10px; font-size: 0.9em"
              >
                üîä
              </button>
            </div>
            <div class="conversation-line noll-line">
              <div class="speaker">
                üîµ Frau Noll:
                <span class="original-text"
                  >Klar, kommen Sie am besten heute noch vorbei. Passt Ihnen
                  18.00 Uhr?</span
                >
              </div>
              <div class="translated-text">
                V√¢ng, ch·ªã c·ª© qua xem h√¥m nay ƒëi ·∫°. Kho·∫£ng 6 gi·ªù t·ªëi c√≥ ƒë∆∞·ª£c
                kh√¥ng ·∫°?
              </div>
              <button
                class="btn btn-play"
                onclick="speakGerman('Klar, kommen Sie am besten heute noch vorbei. Passt Ihnen 18.00 Uhr?')"
                style="margin-top: 5px; padding: 5px 10px; font-size: 0.9em"
              >
                üîä
              </button>
            </div>
            <div class="conversation-line jenny-line">
              <div class="speaker">
                üî¥ Jenny:
                <span class="original-text"
                  >18.00 Uhr? Geht es auch fr√ºher?</span
                >
              </div>
              <div class="translated-text">
                6 gi·ªù t·ªëi ·∫°? C√≥ th·ªÉ s·ªõm h∆°n ƒë∆∞·ª£c kh√¥ng?
              </div>
              <button
                class="btn btn-play"
                onclick="speakGerman('18.00 Uhr? Geht es auch fr√ºher?')"
                style="margin-top: 5px; padding: 5px 10px; font-size: 0.9em"
              >
                üîä
              </button>
            </div>
            <div class="conversation-line noll-line">
              <div class="speaker">
                üîµ Frau Noll:
                <span class="original-text"
                  >Von mir aus. Ich bin ab 16 Uhr zu Hause.</span
                >
              </div>
              <div class="translated-text">
                C≈©ng ƒë∆∞·ª£c ·∫°. T·ª´ 4 gi·ªù t√¥i c√≥ ·ªü nh√†.
              </div>
              <button
                class="btn btn-play"
                onclick="speakGerman('Von mir aus. Ich bin ab 16 Uhr zu Hause.')"
                style="margin-top: 5px; padding: 5px 10px; font-size: 0.9em"
              >
                üîä
              </button>
            </div>
            <div class="conversation-line jenny-line">
              <div class="speaker">
                üî¥ Jenny:
                <span class="original-text">Wie ist denn Ihre Adresse?</span>
              </div>
              <div class="translated-text">
                Ch·ªã cho h·ªèi ƒë·ªãa ch·ªâ nh√† ch·ªã l√† g√¨ ·∫°?
              </div>
              <button
                class="btn btn-play"
                onclick="speakGerman('Wie ist denn Ihre Adresse?')"
                style="margin-top: 5px; padding: 5px 10px; font-size: 0.9em"
              >
                üîä
              </button>
            </div>
            <div class="conversation-line noll-line">
              <div class="speaker">
                üîµ Frau Noll: <span class="original-text">Romanstra√üe 12.</span>
              </div>
              <div class="translated-text">S·ªë 12 ƒë∆∞·ªùng Romanstra√üe ·∫°.</div>
              <button
                class="btn btn-play"
                onclick="speakGerman('Romanstra√üe 12.')"
                style="margin-top: 5px; padding: 5px 10px; font-size: 0.9em"
              >
                üîä
              </button>
            </div>
            <div class="conversation-line jenny-line">
              <div class="speaker">
                üî¥ Jenny:
                <span class="original-text"
                  >Romanstra√üe? Das ist ja ganz in der N√§he.</span
                >
              </div>
              <div class="translated-text">
                ƒê∆∞·ªùng Romanstra√üe √†? G·∫ßn ƒë√¢y th√¥i nh·ªâ.
              </div>
              <button
                class="btn btn-play"
                onclick="speakGerman('Romanstra√üe? Das ist ja ganz in der N√§he.')"
                style="margin-top: 5px; padding: 5px 10px; font-size: 0.9em"
              >
                üîä
              </button>
            </div>
            <div class="conversation-line noll-line">
              <div class="speaker">
                üîµ Frau Noll:
                <span class="original-text"
                  >K√∂nnen Sie den K√ºhlschrank denn gleich mitnehmen? Sie
                  bekommen ihn dann noch ein bisschen billiger. Sagen wir 130
                  Euro?</span
                >
              </div>
              <div class="translated-text">
                Ch·ªã c√≥ th·ªÉ l·∫•y t·ªß ngay kh√¥ng? N·∫øu l·∫•y ngay em gi·∫£m c√≤n 130 euro
                nh√©?
              </div>
              <button
                class="btn btn-play"
                onclick="speakGerman('K√∂nnen Sie den K√ºhlschrank denn gleich mitnehmen? Sie bekommen ihn dann noch ein bisschen billiger. Sagen wir 130 Euro?')"
                style="margin-top: 5px; padding: 5px 10px; font-size: 0.9em"
              >
                üîä
              </button>
            </div>
            <div class="conversation-line jenny-line">
              <div class="speaker">
                üî¥ Jenny:
                <span class="original-text"
                  >Ich sehe ihn mir erst mal an. Bis sp√§ter. Tsch√ºs.</span
                >
              </div>
              <div class="translated-text">
                T√¥i s·∫Ω qua xem th·ª≠ nh√©. H·∫πn g·∫∑p l·∫°i ch·ªã. T·∫°m bi·ªát!
              </div>
              <button
                class="btn btn-play"
                onclick="speakGerman('Ich sehe ihn mir erst mal an. Bis sp√§ter. Tsch√ºs.')"
                style="margin-top: 5px; padding: 5px 10px; font-size: 0.9em"
              >
                üîä
              </button>
            </div>
            <div class="conversation-line noll-line">
              <div class="speaker">
                üîµ Frau Noll:
                <span class="original-text">Auf Wiederh√∂ren.</span>
              </div>
              <div class="translated-text">T·∫°m bi·ªát ch·ªã nh√©!</div>
              <button
                class="btn btn-play"
                onclick="speakGerman('Auf Wiederh√∂ren.')"
                style="margin-top: 5px; padding: 5px 10px; font-size: 0.9em"
              >
                üîä
              </button>
            </div>
          </div>

          <!-- M√†n h√¨nh k·∫øt qu·∫£ -->
          <div id="completion-screen" class="completion-screen">
            <div class="completion-emoji" id="result-emoji">üéâ</div>
            <h2 id="result-title">Ho√†n th√†nh!</h2>
            <p
              style="font-size: 1.3em; margin: 20px 0; color: #333"
              id="result-message"
            >
              K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y
            </p>
            <div class="stats-grid">
              <div class="stat-box">
                <div class="stat-number" id="final-correct">0</div>
                <div class="stat-label">T·ªïng c√¢u ƒë√∫ng</div>
              </div>
              <div class="stat-box">
                <div class="stat-number" id="final-answered">0</div>
                <div class="stat-label">T·ªïng ƒë√£ l√†m</div>
              </div>
              <div class="stat-box">
                <div class="stat-number" id="final-accuracy">0%</div>
                <div class="stat-label">ƒê·ªô ch√≠nh x√°c</div>
              </div>
              <div class="stat-box">
                <div class="stat-number" id="final-time">00:00</div>
                <div class="stat-label">Th·ªùi gian</div>
              </div>
            </div>
            <div class="controls">
              <button class="btn" onclick="resetPractice()">üîÑ L√†m l·∫°i</button>
              <button class="btn btn-back" onclick="setMode('roleplay')">
                ‚¨ÖÔ∏è Quay l·∫°i
              </button>
            </div>
          </div>

          <div class="controls">
            <button class="btn btn-play" onclick="speakAllGerman()">
              üîä Nghe to√†n b·ªô h·ªôi tho·∫°i
            </button>
            <button class="btn btn-back" onclick="setMode('reading')">
              ‚¨ÖÔ∏è Quay l·∫°i ƒê·ªçc hi·ªÉu
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // D·ªØ li·ªáu h·ªôi tho·∫°i v·ªõi b·∫£n d·ªãch t·ª± nhi√™n
      const dialogueData = {
        noll: [
          { german: "Noll.", vietnamese: "Noll xin nghe." },
          {
            german: "Ja, der ist noch da.",
            vietnamese: "V√¢ng, t·ªß l·∫°nh v·∫´n c√≤n b√°n ·∫°.",
          },
          {
            german: "Ach, vielleicht zwei Jahre.",
            vietnamese: "√Ä, t·ªß m·ªõi d√πng kho·∫£ng 2 nƒÉm th√¥i ·∫°.",
          },
          {
            german: "Aber nat√ºrlich!",
            vietnamese: "Dƒ© nhi√™n l√† v·∫´n ho·∫°t ƒë·ªông t·ªët ·∫°!",
          },
          {
            german:
              "Klar, kommen Sie am besten heute noch vorbei. Passt Ihnen 18.00 Uhr?",
            vietnamese:
              "V√¢ng, ch·ªã c·ª© qua xem h√¥m nay ƒëi ·∫°. Kho·∫£ng 6 gi·ªù t·ªëi c√≥ ƒë∆∞·ª£c kh√¥ng ·∫°?",
          },
          {
            german: "Von mir aus. Ich bin ab 16 Uhr zu Hause.",
            vietnamese: "C≈©ng ƒë∆∞·ª£c ·∫°. T·ª´ 4 gi·ªù t√¥i c√≥ ·ªü nh√†.",
          },
          {
            german: "Romanstra√üe 12.",
            vietnamese: "S·ªë 12 ƒë∆∞·ªùng Romanstra√üe ·∫°.",
          },
          {
            german:
              "K√∂nnen Sie den K√ºhlschrank denn gleich mitnehmen? Sie bekommen ihn dann noch ein bisschen billiger. Sagen wir 130 Euro?",
            vietnamese:
              "Ch·ªã c√≥ th·ªÉ l·∫•y t·ªß ngay kh√¥ng? N·∫øu l·∫•y ngay em gi·∫£m c√≤n 130 euro nh√©?",
          },
          { german: "Auf Wiederh√∂ren.", vietnamese: "T·∫°m bi·ªát ch·ªã nh√©!" },
        ],
        jenny: [
          {
            german: "Guten Tag, mein Name ist St√∂lken.",
            vietnamese: "Xin ch√†o, t√¥i l√† St√∂lken.",
          },
          {
            german:
              "Ich habe Ihre Anzeige gelesen. Gibt es den K√ºhlschrank noch?",
            vietnamese:
              "T√¥i th·∫•y qu·∫£ng c√°o t·ªß l·∫°nh c·ªßa ch·ªã. T·ªß n√†y c√≤n kh√¥ng ·∫°?",
          },
          {
            german:
              "In der Anzeige steht: fast neu. Wie alt ist der K√ºhlschrank denn?",
            vietnamese:
              "Qu·∫£ng c√°o ghi l√† 'g·∫ßn nh∆∞ m·ªõi'. T·ªß d√πng ƒë∆∞·ª£c m·∫•y nƒÉm r·ªìi ch·ªã?",
          },
          {
            german: "Und er ist v√∂llig in Ordnung?",
            vietnamese: "T·ªß v·∫´n ch·∫°y t·ªët ch·ª© ch·ªã?",
          },
          {
            german:
              "Hm. 150 Euro sind ein bisschen viel f√ºr mich. Kann ich ihn mir denn mal ansehen?",
            vietnamese:
              "150 euro h∆°i cao v·ªõi t√¥i. T√¥i c√≥ th·ªÉ qua xem tr∆∞·ªõc ƒë∆∞·ª£c kh√¥ng?",
          },
          {
            german: "18.00 Uhr? Geht es auch fr√ºher?",
            vietnamese: "6 gi·ªù t·ªëi ·∫°? C√≥ th·ªÉ s·ªõm h∆°n ƒë∆∞·ª£c kh√¥ng?",
          },
          {
            german: "Wie ist denn Ihre Adresse?",
            vietnamese: "Ch·ªã cho h·ªèi ƒë·ªãa ch·ªâ nh√† ch·ªã l√† g√¨ ·∫°?",
          },
          {
            german: "Romanstra√üe? Das ist ja ganz in der N√§he.",
            vietnamese: "ƒê∆∞·ªùng Romanstra√üe √†? G·∫ßn ƒë√¢y th√¥i nh·ªâ.",
          },
          {
            german: "Ich sehe ihn mir erst mal an. Bis sp√§ter. Tsch√ºs.",
            vietnamese: "T√¥i s·∫Ω qua xem th·ª≠ nh√©. H·∫πn g·∫∑p l·∫°i ch·ªã. T·∫°m bi·ªát!",
          },
        ],
        full: [
          { speaker: "noll", german: "Noll.", vietnamese: "Noll xin nghe." },
          {
            speaker: "jenny",
            german: "Guten Tag, mein Name ist St√∂lken.",
            vietnamese: "Xin ch√†o, t√¥i l√† St√∂lken.",
          },
          {
            speaker: "jenny",
            german:
              "Ich habe Ihre Anzeige gelesen. Gibt es den K√ºhlschrank noch?",
            vietnamese:
              "T√¥i th·∫•y qu·∫£ng c√°o t·ªß l·∫°nh c·ªßa ch·ªã. T·ªß n√†y c√≤n kh√¥ng ·∫°?",
          },
          {
            speaker: "noll",
            german: "Ja, der ist noch da.",
            vietnamese: "V√¢ng, t·ªß l·∫°nh v·∫´n c√≤n b√°n ·∫°.",
          },
          {
            speaker: "jenny",
            german:
              "In der Anzeige steht: fast neu. Wie alt ist der K√ºhlschrank denn?",
            vietnamese:
              "Qu·∫£ng c√°o ghi l√† 'g·∫ßn nh∆∞ m·ªõi'. T·ªß d√πng ƒë∆∞·ª£c m·∫•y nƒÉm r·ªìi ch·ªã?",
          },
          {
            speaker: "noll",
            german: "Ach, vielleicht zwei Jahre.",
            vietnamese: "√Ä, t·ªß m·ªõi d√πng kho·∫£ng 2 nƒÉm th√¥i ·∫°.",
          },
          {
            speaker: "jenny",
            german: "Und er ist v√∂llig in Ordnung?",
            vietnamese: "T·ªß v·∫´n ch·∫°y t·ªët ch·ª© ch·ªã?",
          },
          {
            speaker: "noll",
            german: "Aber nat√ºrlich!",
            vietnamese: "Dƒ© nhi√™n l√† v·∫´n ho·∫°t ƒë·ªông t·ªët ·∫°!",
          },
          {
            speaker: "jenny",
            german:
              "Hm. 150 Euro sind ein bisschen viel f√ºr mich. Kann ich ihn mir denn mal ansehen?",
            vietnamese:
              "150 euro h∆°i cao v·ªõi t√¥i. T√¥i c√≥ th·ªÉ qua xem tr∆∞·ªõc ƒë∆∞·ª£c kh√¥ng?",
          },
          {
            speaker: "noll",
            german:
              "Klar, kommen Sie am besten heute noch vorbei. Passt Ihnen 18.00 Uhr?",
            vietnamese:
              "V√¢ng, ch·ªã c·ª© qua xem h√¥m nay ƒëi ·∫°. Kho·∫£ng 6 gi·ªù t·ªëi c√≥ ƒë∆∞·ª£c kh√¥ng ·∫°?",
          },
          {
            speaker: "jenny",
            german: "18.00 Uhr? Geht es auch fr√ºher?",
            vietnamese: "6 gi·ªù t·ªëi ·∫°? C√≥ th·ªÉ s·ªõm h∆°n ƒë∆∞·ª£c kh√¥ng?",
          },
          {
            speaker: "noll",
            german: "Von mir aus. Ich bin ab 16 Uhr zu Hause.",
            vietnamese: "C≈©ng ƒë∆∞·ª£c ·∫°. T·ª´ 4 gi·ªù t√¥i c√≥ ·ªü nh√†.",
          },
          {
            speaker: "jenny",
            german: "Wie ist denn Ihre Adresse?",
            vietnamese: "Ch·ªã cho h·ªèi ƒë·ªãa ch·ªâ nh√† ch·ªã l√† g√¨ ·∫°?",
          },
          {
            speaker: "noll",
            german: "Romanstra√üe 12.",
            vietnamese: "S·ªë 12 ƒë∆∞·ªùng Romanstra√üe ·∫°.",
          },
          {
            speaker: "jenny",
            german: "Romanstra√üe? Das ist ja ganz in der N√§he.",
            vietnamese: "ƒê∆∞·ªùng Romanstra√üe √†? G·∫ßn ƒë√¢y th√¥i nh·ªâ.",
          },
          {
            speaker: "noll",
            german:
              "K√∂nnen Sie den K√ºhlschrank denn gleich mitnehmen? Sie bekommen ihn dann noch ein bisschen billiger. Sagen wir 130 Euro?",
            vietnamese:
              "Ch·ªã c√≥ th·ªÉ l·∫•y t·ªß ngay kh√¥ng? N·∫øu l·∫•y ngay em gi·∫£m c√≤n 130 euro nh√©?",
          },
          {
            speaker: "jenny",
            german: "Ich sehe ihn mir erst mal an. Bis sp√§ter. Tsch√ºs.",
            vietnamese: "T√¥i s·∫Ω qua xem th·ª≠ nh√©. H·∫πn g·∫∑p l·∫°i ch·ªã. T·∫°m bi·ªát!",
          },
          {
            speaker: "noll",
            german: "Auf Wiederh√∂ren.",
            vietnamese: "T·∫°m bi·ªát ch·ªã nh√©!",
          },
        ],
      };

      // Tr·∫°ng th√°i ·ª©ng d·ª•ng
      let currentMode = "reading";
      let currentRole = "";
      let currentDialogIndex = 0;
      let isStarted = false;
      let timerInterval = null;
      let timeRemaining = 300; // 5 minutes
      let correctCount = 0;
      let totalAnswered = 0;
      let startTime = null;

      // Chuy·ªÉn ch·∫ø ƒë·ªô
      function setMode(mode) {
        currentMode = mode;
        stopTimer();
        resetPractice();

        document.getElementById("reading-content").style.display = "none";
        document.getElementById("roleplay-content").style.display = "none";
        document.getElementById("full-content").style.display = "none";
        document.getElementById("completion-screen").classList.remove("show");

        document.getElementById("reading-btn").classList.remove("active");
        document.getElementById("roleplay-btn").classList.remove("active");
        document.getElementById("full-btn").classList.remove("active");

        if (mode === "reading") {
          document.getElementById("reading-content").style.display = "block";
          document.getElementById("reading-btn").classList.add("active");
        } else if (mode === "roleplay") {
          document.getElementById("roleplay-content").style.display = "block";
          document.getElementById("roleplay-btn").classList.add("active");
        } else {
          document.getElementById("full-content").style.display = "block";
          document.getElementById("full-btn").classList.add("active");
        }
      }

      // B·∫Øt ƒë·∫ßu ƒë√≥ng vai
      function startRoleplay(role) {
        currentRole = role;
        currentDialogIndex = 0;
        isStarted = true;
        correctCount = 0;
        totalAnswered = 0;
        timeRemaining = 300;
        startTime = new Date();

        document.getElementById("roleplay-area").style.display = "block";
        document.getElementById("practice-noll-btn").style.display = "none";
        document.getElementById("practice-jenny-btn").style.display = "none";
        document.getElementById("speak-btn").style.display = "inline-block";
        document.getElementById("correct-btn").style.display = "inline-block";
        document.getElementById("incorrect-btn").style.display = "inline-block";

        startTimer();
        loadCurrentDialog();
      }

      // T·∫£i ƒëo·∫°n h·ªôi tho·∫°i hi·ªán t·∫°i
      function loadCurrentDialog() {
        if (currentDialogIndex >= dialogueData[currentRole].length) {
          completePractice();
          return;
        }

        const dialog = dialogueData[currentRole][currentDialogIndex];
        const dialogNumber = currentDialogIndex + 1;
        document.getElementById("current-prompt").innerHTML = `
          <div class="dialog-number ${
            currentRole === "noll" ? "" : "triangle"
          }">${dialogNumber}</div>
          <div class="vietnamese-text">${dialog.vietnamese}</div>
          <div class="improved-translation">H√£y n√≥i b·∫±ng ti·∫øng ƒê·ª©c:</div>
        `;
        document.getElementById(
          "counter"
        ).textContent = `C√¢u ${dialogNumber} / ${dialogueData[currentRole].length}`;
        document.getElementById("answer-section").style.display = "none";
        document.getElementById("next-btn").style.display = "none";
        document.getElementById("correct-btn").style.display = "inline-block";
        document.getElementById("incorrect-btn").style.display = "inline-block";

        const progress =
          ((currentDialogIndex + 1) / dialogueData[currentRole].length) * 100;
        document.getElementById("progress").style.width = `${progress}%`;
      }

      // ƒê√°nh gi√° c√¢u tr·∫£ l·ªùi
      function markAnswer(isCorrect) {
        totalAnswered++;
        if (isCorrect) {
          correctCount++;
        }

        document.getElementById("correct-count").textContent = correctCount;
        document.getElementById("total-answered").textContent = totalAnswered;

        showAnswer();
        document.getElementById("correct-btn").style.display = "none";
        document.getElementById("incorrect-btn").style.display = "none";
        document.getElementById("next-btn").style.display = "inline-block";
      }

      // Hi·ªÉn th·ªã ƒë√°p √°n
      function showAnswer() {
        const dialog = dialogueData[currentRole][currentDialogIndex];
        document.getElementById("correct-answer").innerHTML = `
          <div class="german-text">${dialog.german}</div>
          <div class="improved-translation">Ph√°t √¢m: ${dialog.german}</div>
        `;
        document.getElementById("answer-section").style.display = "block";
      }

      // Chuy·ªÉn ƒë·∫øn ƒëo·∫°n h·ªôi tho·∫°i ti·∫øp theo
      function nextDialog() {
        currentDialogIndex++;
        loadCurrentDialog();
      }

      // B·∫Øt ƒë·∫ßu b·ªô ƒë·∫øm th·ªùi gian
      function startTimer() {
        timerInterval = setInterval(() => {
          timeRemaining--;
          updateTimerDisplay();

          if (timeRemaining <= 0) {
            completePractice();
          }
        }, 1000);
      }

      // C·∫≠p nh·∫≠t hi·ªÉn th·ªã th·ªùi gian
      function updateTimerDisplay() {
        const minutes = Math.floor(timeRemaining / 60);
        const seconds = timeRemaining % 60;
        const timeStr = `${minutes.toString().padStart(2, "0")}:${seconds
          .toString()
          .padStart(2, "0")}`;
        const timerElement = document.getElementById("timer");
        timerElement.textContent = timeStr;

        if (timeRemaining <= 30) {
          timerElement.classList.add("timer-warning");
        } else {
          timerElement.classList.remove("timer-warning");
        }
      }

      // D·ª´ng b·ªô ƒë·∫øm th·ªùi gian
      function stopTimer() {
        if (timerInterval) {
          clearInterval(timerInterval);
          timerInterval = null;
        }
      }

      // Ho√†n th√†nh luy·ªán t·∫≠p
      function completePractice() {
        stopTimer();

        const totalTime = Math.floor((new Date() - startTime) / 1000);
        const minutes = Math.floor(totalTime / 60);
        const seconds = totalTime % 60;
        const timeStr = `${minutes.toString().padStart(2, "0")}:${seconds
          .toString()
          .padStart(2, "0")}`;
        const accuracy =
          totalAnswered > 0
            ? Math.round((correctCount / totalAnswered) * 100)
            : 0;
        const targetScore = Math.ceil(dialogueData[currentRole].length * 0.8);

        document.getElementById("final-correct").textContent = correctCount;
        document.getElementById("final-answered").textContent = totalAnswered;
        document.getElementById("final-accuracy").textContent = `${accuracy}%`;
        document.getElementById("final-time").textContent = timeStr;

        let resultEmoji, resultTitle, resultMessage, resultClass;
        if (correctCount >= targetScore) {
          resultEmoji = "üèÜ";
          resultTitle = "Xu·∫•t s·∫Øc!";
          resultMessage = `B·∫°n ƒë·∫°t ${correctCount}/${dialogueData[currentRole].length} c√¢u ƒë√∫ng! Ch√∫c m·ª´ng!`;
          resultClass = "result-success";
        } else {
          resultEmoji = "üìö";
          resultTitle = "C·∫ßn luy·ªán t·∫≠p th√™m!";
          resultMessage = `B·∫°n ƒë·∫°t ${correctCount}/${dialogueData[currentRole].length} c√¢u ƒë√∫ng. M·ª•c ti√™u: ${targetScore} c√¢u ƒë√∫ng.`;
          resultClass = "result-failure";
        }

        document.getElementById("result-emoji").textContent = resultEmoji;
        document.getElementById("result-title").textContent = resultTitle;
        document.getElementById("result-title").className = resultClass;
        document.getElementById("result-message").textContent = resultMessage;

        document.getElementById("roleplay-content").style.display = "none";
        document.getElementById("completion-screen").classList.add("show");
      }

      // ƒê·∫∑t l·∫°i luy·ªán t·∫≠p
      function resetPractice() {
        isStarted = false;
        currentDialogIndex = 0;
        correctCount = 0;
        totalAnswered = 0;
        timeRemaining = 300;
        stopTimer();

        document.getElementById("roleplay-area").style.display = "none";
        document.getElementById("completion-screen").classList.remove("show");
        document.getElementById("practice-noll-btn").style.display =
          "inline-block";
        document.getElementById("practice-jenny-btn").style.display =
          "inline-block";
        document.getElementById("timer").textContent = "05:00";
        document.getElementById("correct-count").textContent = "0";
        document.getElementById("total-answered").textContent = "0";
        document.getElementById("progress").style.width = "0%";
      }

      // Ph√°t √¢m ti·∫øng ƒê·ª©c
      function speakGerman(text) {
        if ("speechSynthesis" in window) {
          speechSynthesis.cancel();
          const utterance = new SpeechSynthesisUtterance(text);
          utterance.lang = "de-DE";
          utterance.rate = 0.8;
          utterance.volume = 1.0;
          speechSynthesis.speak(utterance);
        } else {
          alert(
            "Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ text-to-speech. H√£y th·ª≠ Chrome ho·∫∑c Edge!"
          );
        }
      }

      // Ph√°t √¢m c√¢u ti·∫øng ƒê·ª©c hi·ªán t·∫°i
      function speakCurrentGerman() {
        const dialog = dialogueData[currentRole][currentDialogIndex];
        speakGerman(dialog.german);
      }

      // Ph√°t to√†n b·ªô h·ªôi tho·∫°i
      function speakAllGerman() {
        let allText = dialogueData.full.map((item) => item.german);
        let i = 0;
        function speakNext() {
          if (i < allText.length) {
            speakGerman(allText[i]);
            i++;
            setTimeout(speakNext, 2000);
          }
        }
        speakNext();
      }

      // X·ª≠ l√Ω ph√≠m t·∫Øt
      document.addEventListener("keydown", function (e) {
        if (!isStarted || currentMode !== "roleplay") return;

        switch (e.key) {
          case " ":
            e.preventDefault();
            speakCurrentGerman();
            break;
          case "1":
            e.preventDefault();
            if (
              document.getElementById("correct-btn").style.display !== "none"
            ) {
              markAnswer(true);
            }
            break;
          case "2":
            e.preventDefault();
            if (
              document.getElementById("incorrect-btn").style.display !== "none"
            ) {
              markAnswer(false);
            }
            break;
          case "Enter":
            e.preventDefault();
            if (document.getElementById("next-btn").style.display !== "none") {
              nextDialog();
            }
            break;
          case "Escape":
            e.preventDefault();
            setMode("roleplay");
            break;
        }
      });

      // Kh·ªüi t·∫°o
      setMode("reading");

      if ("speechSynthesis" in window) {
        speechSynthesis.onvoiceschanged = function () {
          const voices = speechSynthesis.getVoices();
          console.log("Available voices:", voices.length);
        };
      }
    </script>
  </body>
</html>
