<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Luy·ªán t·∫≠p t·ª´ v·ª±ng ti·∫øng ƒê·ª©c</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Arial", sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        color: #333;
      }

      .container {
        background: white;
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        width: 90%;
        max-width: 600px;
        text-align: center;
      }

      h1 {
        color: #4a5568;
        margin-bottom: 30px;
        font-size: 2.5em;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      }

      .menu {
        display: flex;
        flex-direction: column;
        gap: 20px;
        margin-bottom: 30px;
      }

      .section-btn {
        background: linear-gradient(45deg, #667eea, #764ba2);
        color: white;
        border: none;
        padding: 20px 30px;
        border-radius: 15px;
        font-size: 1.2em;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
      }

      .section-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 25px rgba(0, 0, 0, 0.2);
      }

      .quiz-container {
        display: none;
      }

      .timer {
        font-size: 1.5em;
        color: #e53e3e;
        margin-bottom: 20px;
        font-weight: bold;
      }

      .question {
        background: #f7fafc;
        padding: 40px;
        border-radius: 15px;
        margin-bottom: 30px;
        border-left: 5px solid #667eea;
      }

      .vietnamese-word {
        font-size: 2.5em;
        color: #2d3748;
        margin-bottom: 30px;
        font-weight: bold;
      }

      .audio-controls {
        margin: 30px 0;
        display: flex;
        justify-content: center;
        gap: 20px;
        flex-wrap: wrap;
      }

      .audio-btn {
        background: linear-gradient(45deg, #38a169, #48bb78);
        color: white;
        border: none;
        padding: 15px 25px;
        border-radius: 50px;
        font-size: 1.1em;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 10px;
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
      }

      .audio-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 25px rgba(0, 0, 0, 0.2);
      }

      .audio-btn:disabled {
        background: #a0aec0;
        cursor: not-allowed;
        transform: none;
      }

      .btn {
        background: linear-gradient(45deg, #48bb78, #38a169);
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 10px;
        font-size: 1.1em;
        cursor: pointer;
        margin: 10px;
        transition: all 0.3s ease;
      }

      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
      }

      .btn-danger {
        background: linear-gradient(45deg, #f56565, #e53e3e);
      }

      .btn-large {
        padding: 20px 40px;
        font-size: 1.3em;
        margin: 15px;
      }

      .result {
        margin-top: 20px;
        padding: 20px;
        border-radius: 10px;
        font-size: 1.2em;
        display: none;
      }

      .correct {
        background: #c6f6d5;
        color: #22543d;
        border: 2px solid #48bb78;
      }

      .skipped {
        background: #fed7d7;
        color: #742a2a;
        border: 2px solid #f56565;
      }

      .progress {
        background: #e2e8f0;
        border-radius: 10px;
        height: 20px;
        margin-bottom: 20px;
        overflow: hidden;
      }

      .progress-bar {
        background: linear-gradient(45deg, #667eea, #764ba2);
        height: 100%;
        transition: width 0.3s ease;
      }

      .stats {
        display: flex;
        justify-content: space-around;
        margin-top: 20px;
      }

      .stat {
        text-align: center;
      }

      .stat-number {
        font-size: 2em;
        font-weight: bold;
        color: #667eea;
      }

      .stat-label {
        color: #718096;
      }

      .final-score {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        border-radius: 15px;
        margin-top: 20px;
      }

      .instruction {
        background: #e6fffa;
        color: #234e52;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 20px;
        border-left: 4px solid #38b2ac;
      }

      .german-word-display {
        font-size: 2.2em;
        color: #2b6cb0;
        margin: 20px 0;
        font-weight: bold;
        background: #ebf8ff;
        padding: 20px;
        border-radius: 10px;
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üá©üá™ Luy·ªán t·∫≠p t·ª´ v·ª±ng ti·∫øng ƒê·ª©c</h1>

      <div id="menu" class="menu">
        <div class="instruction">
          üéß Ch·∫ø ƒë·ªô nghe v√† nh·ªõ: Nghe t·ª´ ti·∫øng Vi·ªát, nh·ªõ t·ª´ ti·∫øng ƒê·ª©c, sau ƒë√≥
          b·∫•m "Bi·∫øt r·ªìi" ho·∫∑c "Kh√¥ng bi·∫øt"
        </div>
        <button class="section-btn" onclick="startQuiz(1)">
          üìö Ph·∫ßn 1: T·ª´ v·ª±ng c∆° b·∫£n (72 t·ª´)
        </button>
        <button class="section-btn" onclick="startQuiz(2)">
          üéØ Ph·∫ßn 2: Th·ªùi gian r·∫£nh & Ho·∫°t ƒë·ªông (57 t·ª´)
        </button>
      </div>

      <div id="quiz" class="quiz-container">
        <div class="progress">
          <div id="progressBar" class="progress-bar" style="width: 0%"></div>
        </div>

        <div class="stats">
          <div class="stat">
            <div id="currentQuestion" class="stat-number">1</div>
            <div class="stat-label">C√¢u hi·ªán t·∫°i</div>
          </div>
          <div class="stat">
            <div id="totalQuestions" class="stat-number">0</div>
            <div class="stat-label">T·ªïng s·ªë c√¢u</div>
          </div>
          <div class="stat">
            <div id="correctCount" class="stat-number">0</div>
            <div class="stat-label">Bi·∫øt</div>
          </div>
        </div>

        <div id="timer" class="timer">‚è∞ 05:00</div>

        <div class="question">
          <div id="vietnameseWord" class="vietnamese-word"></div>

          <div class="audio-controls">
            <button
              id="playVietnameseBtn"
              class="audio-btn"
              onclick="playVietnamese()"
            >
              üîä Nghe ti·∫øng Vi·ªát
            </button>
            <button
              id="playGermanBtn"
              class="audio-btn"
              onclick="playGerman()"
              style="display: none"
            >
              üéµ Nghe ti·∫øng ƒê·ª©c
            </button>
          </div>

          <div id="germanWordDisplay" class="german-word-display"></div>

          <div id="answerButtons" style="margin-top: 30px">
            <button id="knowBtn" class="btn btn-large" onclick="markAsKnown()">
              ‚úÖ Bi·∫øt r·ªìi
            </button>
            <button
              id="dontKnowBtn"
              class="btn btn-danger btn-large"
              onclick="markAsUnknown()"
            >
              ‚ùå Kh√¥ng bi·∫øt
            </button>
          </div>
        </div>

        <div id="result" class="result"></div>

        <button
          id="nextBtn"
          class="btn btn-large"
          onclick="nextQuestion()"
          style="display: none"
        >
          ‚û°Ô∏è C√¢u ti·∫øp theo
        </button>
        <button id="backBtn" class="btn btn-danger" onclick="backToMenu()">
          üè† V·ªÅ menu
        </button>
      </div>
    </div>

    <script>
      // D·ªØ li·ªáu t·ª´ v·ª±ng t·ª´ c√°c h√¨nh ·∫£nh
      const vocabularyData = {
        1: [
          // Ph·∫ßn 1: T·ª´ v·ª±ng c∆° b·∫£n (72 t·ª´)
          { german: "essen", vietnamese: "ƒÉn" },
          { german: "trinken", vietnamese: "u·ªëng" },
          { german: "Hunger haben", vietnamese: "ƒë√≥i" },
          { german: "Durst haben", vietnamese: "kh√°t" },
          { german: "das Fr√ºhst√ºck", vietnamese: "b·ªØa s√°ng" },
          { german: "fr√ºhst√ºcken", vietnamese: "ƒÉn s√°ng" },
          { german: "das Mittagessen", vietnamese: "b·ªØa trua" },
          { german: "das Abendessen", vietnamese: "b·ªØa t·ªëi" },
          { german: "die K√ºche", vietnamese: "b·∫øp" },
          { german: "die Suppe", vietnamese: "s√∫p" },
          { german: "Guten Appetit!", vietnamese: "ch√∫c ngon mi·ªáng" },
          { german: "das Gesch√§ft", vietnamese: "c·ª≠a h√†ng" },
          { german: "die B√§ckerei", vietnamese: "ti·ªám b√°nh" },
          { german: "der Supermarkt", vietnamese: "si√™u th·ªã" },
          { german: "ge√∂ffnet (von - bis)", vietnamese: "m·ªü c·ª≠a" },
          { german: "die Lebensmittel (Plural)", vietnamese: "th·ª±c ph·∫©m" },
          { german: "das Brot", vietnamese: "b√°nh m√¨" },
          { german: "das Br√∂tchen", vietnamese: "b√°nh m√¨ nh·ªè" },
          { german: "die Butter", vietnamese: "b∆°" },
          { german: "die Milch", vietnamese: "s·ªØa" },
          { german: "der K√§se", vietnamese: "ph√¥ mai" },
          { german: "das Ei", vietnamese: "tr·ª©ng" },
          { german: "der Fisch", vietnamese: "c√°" },
          { german: "das Fleisch", vietnamese: "th·ªãt" },
          { german: "das H√§hnchen", vietnamese: "g√†" },
          { german: "der Schinken", vietnamese: "giƒÉm b√¥ng" },
          { german: "das Gem√ºse", vietnamese: "rau c·ªß" },
          { german: "die Tomate", vietnamese: "c√† chua" },
          { german: "die Kartoffel", vietnamese: "khoai t√¢y" },
          {
            german: "die Pommes (frites) (Plural)",
            vietnamese: "khoai t√¢y chi√™n",
          },
          { german: "der Salat", vietnamese: "salad" },
          { german: "das √ñl", vietnamese: "d·∫ßu ƒÉn" },
          { german: "die Nudeln (Plural)", vietnamese: "m√¨" },
          { german: "der Kuchen", vietnamese: "b√°nh ng·ªçt" },
          { german: "das Obst", vietnamese: "tr√°i c√¢y" },
          { german: "die Orange", vietnamese: "cam" },
          { german: "der Apfel", vietnamese: "t√°o" },
          { german: "die Banane", vietnamese: "chu·ªëi" },
          { german: "die Birne", vietnamese: "l√™" },
          { german: "die Zitrone", vietnamese: "chanh" },
          { german: "der Reis", vietnamese: "g·∫°o" },
          { german: "das Salz", vietnamese: "mu·ªëi" },
          { german: "das Getr√§nk", vietnamese: "ƒë·ªì u·ªëng" },
          { german: "das Wasser", vietnamese: "n∆∞·ªõc" },
          { german: "der Kaffee", vietnamese: "c√† ph√™" },
          { german: "der Tee", vietnamese: "tr√†" },
          { german: "der Saft", vietnamese: "n∆∞·ªõc √©p" },
          { german: "das Bier", vietnamese: "bia" },
          { german: "der Wein", vietnamese: "r∆∞·ª£u vang" },
          { german: "kaufen", vietnamese: "mua" },
          { german: "einkaufen", vietnamese: "ƒëi mua s·∫Øm" },
          { german: "verkaufen", vietnamese: "b√°n" },
          { german: "das Angebot", vietnamese: "∆∞u ƒë√£i" },
          { german: "g√ºnstig/billig", vietnamese: "r·∫ª" },
          { german: "teuer", vietnamese: "ƒë·∫Øt" },
          { german: "m√∂gen", vietnamese: "th√≠ch" },
          { german: "brauchen", vietnamese: "c·∫ßn" },
          { german: "nehmen", vietnamese: "l·∫•y" },
          { german: "es gibt", vietnamese: "c√≥" },
          { german: "das Kilogramm", vietnamese: "kg" },
          { german: "das Pfund", vietnamese: "pound" },
          { german: "das Gramm", vietnamese: "gram" },
          { german: "kosten", vietnamese: "c√≥ gi√°" },
          { german: "der Preis", vietnamese: "gi√°" },
          { german: "bezahlen/zahlen", vietnamese: "tr·∫£ ti·ªÅn" },
          { german: "bar (bezahlen)", vietnamese: "ti·ªÅn m·∫∑t" },
          { german: "die Kasse", vietnamese: "qu·∫ßy t√≠nh ti·ªÅn" },
          { german: "das Geld", vietnamese: "ti·ªÅn" },
          { german: "der Euro", vietnamese: "euro" },
          { german: "das Restaurant", vietnamese: "nh√† h√†ng" },
          { german: "das Caf√©", vietnamese: "qu√°n c√† ph√™" },
          { german: "die Speisekarte", vietnamese: "th·ª±c ƒë∆°n" },
          { german: "bestellen", vietnamese: "g·ªçi m√≥n" },
          { german: "die Rechnung", vietnamese: "h√≥a ƒë∆°n" },
          { german: "bekommen", vietnamese: "nh·∫≠n ƒë∆∞·ª£c" },
        ],
        2: [
          // Ph·∫ßn 2: Th·ªùi gian r·∫£nh v√† ho·∫°t ƒë·ªông (57 t·ª´)
          { german: "die Freizeit", vietnamese: "th·ªùi gian r·∫£nh" },
          { german: "die Ferien (Plural)", vietnamese: "k·ª≥ ngh·ªâ" },
          { german: "der Urlaub", vietnamese: "k·ª≥ ngh·ªâ" },
          { german: "Ferien/Urlaub machen", vietnamese: "ƒëi ngh·ªâ" },
          { german: "Ferien/Urlaub haben", vietnamese: "c√≥ k·ª≥ ngh·ªâ" },
          { german: "das Hobby", vietnamese: "s·ªü th√≠ch" },
          { german: "spielen", vietnamese: "ch∆°i" },
          { german: "Fu√üball spielen", vietnamese: "ch∆°i b√≥ng ƒë√°" },
          { german: "der Ball", vietnamese: "qu·∫£ b√≥ng" },
          { german: "Karten spielen", vietnamese: "ch∆°i b√†i" },
          { german: "Gitarre spielen", vietnamese: "ch∆°i guitar" },
          { german: "Musik h√∂ren", vietnamese: "nghe nh·∫°c" },
          { german: "die Musik", vietnamese: "√¢m nh·∫°c" },
          { german: "die CD", vietnamese: "ƒëƒ©a CD" },
          { german: "wandern", vietnamese: "ƒëi b·ªô ƒë∆∞·ªùng d√†i" },
          { german: "schwimmen", vietnamese: "b∆°i" },
          { german: "lesen", vietnamese: "ƒë·ªçc" },
          { german: "das Buch", vietnamese: "s√°ch" },
          { german: "die Zeitung", vietnamese: "b√°o" },
          { german: "fernsehen", vietnamese: "xem tivi" },
          { german: "tanzen", vietnamese: "nh·∫£y" },
          { german: "der Computer", vietnamese: "m√°y t√≠nh" },
          { german: "Computer spielen", vietnamese: "ch∆°i m√°y t√≠nh" },
          { german: "der Sport", vietnamese: "th·ªÉ thao" },
          { german: "Sport machen", vietnamese: "t·∫≠p th·ªÉ thao" },
          { german: "ins Kino gehen", vietnamese: "ƒëi xem phim" },
          { german: "das Kino", vietnamese: "r·∫°p chi·∫øu phim" },
          { german: "einen Film sehen", vietnamese: "xem phim" },
          { german: "der Film", vietnamese: "b·ªô phim" },
          { german: "Rad fahren", vietnamese: "ƒëi xe ƒë·∫°p" },
          { german: "spazieren gehen", vietnamese: "ƒëi d·∫°o" },
          { german: "in die Disco gehen", vietnamese: "ƒëi disco" },
          { german: "die Disco", vietnamese: "v≈© tr∆∞·ªùng" },
          { german: "das Museum", vietnamese: "b·∫£o t√†ng" },
          { german: "der Verein", vietnamese: "c√¢u l·∫°c b·ªô" },
          { german: "der Sportverein", vietnamese: "c√¢u l·∫°c b·ªô th·ªÉ thao" },
          { german: "sich anmelden", vietnamese: "ƒëƒÉng k√Ω" },
          { german: "die Anmeldung", vietnamese: "ƒë∆°n ƒëƒÉng k√Ω" },
          { german: "das Schwimmbad", vietnamese: "b·ªÉ b∆°i" },
          { german: "gefallen", vietnamese: "th√≠ch" },
          { german: "das gef√§llt mir", vietnamese: "t√¥i th√≠ch c√°i ƒë√≥" },
          { german: "das gef√§llt mir nicht", vietnamese: "t√¥i kh√¥ng th√≠ch" },
          { german: "sch√∂n", vietnamese: "ƒë·∫πp" },
          { german: "interessant", vietnamese: "th√∫ v·ªã" },
          { german: "m√∂gen", vietnamese: "th√≠ch" },
          { german: "ich mag", vietnamese: "t√¥i th√≠ch" },
          { german: "es gibt", vietnamese: "c√≥" },
          { german: "ge√∂ffnet (sein)", vietnamese: "m·ªü c·ª≠a" },
          { german: "auf (sein) / offen (sein)", vietnamese: "m·ªü" },
          { german: "geschlossen (sein)", vietnamese: "ƒë√≥ng c·ª≠a" },
          { german: "zu (sein)/haben", vietnamese: "ƒë√≥ng" },
          { german: "von - bis", vietnamese: "t·ª´ - ƒë·∫øn" },
          { german: "die Karte", vietnamese: "th·∫ª" },
          { german: "die Eintrittskarte", vietnamese: "v√© v√†o c·ª≠a" },
          { german: "das Ticket", vietnamese: "v√©" },
          { german: "kaufen", vietnamese: "mua" },
          { german: "reservieren", vietnamese: "ƒë·∫∑t ch·ªó" },
          { german: "(sich) treffen", vietnamese: "g·∫∑p nhau" },
        ],
      };

      let currentSection = 1;
      let currentQuestionIndex = 0;
      let knownAnswers = 0;
      let timeLeft = 300; // 5 ph√∫t = 300 gi√¢y
      let timer;
      let questions = [];
      let currentQuestion = null;

      // Function ƒë·ªÉ d·ª´ng t·∫•t c·∫£ √¢m thanh ƒëang ph√°t
      function stopAllSpeech() {
        if ("speechSynthesis" in window) {
          speechSynthesis.cancel();
        }
      }

      // Text-to-Speech function ƒë√£ ƒë∆∞·ª£c c·∫£i thi·ªán
      function speak(text, lang = "vi-VN") {
        if ("speechSynthesis" in window) {
          // D·ª´ng t·∫•t c·∫£ √¢m thanh tr∆∞·ªõc khi ph√°t √¢m thanh m·ªõi
          stopAllSpeech();

          // ƒê·ª£i m·ªôt ch√∫t ƒë·ªÉ ƒë·∫£m b·∫£o √¢m thanh c≈© ƒë√£ d·ª´ng ho√†n to√†n
          setTimeout(() => {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = lang;
            utterance.rate = 0.8;
            utterance.pitch = 1;
            speechSynthesis.speak(utterance);
          }, 100);
        }
      }

      function startQuiz(section) {
        // D·ª´ng t·∫•t c·∫£ √¢m thanh khi b·∫Øt ƒë·∫ßu quiz m·ªõi
        stopAllSpeech();

        currentSection = section;
        questions = vocabularyData[section]; // Gi·ªØ nguy√™n th·ª© t·ª± t·ª´ s√°ch

        currentQuestionIndex = 0;
        knownAnswers = 0;
        timeLeft = 300;

        document.getElementById("menu").style.display = "none";
        document.getElementById("quiz").style.display = "block";
        document.getElementById("totalQuestions").textContent =
          questions.length;

        startTimer();
        showQuestion();
      }

      function startTimer() {
        timer = setInterval(() => {
          timeLeft--;
          const minutes = Math.floor(timeLeft / 60);
          const seconds = timeLeft % 60;
          document.getElementById("timer").textContent = `‚è∞ ${minutes
            .toString()
            .padStart(2, "0")}:${seconds.toString().padStart(2, "0")}`;

          if (timeLeft <= 0) {
            clearInterval(timer);
            endQuiz();
          }
        }, 1000);
      }

      function showQuestion() {
        // D·ª´ng t·∫•t c·∫£ √¢m thanh tr∆∞·ªõc khi hi·ªÉn th·ªã c√¢u h·ªèi m·ªõi
        stopAllSpeech();

        if (currentQuestionIndex >= questions.length) {
          endQuiz();
          return;
        }

        currentQuestion = questions[currentQuestionIndex];
        document.getElementById("vietnameseWord").textContent =
          currentQuestion.vietnamese;
        document.getElementById("germanWordDisplay").style.display = "none";
        document.getElementById("germanWordDisplay").textContent = "";
        document.getElementById("result").style.display = "none";
        document.getElementById("nextBtn").style.display = "none";
        document.getElementById("answerButtons").style.display = "block";
        document.getElementById("playGermanBtn").style.display = "none";

        // C·∫≠p nh·∫≠t progress
        const progress = (currentQuestionIndex / questions.length) * 100;
        document.getElementById("progressBar").style.width = progress + "%";
        document.getElementById("currentQuestion").textContent =
          currentQuestionIndex + 1;

        // Auto play Vietnamese sau khi ƒë√£ d·ª´ng √¢m thanh c≈©
        setTimeout(() => {
          playVietnamese();
        }, 500);
      }

      function playVietnamese() {
        speak(currentQuestion.vietnamese, "vi-VN");
      }

      function playGerman() {
        speak(currentQuestion.german, "de-DE");
      }

      function markAsKnown() {
        knownAnswers++;
        showResult(true);
        document.getElementById("correctCount").textContent = knownAnswers;
      }

      function markAsUnknown() {
        showResult(false);
      }

      function showResult(isKnown) {
        const resultDiv = document.getElementById("result");
        const germanDisplay = document.getElementById("germanWordDisplay");

        germanDisplay.textContent = currentQuestion.german;
        germanDisplay.style.display = "block";

        if (isKnown) {
          resultDiv.innerHTML = `
                    <div class="correct">
                        ‚úÖ Tuy·ªát v·ªùi! B·∫°n ƒë√£ bi·∫øt t·ª´ n√†y
                    </div>
                `;
          resultDiv.className = "result correct";
        } else {
          resultDiv.innerHTML = `
                    <div class="skipped">
                        üìö H√£y ghi nh·ªõ t·ª´ n√†y nh√©!
                    </div>
                `;
          resultDiv.className = "result skipped";
        }

        resultDiv.style.display = "block";
        document.getElementById("answerButtons").style.display = "none";
        document.getElementById("nextBtn").style.display = "inline-block";
        document.getElementById("playGermanBtn").style.display = "inline-block";

        // Auto play German pronunciation sau khi d·ª´ng √¢m thanh c≈©
        setTimeout(() => {
          playGerman();
        }, 300);
      }

      function nextQuestion() {
        // D·ª´ng √¢m thanh tr∆∞·ªõc khi chuy·ªÉn c√¢u h·ªèi
        stopAllSpeech();
        currentQuestionIndex++;
        showQuestion();
      }

      function endQuiz() {
        clearInterval(timer);
        stopAllSpeech(); // D·ª´ng √¢m thanh khi k·∫øt th√∫c quiz

        const percentage = Math.round((knownAnswers / questions.length) * 100);
        let message = "";
        let emoji = "";

        if (percentage >= 90) {
          message = "Xu·∫•t s·∫Øc!";
          emoji = "üåü";
        } else if (percentage >= 80) {
          message = "R·∫•t t·ªët!";
          emoji = "üéâ";
        } else if (percentage >= 70) {
          message = "T·ªët!";
          emoji = "üëç";
        } else if (percentage >= 60) {
          message = "Kh√°!";
          emoji = "üëå";
        } else {
          message = "C·∫ßn √¥n t·∫≠p th√™m!";
          emoji = "üí™";
        }

        document.getElementById("quiz").innerHTML = `
                <div class="final-score">
                    <h2>${emoji} ${message}</h2>
                    <div style="font-size: 3em; margin: 20px 0;">${percentage}%</div>
                    <p>B·∫°n ƒë√£ bi·∫øt <strong>${knownAnswers}</strong> / <strong>${questions.length}</strong> t·ª´</p>
                    <button class="btn" onclick="location.reload()" style="margin-top: 30px; background: white; color: #667eea;">
                        üîÑ L√†m l·∫°i
                    </button>
                </div>
            `;
      }

      function backToMenu() {
        clearInterval(timer);
        stopAllSpeech(); // D·ª´ng √¢m thanh khi v·ªÅ menu
        document.getElementById("menu").style.display = "flex";
        document.getElementById("quiz").style.display = "none";
      }

      // X·ª≠ l√Ω ph√≠m t·∫Øt
      document.addEventListener("keydown", function (event) {
        if (document.getElementById("quiz").style.display === "block") {
          if (event.code === "Space") {
            event.preventDefault();
            const knowBtn = document.getElementById("knowBtn");
            const nextBtn = document.getElementById("nextBtn");

            if (knowBtn.parentElement.style.display !== "none") {
              markAsKnown();
            } else if (nextBtn.style.display !== "none") {
              nextQuestion();
            }
          } else if (event.code === "KeyX") {
            event.preventDefault();
            if (
              document.getElementById("answerButtons").style.display !== "none"
            ) {
              markAsUnknown();
            }
          } else if (event.code === "KeyV") {
            event.preventDefault();
            playVietnamese();
          } else if (event.code === "KeyG") {
            event.preventDefault();
            if (
              document.getElementById("playGermanBtn").style.display !== "none"
            ) {
              playGerman();
            }
          }
        }
      });

      // Hi·ªÉn th·ªã h∆∞·ªõng d·∫´n ph√≠m t·∫Øt
      document.addEventListener("DOMContentLoaded", function () {
        const instruction = document.querySelector(".instruction");
        instruction.innerHTML +=
          "<br><br>üéÆ <strong>Ph√≠m t·∫Øt:</strong> Space = Bi·∫øt | X = Kh√¥ng bi·∫øt | V = Nghe ti·∫øng Vi·ªát | G = Nghe ti·∫øng ƒê·ª©c";
      });

      // D·ª´ng √¢m thanh khi ng∆∞·ªùi d√πng r·ªùi kh·ªèi trang
      window.addEventListener("beforeunload", function () {
        stopAllSpeech();
      });

      // D·ª´ng √¢m thanh khi tab b·ªã ·∫©n
      document.addEventListener("visibilitychange", function () {
        if (document.hidden) {
          stopAllSpeech();
        }
      });
    </script>
  </body>
</html>
