], // DIALOG 4: Mua rau quả (7 câu) [ { vietnamese: "Chào bạn! Cho tôi nửa kg cà
chua và 1 kg khoai tây.", german: "Guten Tag! Ein Pfund Tomaten bitte und ein
Kilo Kartoffeln.", tip: "🍅🥔 'Ein Pfund' = nửa kg. Cách đặt hàng tại chợ",
explanation: "'Ein Pfund' = 0.5 kg trong tiếng Đức. 'bitte' làm cho lời yêu cầu
lịch sự hơn.", structure: "Guten Tag! Ein Pfund Tomaten bitte und ein Kilo
Kartoffeln\n ↑ ↑ ↑ ↑ ↑\nLời chào Akk Bổ nghĩa Liên từ Akk", analysis: [ { word:
"Guten Tag", type: "Lời chào", meaning: "chào bạn" }, { word: "Ein Pfund
Tomaten", type: "Tân ngữ (Akk)", meaning: "nửa kg cà chua" }, { word: "bitte",
type: "Bổ nghĩa", meaning: "làm ơn" }, { word: "und", type: "Liên từ", meaning:
"và" }, { word: "ein Kilo Kartoffeln", type: "Tân ngữ (Akk)", meaning: "1 kg
khoai tây" } ], grammarType: "Câu yêu cầu mua hàng với 'bitte'", }, {
vietnamese: "Nửa kg cà chua 1 Euro 15, và 1 kg khoai tây 1 Euro 50.", german:
"Ein Pfund Tomaten 1,15 Euro und ein Kilo Kartoffeln 1,50 Euro.", tip: "💰 Đáp
án đúng - cách báo giá trong tiếng Đức", explanation: "Cách báo giá tiêu chuẩn:
[số lượng] + [hàng hóa] + [giá tiền]. Dấu phẩy dùng cho số thập phân.",
structure: "Ein Pfund Tomaten 1,15 Euro und ein Kilo Kartoffeln 1,50 Euro\n ↑ ↑
↑ ↑ ↑\n Akk Giá Liên từ Akk Giá", analysis: [ { word: "Ein Pfund Tomaten", type:
"Hàng hóa", meaning: "nửa kg cà chua" }, { word: "1,15 Euro", type: "Giá tiền",
meaning: "1 Euro 15 cent" }, { word: "und", type: "Liên từ", meaning: "và" }, {
word: "ein Kilo Kartoffeln", type: "Hàng hóa", meaning: "1 kg khoai tây" }, {
word: "1,50 Euro", type: "Giá tiền", meaning: "1 Euro 50 cent" } ], grammarType:
"Câu thông báo giá cả", }, { vietnamese: "Của anh đây.", german: "Bitte schön.",
tip: "🤝 Đáp án đúng - cách lịch sự khi đưa hàng", explanation: "'Bitte schön'
dùng khi đưa hàng cho khách. Thể hiện sự lịch sự trong giao dịch.", structure:
"Bitte schön.\n ↑\nCụm cố định", analysis: [ { word: "Bitte schön", type: "Cụm
cố định", meaning: "của anh/chị đây" } ], grammarType: "Cụm từ lịch sự trong
giao dịch", }, { vietnamese: "Anh còn muốn gì nữa không?", german: "Haben Sie
noch einen Wunsch?", tip: "❓ 'einen Wunsch haben' = có mong muốn gì",
explanation: "'Wunsch' = mong muốn. Cách hỏi lịch sự hơn 'Sonst noch etwas?'",
structure: "Haben Sie noch einen Wunsch?\n ↑ ↑ ↑ ↑\n V1 1 Bổ nghĩa Akk",
analysis: [ { word: "Haben", type: "Động từ V1", meaning: "có" }, { word: "Sie",
type: "Chủ ngữ", meaning: "anh/chị" }, { word: "noch", type: "Bổ nghĩa",
meaning: "còn" }, { word: "einen Wunsch", type: "Tân ngữ (Akk)", meaning: "một
mong muốn" } ], grammarType: "Câu hỏi lịch sự của người bán hàng", }, {
vietnamese: "Không, cảm ơn, thế là đủ.", german: "Nein, danke, das ist alles.",
tip: "🛑 'das ist alles' = thế là hết/đủ rồi", explanation: "Cách kết thúc mua
sắm lịch sự. 'alles' = tất cả/đủ rồi.", structure: "Nein, danke, das ist alles\n
↑ ↑ ↑ ↑ ↑\nThán Cảm ơn 1 V2 Vị ngữ", analysis: [ { word: "Nein", type: "Thán
từ", meaning: "không" }, { word: "danke", type: "Cảm ơn", meaning: "cảm ơn" }, {
word: "das", type: "Chủ ngữ", meaning: "điều đó" }, { word: "ist", type: "Động
từ V2", meaning: "là" }, { word: "alles", type: "Vị ngữ", meaning: "tất cả" } ],
grammarType: "Câu kết thúc giao dịch", }, { vietnamese: "Tổng cộng là 2 Euro
65.", german: "Das macht dann 2,65 Euro zusammen.", tip: "🧮 'das macht...
zusammen' = tổng cộng là", explanation: "'macht' = tính ra/bằng. 'zusammen' =
cộng lại. Cách thông báo tổng tiền.", structure: "Das macht dann 2,65 Euro
zusammen\n ↑ ↑ ↑ ↑ ↑\n 1 V2 Te Akk Bổ nghĩa", analysis: [ { word: "Das", type:
"Chủ ngữ", meaning: "điều đó" }, { word: "macht", type: "Động từ V2", meaning:
"tính ra" }, { word: "dann", type: "Te (thời gian)", meaning: "vậy" }, { word:
"2,65 Euro", type: "Tân ngữ (Akk)", meaning: "2 Euro 65 cent" }, { word:
"zusammen", type: "Bổ nghĩa", meaning: "cộng lại" } ], grammarType: "Câu tính
tổng tiền", }, { vietnamese: "Của anh đây.", german: "Bitte schön.", tip: "💶
Đáp án đúng - lần thứ hai khi nhận tiền", explanation: "'Bitte schön' lần thứ
hai khi nhận tiền từ khách hàng. Chu trình giao dịch hoàn chỉnh.", structure:
"Bitte schön.\n ↑\nCụm cố định (lần 2)", analysis: [ { word: "Bitte schön",
type: "Cụm cố định", meaning: "cảm ơn (khi nhận tiền)" } ], grammarType: "Cụm từ
lịch sự (nhận tiền)", }, ], // DIALOG 5: Đăng ký khóa học (5 câu) [ {
vietnamese: "Chào anh! Tôi muốn đăng ký khóa học tiếng Đức tháng Giêng.",
german: "Guten Tag! Ich möchte mich für den Deutschkurs im Januar anmelden.",
tip: "📚 'sich anmelden für' = đăng ký cho. 'im Januar' = trong tháng Giêng",
explanation: "'sich anmelden' là động từ phản thân. 'für + Akkusativ' = cho việc
gì.", structure: "Guten Tag! Ich möchte mich für den Deutschkurs im Januar
anmelden\n ↑ ↑ ↑ ↑ ↑ ↑ ↑\nLời chào 1 V2 Ref Cụm giới từ Te Động từ nguyên mẫu",
analysis: [ { word: "Guten Tag", type: "Lời chào", meaning: "chào anh" }, {
word: "Ich", type: "Chủ ngữ", meaning: "tôi" }, { word: "möchte", type: "Động từ
V2", meaning: "muốn" }, { word: "mich", type: "Đại từ phản thân", meaning: "bản
thân tôi" }, { word: "für den Deutschkurs", type: "Cụm giới từ", meaning: "cho
khóa tiếng Đức" }, { word: "im Januar", type: "Te (thời gian)", meaning: "trong
tháng Giêng" }, { word: "anmelden", type: "Động từ nguyên mẫu", meaning: "đăng
ký" } ], grammarType: "Động từ phản thân + Modalverb", }, { vietnamese: "Anh
thật may mắn, còn một chỗ trống.", german: "Sie haben Glück, ein Platz ist noch
frei.", tip: "🍀 'Glück haben' = may mắn. 'frei sein' = còn trống", explanation:
"'Sie haben Glück' = anh may mắn. 'frei' = tự do/trống. Tin tốt cho khách
hàng.", structure: "Sie haben Glück, ein Platz ist noch frei\n ↑ ↑ ↑ ↑ ↑ ↑ ↑\n 1
V2 Akk 1 V2 Bổ nghĩa Tính từ", analysis: [ { word: "Sie", type: "Chủ ngữ",
meaning: "anh" }, { word: "haben", type: "Động từ V2", meaning: "có" }, { word:
"Glück", type: "Tân ngữ (Akk)", meaning: "may mắn" }, { word: "ein Platz", type:
"Chủ ngữ", meaning: "một chỗ" }, { word: "ist", type: "Động từ V2", meaning:
"là" }, { word: "noch", type: "Bổ nghĩa", meaning: "còn" }, { word: "frei",
type: "Tính từ vị ngữ", meaning: "trống" } ], grammarType: "Câu phức với hai
mệnh đề", }, { vietnamese: "Tuyệt vời.", german: "Super.", tip: "😃 'Super' =
tuyệt vời. Thể hiện sự hài lòng", explanation: "Từ ngoại lai từ tiếng Anh, được
dùng phổ biến trong tiếng Đức hiện đại.", structure: "Super.\n ↑\nThán từ",
analysis: [ { word: "Super", type: "Thán từ", meaning: "tuyệt vời" } ],
grammarType: "Thán từ thể hiện cảm xúc tích cực", }, { vietnamese: "Và khóa học
diễn ra những ngày nào và kéo dài bao lâu?", german: "Und an welchen Tagen ist
der Kurs und wie lange geht er?", tip: "📅 'an welchen Tagen' = những ngày nào.
'wie lange' = bao lâu", explanation: "'an + Dativ' cho ngày trong tuần. Hai câu
hỏi ghép bằng 'und'.", structure: "Und an welchen Tagen ist der Kurs und wie
lange geht er?\n ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑\nLiên từ Cụm giới từ V2 1 Liên từ W-Wort V2 1",
analysis: [ { word: "Und", type: "Liên từ", meaning: "và" }, { word: "an welchen
Tagen", type: "Cụm giới từ", meaning: "vào những ngày nào" }, { word: "ist",
type: "Động từ V2", meaning: "là" }, { word: "der Kurs", type: "Chủ ngữ",
meaning: "khóa học" }, { word: "und", type: "Liên từ", meaning: "và" }, { word:
"wie lange", type: "Từ để hỏi", meaning: "bao lâu" }, { word: "geht", type:
"Động từ V2", meaning: "kéo dài" }, { word: "er", type: "Chủ ngữ", meaning: "nó
(khóa học)" } ], grammarType: "Câu hỏi kép với hai W-Wort", }, { vietnamese:
"Khóa học diễn ra hàng ngày, từ thứ Hai đến thứ Sáu, từ 9 đến 12 giờ, từ 21
tháng Giêng đến 18 tháng Hai, tức là 4 tuần.", german: "Der Kurs ist jeden Tag,
Montag bis Freitag von 9 bis 12 Uhr vom 21. Januar bis zum 18. Februar, also 4
Wochen.", tip: "📋 Đáp án đúng - thông tin chi tiết về lịch học", explanation:
"'jeden Tag' = mỗi ngày. 'von...bis' = từ...đến. 'also' = tức là. Thông tin đầy
đủ về khóa học.", structure: "Der Kurs ist jeden Tag, Montag bis Freitag von 9
bis 12 Uhr vom 21. Januar bis zum 18. Februar, also 4 Wochen\n ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑\n
1 V2 Te Cụm thời gian Cụm thời gian Cụm thời gian Bổ nghĩa Akk", analysis: [ {
word: "Der Kurs", type: "Chủ ngữ", meaning: "khóa học" }, { word: "ist", type:
"Động từ V2", meaning: "diễn ra" }, { word: "jeden Tag", type: "Te (thời gian)",
meaning: "mỗi ngày" }, { word: "Montag bis Freitag", type: "Cụm thời gian",
meaning: "thứ Hai đến thứ Sáu" }, { word: "von 9 bis 12 Uhr", type: "Cụm thời
gian", meaning: "từ 9 đến 12 giờ" }, { word: "vom 21. Januar bis zum 18.
Februar", type: "Cụm thời gian", meaning: "từ 21/1 đến 18/2" }, { word: "also",
type: "Bổ nghĩa", meaning: "tức là" }, { word: "4 Wochen", type: "Tân ngữ
(Akk)", meaning: "4 tuần" } ], grammarType: "Câu thông tin phức tạp với nhiều
cụm thời gian", }, ], // DIALOG 6: Tiệc sinh nhật (9 câu) [ { vietnamese: "Chào
Lola! Chúc mừng sinh nhật!", german: "Hi Lola! Alles Gute zum Geburtstag.", tip:
"🎂 'Alles Gute zum Geburtstag' = chúc mừng sinh nhật", explanation: "Câu chúc
sinh nhật chuẩn trong tiếng Đức. 'alles Gute' = mọi điều tốt đẹp.", structure:
"Hi Lola! Alles Gute zum Geburtstag\n ↑ ↑ ↑\nLời chào Akk (chúc) Cụm giới từ",
analysis: [ { word: "Hi Lola", type: "Lời chào", meaning: "chào Lola" }, { word:
"Alles Gute", type: "Akk (chúc)", meaning: "mọi điều tốt đẹp" }, { word: "zum
Geburtstag", type: "Cụm giới từ", meaning: "nhân sinh nhật" } ], grammarType:
"Câu chúc mừng cố định", }, { vietnamese: "Cảm ơn, bạn có đến dự tiệc của tôi
không?", german: "Danke, kommst du zu meiner Party?", tip: "🎉 'zu meiner Party
kommen' = đến dự tiệc của tôi", explanation: "'zu + Dativ' = đến. 'mein' biến
thành 'meiner' trong Dativ nữ tính.", structure: "Danke, kommst du zu meiner
Party?\n ↑ ↑ ↑ ↑\nCảm ơn V1 1 Cụm giới từ", analysis: [ { word: "Danke", type:
"Cảm ơn", meaning: "cảm ơn" }, { word: "kommst", type: "Động từ V1", meaning:
"đến" }, { word: "du", type: "Chủ ngữ", meaning: "bạn" }, { word: "zu meiner
Party", type: "Cụm giới từ", meaning: "đến tiệc của tôi" } ], grammarType: "Câu
mời với 'zu + Dativ'", }, { vietnamese: "Có, tất nhiên rồi.", german: "Ja,
natürlich.", tip: "✅ 'natürlich' = tất nhiên. Thể hiện sự đồng ý nhiệt tình",
explanation: "'natürlich' = tự nhiên/đương nhiên. Cách đồng ý mạnh mẽ và tích
cực.", structure: "Ja, natürlich.\n ↑ ↑\nThán Bổ nghĩa", analysis: [ { word:
"Ja", type: "Thán từ", meaning: "có" }, { word: "natürlich", type: "Bổ nghĩa",
meaning: "tất nhiên" } ], grammarType: "Câu đồng ý ngắn gọn", }, { vietnamese:
"Bạn tổ chức hôm nay, thứ Sáu à?", german: "Feierst du heute am Freitag?", tip:
"📅 'feiern' = tổ chức tiệc. 'am Freitag' = vào thứ Sáu", explanation: "'feiern'
= ăn mừng/tổ chức. 'am + ngày trong tuần' = vào ngày nào đó.", structure:
"Feierst du heute am Freitag?\n ↑ ↑ ↑ ↑\n V1 1 Te Cụm giới từ", analysis: [ {
word: "Feierst", type: "Động từ V1", meaning: "tổ chức" }, { word: "du", type:
"Chủ ngữ", meaning: "bạn" }, { word: "heute", type: "Te (thời gian)", meaning:
"hôm nay" }, { word: "am Freitag", type: "Cụm giới từ", meaning: "vào thứ Sáu" }
], grammarType: "Câu hỏi về thời gian tổ chức", }, { vietnamese: "Không, thà là
ngày mai, thứ Bảy.", german: "Nein, lieber morgen, am Samstag.", tip: "📆 Đáp án
đúng - chọn thứ Bảy thay vì thứ Sáu", explanation: "'lieber' = thích hơn/thà là.
'morgen' = ngày mai. Thể hiện sự điều chỉnh kế hoạch.", structure: "Nein, lieber
morgen, am Samstag\n ↑ ↑ ↑ ↑\nThán Bổ nghĩa Te Cụm giới từ", analysis: [ { word:
"Nein", type: "Thán từ", meaning: "không" }, { word: "lieber", type: "Bổ nghĩa",
meaning: "thà là" }, { word: "morgen", type: "Te (thời gian)", meaning: "ngày
mai" }, { word: "am Samstag", type: "Cụm giới từ", meaning: "vào thứ Bảy" } ],
grammarType: "Câu đề xuất thay đổi với 'lieber'", }, { vietnamese: "Như vậy tốt
hơn.", german: "Das ist besser.", tip: "👍 'besser' = tốt hơn. Thể hiện sự đồng
tình", explanation: "'besser' là so sánh hơn của 'gut'. Thể hiện sự đồng ý với
đề xuất.", structure: "Das ist besser\n ↑ ↑ ↑\n 1 V2 Tính từ so sánh", analysis:
[ { word: "Das", type: "Chủ ngữ", meaning: "điều đó" }, { word: "ist", type:
"Động từ V2", meaning: "là" }, { word: "besser", type: "Tính từ so sánh",
meaning: "tốt hơn" } ], grammarType: "Câu với tính từ so sánh", }, { vietnamese:
"Và Chủ nhật chúng ta đều có thể ngủ lâu.", german: "Und am Sonntag können wir
alle lange schlafen.", tip: "😴 'lange schlafen' = ngủ lâu/ngủ nướng",
explanation: "'alle' = tất cả mọi người. 'lange' = lâu. Lý do tại sao thứ Bảy
tốt hơn thứ Sáu.", structure: "Und am Sonntag können wir alle lange schlafen\n ↑
↑ ↑ ↑ ↑ ↑ ↑\nLiên từ Te V2 1 Bổ nghĩa Bổ nghĩa Động từ ng.mẫu", analysis: [ {
word: "Und", type: "Liên từ", meaning: "và" }, { word: "am Sonntag", type: "Te
(thời gian)", meaning: "vào Chủ nhật" }, { word: "können", type: "Động từ V2",
meaning: "có thể" }, { word: "wir", type: "Chủ ngữ", meaning: "chúng ta" }, {
word: "alle", type: "Bổ nghĩa", meaning: "tất cả" }, { word: "lange", type: "Bổ
nghĩa", meaning: "lâu" }, { word: "schlafen", type: "Động từ nguyên mẫu",
meaning: "ngủ" } ], grammarType: "Câu với động từ khiếm khuyết 'können'", }, {
vietnamese: "Bạn đến lúc khoảng 8 giờ tối nhé?", german: "Kommst du so ab 20
Uhr?", tip: "🕗 'so ab' = khoảng/từ. '20 Uhr' = 8 giờ tối (hệ 24h)",
explanation: "'so ab' = khoảng chừng từ. Tiếng Đức dùng hệ 24 giờ: 20 Uhr = 8
giờ tối.", structure: "Kommst du so ab 20 Uhr?\n ↑ ↑ ↑ ↑\n V1 1 Bổ nghĩa Te",
analysis: [ { word: "Kommst", type: "Động từ V1", meaning: "đến" }, { word:
"du", type: "Chủ ngữ", meaning: "bạn" }, { word: "so", type: "Bổ nghĩa",
meaning: "khoảng" }, { word: "ab 20 Uhr", type: "Te (thời gian)", meaning: "từ 8
giờ tối" } ], grammarType: "Câu hỏi về thời gian không chính xác", }, {
vietnamese: "Có, rõ ràng rồi, tôi sẽ đến.", german: "Ja, klar, ich komme.", tip:
"✅ 'klar' = rõ ràng/chắc chắn. Xác nhận tham gia", explanation: "'klar' = rõ
ràng/dĩ nhiên. Xác nhận mạnh mẽ việc tham dự tiệc.", structure: "Ja, klar, ich
komme\n ↑ ↑ ↑ ↑\nThán Bổ nghĩa 1 V2", analysis: [ { word: "Ja", type: "Thán từ",
meaning: "có" }, { word: "klar", type: "Bổ nghĩa", meaning: "rõ ràng" }, { word:
"ich", type: "Chủ ngữ", meaning: "tôi" }, { word: "komme", type: "Động từ V2",
meaning: "đến" } ], grammarType: "Câu xác nhận với 'klar'", }, ],<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Luyện tập Modelltest 3 Teil 1 - Tiếng Đức</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 1000px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      .header {
        background: linear-gradient(135deg, #ff6b6b, #ffd93d);
        color: white;
        padding: 30px;
        text-align: center;
      }

      .header h1 {
        font-size: 2.5em;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .header p {
        font-size: 1.2em;
        opacity: 0.9;
      }

      .section-info {
        background: rgba(255, 255, 255, 0.2);
        border-radius: 15px;
        padding: 20px;
        margin: 20px 0;
        backdrop-filter: blur(10px);
        border: 2px solid rgba(255, 255, 255, 0.3);
        text-align: center;
      }

      .section-info h3 {
        margin-bottom: 15px;
        font-size: 1.5em;
      }

      .content {
        padding: 30px;
      }

      .practice-card {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        border-radius: 20px;
        padding: 40px;
        margin: 20px 0;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        text-align: center;
      }

      .stats-row {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr 1fr;
        gap: 15px;
        margin: 20px 0;
      }

      .stat-box {
        background: rgba(255, 255, 255, 0.2);
        border-radius: 15px;
        padding: 15px;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.3);
        text-align: center;
      }

      .stat-number {
        font-size: 1.8em;
        font-weight: 900;
        margin-bottom: 5px;
      }

      .stat-label {
        font-size: 0.9em;
        opacity: 0.9;
      }

      .timer-warning {
        color: #ff6b6b !important;
        animation: pulse 1s infinite;
      }

      @keyframes pulse {
        0% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
        100% {
          opacity: 1;
        }
      }

      .section-counter {
        font-size: 1.3em;
        margin-bottom: 15px;
        font-weight: 600;
        padding: 10px 20px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 25px;
        display: inline-block;
      }

      .sentence-counter {
        font-size: 1.5em;
        margin-bottom: 20px;
        font-weight: 600;
      }

      .vietnamese-sentence {
        font-size: 2em;
        margin: 30px 0;
        padding: 20px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 15px;
        backdrop-filter: blur(10px);
        border: 2px solid rgba(255, 255, 255, 0.3);
        line-height: 1.4;
      }

      .controls {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin: 30px 0;
        flex-wrap: wrap;
      }

      .btn {
        background: linear-gradient(135deg, #ff6b6b, #ffd93d);
        color: white;
        border: none;
        padding: 15px 25px;
        border-radius: 25px;
        font-size: 1.1em;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        min-width: 120px;
      }

      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
      }

      .btn:active {
        transform: translateY(0);
      }

      .btn-secondary {
        background: linear-gradient(135deg, #28a745, #20c997);
      }

      .btn-correct {
        background: linear-gradient(135deg, #28a745, #20c997);
      }

      .btn-incorrect {
        background: linear-gradient(135deg, #dc3545, #ff6b6b);
      }

      .progress-bar {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 10px;
        overflow: hidden;
        margin: 20px 0;
        height: 20px;
      }

      .progress-fill {
        background: linear-gradient(135deg, #28a745, #20c997);
        height: 100%;
        transition: width 0.5s ease;
        border-radius: 10px;
      }

      .instructions {
        background: rgba(255, 255, 255, 0.2);
        border-radius: 15px;
        padding: 25px;
        margin: 20px 0;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.3);
      }

      .instructions h3 {
        margin-bottom: 15px;
        font-size: 1.5em;
      }

      .instructions ul {
        list-style: none;
        padding: 0;
      }

      .instructions li {
        margin: 10px 0;
        padding-left: 25px;
        position: relative;
      }

      .instructions li::before {
        content: "✓";
        position: absolute;
        left: 0;
        color: #28a745;
        font-weight: bold;
        font-size: 1.2em;
      }

      .answer-section {
        background: rgba(255, 255, 255, 0.9);
        color: #333;
        border-radius: 15px;
        padding: 25px;
        margin: 20px 0;
        display: none;
      }

      .answer-section.show {
        display: block;
        animation: fadeIn 0.5s ease;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .german-answer {
        font-size: 1.5em;
        color: #007bff;
        font-weight: 600;
        margin-bottom: 15px;
      }

      .grammar-tip {
        font-size: 1em;
        color: #6c757d;
        line-height: 1.5;
        margin-bottom: 10px;
      }

      .case-explanation {
        background: #e3f2fd;
        border-left: 4px solid #2196f3;
        padding: 15px;
        margin-top: 15px;
        border-radius: 8px;
        font-size: 0.95em;
        color: #1565c0;
      }

      .completion-screen {
        text-align: center;
        display: none;
      }

      .completion-screen.show {
        display: block;
        animation: fadeIn 0.5s ease;
      }

      .completion-emoji {
        font-size: 5em;
        margin: 20px 0;
      }

      .result-success {
        color: #28a745;
      }

      .result-failure {
        color: #dc3545;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 20px;
        margin: 30px 0;
      }

      .stat-item {
        background: rgba(255, 255, 255, 0.2);
        border-radius: 15px;
        padding: 20px;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.3);
      }

      .section-selector {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        margin: 30px 0;
      }

      .section-card {
        background: rgba(255, 255, 255, 0.2);
        border-radius: 15px;
        padding: 25px;
        backdrop-filter: blur(10px);
        border: 2px solid rgba(255, 255, 255, 0.3);
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: center;
      }

      .section-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
      }

      .section-card h4 {
        font-size: 1.5em;
        margin-bottom: 10px;
        color: #ff6b6b;
      }

      .section-card p {
        margin: 5px 0;
        opacity: 0.9;
      }

      .beispiel-theme {
        background: linear-gradient(135deg, #a8edea, #fed6e3);
      }
      .restaurant-theme {
        background: linear-gradient(135deg, #ffecd2, #fcb69f);
      }
      .school-theme {
        background: linear-gradient(135deg, #d299c2, #fef9d7);
      }
      .evening-theme {
        background: linear-gradient(135deg, #667eea, #764ba2);
      }
      .shopping-theme {
        background: linear-gradient(135deg, #ff9a9e, #fecfef);
      }
      .course-theme {
        background: linear-gradient(135deg, #a8edea, #fed6e3);
      }
      .party-theme {
        background: linear-gradient(135deg, #ffecd2, #fcb69f);
      }

      @media (max-width: 768px) {
        .header h1 {
          font-size: 2em;
        }
        .vietnamese-sentence {
          font-size: 1.5em;
        }
        .controls {
          flex-direction: column;
          align-items: center;
        }
        .btn {
          width: 80%;
          max-width: 300px;
        }
        .stats-row {
          grid-template-columns: 1fr 1fr;
          gap: 10px;
        }
        .section-selector {
          grid-template-columns: 1fr;
          gap: 15px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>🎯 Luyện tập Modelltest 3 Teil 1</h1>
        <p>53 câu hội thoại thực tế - Tiếng Đức cơ bản</p>
        <div class="section-info">
          <h3>📚 Cấu trúc bài test chuẩn</h3>
          <p>
            <strong>Ví dụ:</strong> Kỳ nghỉ (8 câu) |
            <strong>Dialog 1:</strong> Nhà hàng (8 câu) |
            <strong>Dialog 2:</strong> Trường học (9 câu)<br />
            <strong>Dialog 3:</strong> Kế hoạch tối (7 câu) |
            <strong>Dialog 4:</strong> Mua rau (7 câu) |
            <strong>Dialog 5:</strong> Khóa học (5 câu) |
            <strong>Dialog 6:</strong> Tiệc sinh nhật (9 câu)
          </p>
        </div>
      </div>

      <div class="content">
        <!-- Section Selection Screen -->
        <div class="practice-card" id="selection-screen">
          <div class="instructions">
            <h3>📖 Hướng dẫn luyện tập</h3>
            <ul>
              <li>53 câu từ bài test Modelltest 3 Teil 1 chuẩn</li>
              <li>Thời gian: 3 phút cho mỗi phần</li>
              <li>Đọc câu tiếng Việt → Nghĩ câu tiếng Đức → Đánh giá</li>
              <li>Xem đáp án chính xác và giải thích ngữ pháp</li>
              <li>Luyện tập các tình huống hội thoại thực tế</li>
              <li>
                Phím tắt: Space = Phát âm, 1 = Đúng, 2 = Sai, Enter = Tiếp theo
              </li>
            </ul>
          </div>

          <div class="section-selector">
            <div class="section-card" onclick="startSection(0)">
              <h4>🏖️ Ví dụ</h4>
              <p><strong>Kỳ nghỉ và du lịch</strong></p>
              <p>8 câu - 3 phút</p>
              <p>Chủ đề: Vacation, travel</p>
            </div>
            <div class="section-card" onclick="startSection(1)">
              <h4>🍽️ Dialog 1</h4>
              <p><strong>Nhà hàng</strong></p>
              <p>8 câu - 3 phút</p>
              <p>Chủ đề: Restaurant, food</p>
            </div>
            <div class="section-card" onclick="startSection(2)">
              <h4>🏫 Dialog 2</h4>
              <p><strong>Trường học</strong></p>
              <p>9 câu - 3 phút</p>
              <p>Chủ đề: School, children</p>
            </div>
            <div class="section-card" onclick="startSection(3)">
              <h4>🌃 Dialog 3</h4>
              <p><strong>Kế hoạch tối</strong></p>
              <p>7 câu - 3 phút</p>
              <p>Chủ đề: Evening plans</p>
            </div>
            <div class="section-card" onclick="startSection(4)">
              <h4>🛒 Dialog 4</h4>
              <p><strong>Mua rau quả</strong></p>
              <p>7 câu - 3 phút</p>
              <p>Chủ đề: Shopping</p>
            </div>
            <div class="section-card" onclick="startSection(5)">
              <h4>📚 Dialog 5</h4>
              <p><strong>Khóa học</strong></p>
              <p>5 câu - 3 phút</p>
              <p>Chủ đề: Course registration</p>
            </div>
            <div class="section-card" onclick="startSection(6)">
              <h4>🎉 Dialog 6</h4>
              <p><strong>Tiệc sinh nhật</strong></p>
              <p>9 câu - 3 phút</p>
              <p>Chủ đề: Birthday party</p>
            </div>
          </div>

          <div class="controls">
            <button class="btn" onclick="startAllSections()">
              🚀 Làm tất cả 7 phần (21 phút)
            </button>
            <button class="btn btn-secondary" onclick="showPreview()">
              👀 Xem trước 53 câu
            </button>
          </div>
        </div>

        <!-- Practice Screen -->
        <div class="practice-card" id="practice-section" style="display: none">
          <div class="section-counter" id="section-info">
            Ví dụ: Kỳ nghỉ và du lịch
          </div>

          <div class="stats-row">
            <div class="stat-box">
              <div class="stat-number" id="timer">03:00</div>
              <div class="stat-label">⏰ Thời gian</div>
            </div>
            <div class="stat-box">
              <div class="stat-number" id="correct-count">0</div>
              <div class="stat-label">✅ Câu đúng</div>
            </div>
            <div class="stat-box">
              <div class="stat-number" id="total-answered">0</div>
              <div class="stat-label">📝 Đã làm</div>
            </div>
            <div class="stat-box">
              <div class="stat-number" id="current-section">1/7</div>
              <div class="stat-label">📚 Phần hiện tại</div>
            </div>
          </div>

          <div class="sentence-counter" id="counter">Câu 1 / 8</div>

          <div class="progress-bar">
            <div class="progress-fill" id="progress" style="width: 12.5%"></div>
          </div>

          <div class="vietnamese-sentence" id="vietnamese-text">
            Nhấn "Bắt đầu" để bắt đầu luyện tập
          </div>

          <div class="controls">
            <button
              class="btn btn-secondary"
              id="speak-btn"
              onclick="speakVietnamese()"
              style="display: none"
            >
              🔊 Phát âm
            </button>
            <button
              class="btn btn-correct"
              id="correct-btn"
              onclick="markAnswer(true)"
              style="display: none"
            >
              ✅ Hiểu & Đúng
            </button>
            <button
              class="btn btn-incorrect"
              id="incorrect-btn"
              onclick="markAnswer(false)"
              style="display: none"
            >
              ❌ Chưa hiểu
            </button>
            <button
              class="btn"
              id="next-btn"
              onclick="nextSentence()"
              style="display: none"
            >
              ➡️ Câu tiếp theo
            </button>
          </div>

          <div class="answer-section" id="answer-section">
            <div class="german-answer" id="german-answer"></div>
            <div class="grammar-tip" id="grammar-tip"></div>
            <div class="case-explanation" id="case-explanation"></div>
          </div>
        </div>

        <!-- Completion Screen -->
        <div class="practice-card completion-screen" id="completion-screen">
          <div class="completion-emoji" id="result-emoji">🎉</div>
          <h2 id="result-title">Hoàn thành!</h2>
          <p style="font-size: 1.3em; margin: 20px 0" id="result-message">
            Kết quả sẽ hiển thị ở đây
          </p>

          <div class="stats-grid">
            <div class="stat-item">
              <div class="stat-number" id="final-correct">0</div>
              <div class="stat-label">Tổng câu đúng</div>
            </div>
            <div class="stat-item">
              <div class="stat-number" id="final-answered">0</div>
              <div class="stat-label">Tổng đã làm</div>
            </div>
            <div class="stat-item">
              <div class="stat-number" id="final-accuracy">0%</div>
              <div class="stat-label">Độ chính xác</div>
            </div>
            <div class="stat-item">
              <div class="stat-number" id="final-time">00:00</div>
              <div class="stat-label">Thời gian</div>
            </div>
          </div>

          <div class="controls">
            <button class="btn" onclick="resetPractice()">🔄 Làm lại</button>
            <button class="btn btn-secondary" onclick="shuffleAndRestart()">
              🎲 Trộn câu & Làm lại
            </button>
          </div>
        </div>

        <!-- Preview Screen -->
        <div class="practice-card completion-screen" id="preview-screen">
          <div class="completion-emoji">📚</div>
          <h2 style="color: #667eea; margin-bottom: 30px">Xem trước 53 câu</h2>

          <div
            style="
              max-height: 500px;
              overflow-y: auto;
              margin: 20px 0;
              padding: 20px;
              background: rgba(255, 255, 255, 0.1);
              border-radius: 15px;
            "
          >
            <div id="preview-content"></div>
          </div>

          <div class="controls">
            <button class="btn" onclick="hidePreview()">⬅️ Quay lại</button>
            <button class="btn btn-secondary" onclick="hidePreviewAndStart()">
              🚀 Bắt đầu luyện tập
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // 53 câu từ Modelltest 3 Teil 1 với bản dịch tiếng Việt tự nhiên
      const practiceData = [
        // VÍ DỤ: Kỳ nghỉ và du lịch (8 câu)
        [
          {
            vietnamese: "Các bạn thật may mắn!",
            german: "Habt ihr ein Glück!",
            tip: "🍀 Cách chúc mừng ai đó may mắn",
            explanation:
              "'Glück haben' = có may mắn. Câu cảm thán thể hiện sự ngưỡng mộ.",
          },
          {
            vietnamese:
              "Thời tiết tuyệt vời và ngày mai các bạn sẽ đi du lịch.",
            german: "Tolles Wetter und morgen fahrt ihr weg.",
            tip: "☀️ 'wegfahren' = đi xa/du lịch",
            explanation:
              "'Toll' = tuyệt vời. 'wegfahren' là động từ tách có nghĩa là đi du lịch.",
          },
          {
            vietnamese: "Vâng, tôi đã rất mong chờ kỳ nghỉ này.",
            german: "Ja, ich freue mich schon so auf den Urlaub.",
            tip: "😊 'sich freuen auf' = mong chờ điều gì đó",
            explanation:
              "'schon' ở đây có nghĩa là 'đã'. Động từ phản thân 'sich freuen auf' + Akkusativ.",
          },
          {
            vietnamese: "Các bạn lại bay đến Berlin hay lần này đi ô tô?",
            german:
              "Fliegt ihr wieder nach Berlin oder nehmt ihr dieses Mal das Auto?",
            tip: "✈️🚗 So sánh hai phương tiện di chuyển",
            explanation:
              "'wieder' = lại/một lần nữa. 'dieses Mal' = lần này. Câu hỏi lựa chọn với 'oder'.",
          },
          {
            vietnamese: "Không, năm nay chúng tôi đi tàu.",
            german: "Nein, dieses Jahr nehmen wir den Zug.",
            tip: "🚂 Đáp án đúng trong test - chọn tàu",
            explanation:
              "'nehmen' = lấy/chọn phương tiện. 'der Zug' = tàu hỏa (Akkusativ: den Zug).",
          },
          {
            vietnamese: "Các chuyến bay đã quá đắt.",
            german: "Die Flüge waren zu teuer.",
            tip: "💸 Lý do không chọn máy bay",
            explanation:
              "'Flug' = chuyến bay. 'zu teuer' = quá đắt. Thì quá khứ của 'sein': waren.",
          },
          {
            vietnamese: "Vậy thì chúc kỳ nghỉ vui vẻ!",
            german: "Dann schönen Urlaub!",
            tip: "🏖️ Lời chúc kỳ nghỉ",
            explanation:
              "Câu chúc rút gọn. Đầy đủ: 'Ich wünsche euch einen schönen Urlaub!'",
          },
          {
            vietnamese: "Cảm ơn!",
            german: "Danke!",
            tip: "🙏 Cảm ơn ngắn gọn",
            explanation: "Cách cảm ơn đơn giản nhất trong tiếng Đức.",
          },
        ],

        // DIALOG 1: Nhà hàng (8 câu)
        [
          {
            vietnamese: "Chào anh! Anh đã chọn món chưa?",
            german: "Guten Tag! Haben Sie schon gewählt?",
            tip: "🍽️ Câu hỏi tiêu chuẩn của nhân viên phục vụ",
            explanation:
              "'wählen' = chọn. Perfekt: haben + gewählt. Câu hỏi lịch sự của nhân viên.",
          },
          {
            vietnamese: "Hmm, anh có thể tư vấn gì không?",
            german: "Hm, was können Sie empfehlen?",
            tip: "🤔 Hỏi tư vấn món ăn",
            explanation:
              "'empfehlen' = khuyên/tư vấn. Cách hỏi lịch sự khi chưa biết chọn gì.",
          },
          {
            vietnamese: "Anh có cá tươi không?",
            german: "Haben Sie frischen Fisch?",
            tip: "🐟 Hỏi về món cá tươi",
            explanation:
              "'frisch' = tươi. Tính từ đuôi -en sau 'haben Sie' (Akkusativ).",
          },
          {
            vietnamese: "Không, hôm nay rất tiếc là không có.",
            german: "Nein, heute leider nicht.",
            tip: "😞 Từ chối lịch sự với 'leider'",
            explanation:
              "'leider' = rất tiếc/không may. Cách từ chối lịch sự trong dịch vụ.",
          },
          {
            vietnamese: "Nhưng chúng tôi có súp cá rất ngon.",
            german: "Aber wir haben eine sehr gute Fischsuppe.",
            tip: "🍲 Đề xuất thay thế",
            explanation:
              "'Fischsuppe' = súp cá. Từ ghép: Fisch + Suppe. Cách đề xuất thay thế.",
          },
          {
            vietnamese: "Và có lẽ kèm theo một món salad?",
            german: "Und dazu vielleicht einen Salat?",
            tip: "🥗 Đề xuất thêm món kèm",
            explanation:
              "'dazu' = kèm theo. 'vielleicht' = có lẽ. Akkusativ: einen Salat.",
          },
          {
            vietnamese: "Hmm, tôi lấy súp cá, nhưng không lấy salad.",
            german:
              "Hm, die Fischsuppe nehme ich gern, aber bitte keinen Salat.",
            tip: "✅❌ Đáp án đúng - nhận này, từ chối kia",
            explanation:
              "'gern nehmen' = sẵn lòng lấy. 'bitte keinen' = xin đừng (Akkusativ phủ định).",
          },
          {
            vietnamese: "Và để uống có lẽ một ly rượu vang trắng?",
            german: "Und zu trinken vielleicht ein Glas Weißwein?",
            tip: "🍷 Đề xuất đồ uống",
            explanation:
              "'zu trinken' = để uống. 'Weißwein' = rượu vang trắng. Từ ghép: weiß + Wein.",
          },
        ],

        // DIALOG 2: Trường học (9 câu)
        [
          {
            vietnamese: "Chào Sonja! Nói đi,",
            german: "Hallo Sonja! Sag mal,",
            tip: "👋 Lời chào thân thiện",
            explanation:
              "'Sag mal' = nói đi/cho tôi hỏi. Cách mở đầu câu hỏi thân thiện.",
          },
          {
            vietnamese: "con gái bạn bao nhiêu tuổi?",
            german: "wie alt ist deine Tochter?",
            tip: "👶 Hỏi tuổi của trẻ em",
            explanation:
              "'Wie alt...?' = bao nhiêu tuổi? 'Tochter' = con gái (danh từ nữ tính).",
          },
          {
            vietnamese: "Anja bây giờ 7 tuổi.",
            german: "Anja ist jetzt 7 Jahre alt.",
            tip: "🎂 Trả lời về tuổi",
            explanation:
              "'Jahre alt' = tuổi (dành cho trẻ em và người lớn). 'jetzt' = bây giờ.",
          },
          {
            vietnamese: "7 tuổi à?",
            german: "7 Jahre?",
            tip: "😲 Câu hỏi ngạc nhiên",
            explanation:
              "Câu hỏi ngắn thể hiện sự ngạc nhiên, xác nhận thông tin vừa nghe.",
          },
          {
            vietnamese: "Vậy cháu đã đi học rồi.",
            german: "Dann geht sie ja schon in die Schule.",
            tip: "🏫 Suy luận về việc học",
            explanation:
              "'Dann' = vậy thì. 'ja' ở đây = đã/rồi. 'in die Schule gehen' = đi học.",
          },
          {
            vietnamese: "Và cháu học lớp nào?",
            german: "Und in welche Klasse geht sie?",
            tip: "📚 Hỏi về lớp học",
            explanation:
              "'welche Klasse' = lớp nào. 'in + Akkusativ' sau động từ chỉ chuyển động.",
          },
          {
            vietnamese: "Lớp 1 hay lớp 2?",
            german: "In die 1. oder die 2.?",
            tip: "🔢 Câu hỏi lựa chọn",
            explanation: "Câu hỏi rút gọn. Số thứ tự: 1. = erste, 2. = zweite.",
          },
          {
            vietnamese: "Anja bây giờ học lớp 2.",
            german: "Anja ist jetzt in der 2. Klasse.",
            tip: "✏️ Đáp án đúng - lớp 2",
            explanation:
              "'in der Klasse' = ở/trong lớp (Dativ vì chỉ vị trí). 'jetzt' nhấn mạnh hiện tại.",
          },
          {
            vietnamese: "Và cháu rất thích đi học.",
            german: "Und sie geht sehr gern in die Schule.",
            tip: "😊 Thích thú việc học",
            explanation:
              "'sehr gern' = rất thích. 'gern' + động từ = thích làm việc đó.",
          },
        ],

        // DIALOG 3: Kế hoạch tối (7 câu)
        [
          {
            vietnamese: "Nói đi Eva, tối nay bạn làm gì?",
            german: "Sag mal Eva, was machst du heute Abend?",
            tip: "🌆 Hỏi kế hoạch buổi tối",
            explanation:
              "'heute Abend' = tối nay. 'was machen' = làm gì. Câu hỏi về kế hoạch.",
          },
          {
            vietnamese: "Chúng ta có muốn xem phim không?",
            german: "Wollen wir einen Film sehen?",
            tip: "🎬 Đề xuất xem phim",
            explanation:
              "'wollen' = muốn. 'einen Film sehen' = xem phim. Câu đề xuất hoạt động.",
          },
          {
            vietnamese: "Không, tôi phải làm việc, tôi phải học cho kỳ thi.",
            german: "Nein, ich muss arbeiten, ich muss für die Prüfung lernen.",
            tip: "📖 Đáp án đúng - phải học bài",
            explanation:
              "'müssen' = phải. 'für die Prüfung lernen' = học cho kỳ thi. Lý do từ chối.",
          },
          {
            vietnamese: "Và chúng ta có muốn đi uống gì đó sau đó không?",
            german: "Und wollen wir später etwas trinken gehen?",
            tip: "🍻 Đề xuất thay thế",
            explanation:
              "'später' = sau đó. 'trinken gehen' = đi uống (động từ kép).",
          },
          {
            vietnamese: "Có một quán cà phê mới ở góc phố này.",
            german: "Es gibt hier an der Ecke ein neues Café.",
            tip: "☕ Thông tin về quán cà phê",
            explanation:
              "'es gibt' = có. 'an der Ecke' = ở góc. Giới thiệu địa điểm mới.",
          },
          {
            vietnamese: "Không, tôi xin lỗi, thà là Chủ nhật.",
            german: "Nein, tut mir leid, lieber am Sonntag.",
            tip: "😔 Từ chối và đề xuất thời gian khác",
            explanation:
              "'tut mir leid' = tôi xin lỗi. 'lieber' = thà là. 'am Sonntag' = vào Chủ nhật.",
          },
          {
            vietnamese: "Lúc đó tôi có thời gian.",
            german: "Dann habe ich Zeit.",
            tip: "⏰ Giải thích lý do",
            explanation:
              "'Zeit haben' = có thời gian. 'dann' = lúc đó. Giải thích tại sao Chủ nhật tốt hơn.",
          },
        ],

        // DIALOG 4: Mua rau quả (7 câu)
        [
          {
            vietnamese: "Chào anh! Cho tôi nửa kg cà chua và 1 kg khoai tây.",
            german:
              "Guten Tag! Ein Pfund Tomaten bitte und ein Kilo Kartoffeln.",
            tip: "🍅🥔 Đặt hàng tại chợ",
            explanation:
              "'Ein Pfund' = nửa kg. 'Tomaten/Kartoffeln' = cà chua/khoai tây (số nhiều).",
          },
          {
            vietnamese:
              "Nửa kg cà chua 1 Euro 15, và 1 kg khoai tây 1 Euro 50.",
            german:
              "Ein Pfund Tomaten 1,15 Euro und ein Kilo Kartoffeln 1,50 Euro.",
            tip: "💰 Đáp án đúng - báo giá",
            explanation:
              "Cách báo giá trong tiếng Đức: số lượng + hàng hóa + giá tiền.",
          },
          {
            vietnamese: "Của anh đây.",
            german: "Bitte schön.",
            tip: "🤝 Đáp án đúng - đưa hàng",
            explanation:
              "'Bitte schön' khi đưa hàng = của anh/chị đây. Cách lịch sự trong giao dịch.",
          },
          {
            vietnamese: "Anh còn muốn gì nữa không?",
            german: "Haben Sie noch einen Wunsch?",
            tip: "❓ Hỏi có cần gì thêm",
            explanation:
              "'einen Wunsch haben' = có mong muốn gì. Câu hỏi lịch sự của người bán.",
          },
          {
            vietnamese: "Không, cảm ơn, thế là đủ.",
            german: "Nein, danke, das ist alles.",
            tip: "🛑 Kết thúc mua sắm",
            explanation:
              "'das ist alles' = thế là hết/đủ. Cách kết thúc giao dịch.",
          },
          {
            vietnamese: "Tổng cộng là 2 Euro 65.",
            german: "Das macht dann 2,65 Euro zusammen.",
            tip: "🧮 Tính tổng tiền",
            explanation:
              "'das macht... zusammen' = tổng cộng là. Cách thông báo tổng tiền.",
          },
          {
            vietnamese: "Của anh đây.",
            german: "Bitte schön.",
            tip: "💶 Đáp án đúng - khi nhận tiền",
            explanation:
              "'Bitte schön' lần thứ hai khi nhận tiền từ khách. Cách lịch sự khi giao dịch.",
          },
        ],

        // DIALOG 5: Khóa học (5 câu)
        [
          {
            vietnamese:
              "Chào anh! Tôi muốn đăng ký khóa học tiếng Đức tháng Giêng.",
            german:
              "Guten Tag! Ich möchte mich für den Deutschkurs im Januar anmelden.",
            tip: "📚 Đăng ký khóa học",
            explanation:
              "'sich anmelden für' = đăng ký cho. 'im Januar' = trong tháng Giêng.",
          },
          {
            vietnamese: "Anh thật may mắn, còn một chỗ trống.",
            german: "Sie haben Glück, ein Platz ist noch frei.",
            tip: "🍀 Tin tốt về chỗ học",
            explanation:
              "'Glück haben' = may mắn. 'frei sein' = còn trống. Tin vui cho học viên.",
          },
          {
            vietnamese: "Tuyệt vời.",
            german: "Super.",
            tip: "😃 Phản ứng vui mừng",
            explanation:
              "'Super' = tuyệt vời. Từ thông dụng thể hiện sự hài lòng.",
          },
          {
            vietnamese:
              "Và khóa học diễn ra những ngày nào và kéo dài bao lâu?",
            german: "Und an welchen Tagen ist der Kurs und wie lange geht er?",
            tip: "📅 Hỏi về lịch học",
            explanation:
              "'an welchen Tagen' = những ngày nào. 'wie lange' = bao lâu. Hỏi chi tiết.",
          },
          {
            vietnamese:
              "Khóa học diễn ra hàng ngày, từ thứ Hai đến thứ Sáu, từ 9 đến 12 giờ, từ 21 tháng Giêng đến 18 tháng Hai, tức là 4 tuần.",
            german:
              "Der Kurs ist jeden Tag, Montag bis Freitag von 9 bis 12 Uhr vom 21. Januar bis zum 18. Februar, also 4 Wochen.",
            tip: "📋 Đáp án đúng - thông tin chi tiết khóa học",
            explanation:
              "'jeden Tag' = hàng ngày. 'von...bis' = từ...đến. 'also' = tức là. Thông tin đầy đủ về lịch học.",
          },
        ],

        // DIALOG 6: Tiệc sinh nhật (9 câu)
        [
          {
            vietnamese: "Chào Lola! Chúc mừng sinh nhật!",
            german: "Hi Lola! Alles Gute zum Geburtstag.",
            tip: "🎂 Lời chúc sinh nhật",
            explanation:
              "'Alles Gute zum Geburtstag' = chúc mừng sinh nhật. Câu chúc tiêu chuẩn.",
          },
          {
            vietnamese: "Cảm ơn, bạn có đến dự tiệc của tôi không?",
            german: "Danke, kommst du zu meiner Party?",
            tip: "🎉 Mời dự tiệc",
            explanation:
              "'zu meiner Party kommen' = đến dự tiệc của tôi. Lời mời thân thiện.",
          },
          {
            vietnamese: "Có, tất nhiên rồi.",
            german: "Ja, natürlich.",
            tip: "✅ Đồng ý tham gia",
            explanation: "'natürlich' = tất nhiên. Cách đồng ý nhiệt tình.",
          },
          {
            vietnamese: "Bạn tổ chức hôm nay, thứ Sáu à?",
            german: "Feierst du heute am Freitag?",
            tip: "📅 Hỏi ngày tổ chức",
            explanation: "'feiern' = tổ chức tiệc. 'am Freitag' = vào thứ Sáu.",
          },
          {
            vietnamese: "Không, thà là ngày mai, thứ Bảy.",
            german: "Nein, lieber morgen, am Samstag.",
            tip: "📆 Đáp án đúng - chọn thứ Bảy",
            explanation:
              "'lieber' = thà là/tốt hơn. 'morgen' = ngày mai. 'am Samstag' = vào thứ Bảy.",
          },
          {
            vietnamese: "Như vậy tốt hơn.",
            german: "Das ist besser.",
            tip: "👍 Đồng ý với lựa chọn",
            explanation:
              "'besser' = tốt hơn. Thể hiện sự đồng tình với quyết định.",
          },
          {
            vietnamese: "Và Chủ nhật chúng ta đều có thể ngủ lâu.",
            german: "Und am Sonntag können wir alle lange schlafen.",
            tip: "😴 Lý do chọn thứ Bảy",
            explanation:
              "'lange schlafen' = ngủ lâu/ngủ nướng. Lý do tại sao thứ Bảy tốt hơn.",
          },
          {
            vietnamese: "Bạn đến lúc khoảng 8 giờ tối nhé?",
            german: "Kommst du so ab 20 Uhr?",
            tip: "🕗 Hẹn giờ",
            explanation:
              "'so ab' = khoảng/từ. '20 Uhr' = 8 giờ tối (hệ 24h). Hẹn giờ không chính xác.",
          },
          {
            vietnamese: "Có, rõ ràng rồi, tôi sẽ đến.",
            german: "Ja, klar, ich komme.",
            tip: "✅ Xác nhận tham gia",
            explanation:
              "'klar' = rõ ràng/chắc chắn. Xác nhận chắc chắn sẽ đến dự tiệc.",
          },
        ],
      ];

      // App state
      let currentSectionIndex = 0;
      let currentQuestionIndex = 0;
      let isStarted = false;
      let startTime = null;
      let timerInterval = null;
      let correctCount = 0;
      let totalAnswered = 0;
      let timeLimit = 3 * 60; // 3 minutes per section
      let timeRemaining = timeLimit;
      let sectionCompleted = false;
      let isAllSections = false;
      let totalCorrectAllSections = 0;
      let totalAnsweredAllSections = 0;
      let allSectionsStartTime = null;

      const sectionNames = [
        "🏖️ Kỳ nghỉ và du lịch",
        "🍽️ Nhà hàng",
        "🏫 Trường học",
        "🌃 Kế hoạch tối",
        "🛒 Mua rau quả",
        "📚 Khóa học",
        "🎉 Tiệc sinh nhật",
      ];

      const sectionThemes = [
        "beispiel-theme",
        "restaurant-theme",
        "school-theme",
        "evening-theme",
        "shopping-theme",
        "course-theme",
        "party-theme",
      ];

      const sectionCounts = [8, 8, 9, 7, 7, 5, 9]; // Số câu trong mỗi phần

      // Initialize
      function init() {
        updateDisplay();
        initializeVoices();
      }

      // Initialize voices
      function initializeVoices() {
        if ("speechSynthesis" in window) {
          speechSynthesis.getVoices();
          setTimeout(() => {
            const voices = speechSynthesis.getVoices();
            const vietnameseVoice = voices.find(
              (voice) => voice.lang.includes("vi") || voice.lang.includes("VN")
            );
            if (!vietnameseVoice) {
              console.log("Không tìm thấy giọng tiếng Việt.");
            }
          }, 1000);
        }
      }

      // Start specific section
      function startSection(sectionIndex) {
        currentSectionIndex = sectionIndex;
        isAllSections = false;
        startPracticeSession();
      }

      // Start all sections
      function startAllSections() {
        currentSectionIndex = 0;
        isAllSections = true;
        totalCorrectAllSections = 0;
        totalAnsweredAllSections = 0;
        allSectionsStartTime = new Date();
        startPracticeSession();
      }

      // Start practice session
      function startPracticeSession() {
        isStarted = true;
        currentQuestionIndex = 0;
        correctCount = 0;
        totalAnswered = 0;
        timeRemaining = timeLimit;
        sectionCompleted = false;
        startTime = new Date();

        // Update theme
        const practiceCard = document.getElementById("practice-section");
        practiceCard.className = `practice-card ${sectionThemes[currentSectionIndex]}`;

        // Show practice screen
        document.getElementById("selection-screen").style.display = "none";
        document.getElementById("practice-section").style.display = "block";
        document.getElementById("speak-btn").style.display = "inline-block";
        document.getElementById("correct-btn").style.display = "inline-block";
        document.getElementById("incorrect-btn").style.display = "inline-block";

        // Update section info
        document.getElementById("section-info").textContent = `${sectionNames[
          currentSectionIndex
        ].substring(2)}`;
        document.getElementById("current-section").textContent = `${
          currentSectionIndex + 1
        }/7`;

        // Start timer and load first question
        startTimer();
        loadQuestion();
      }

      // Start timer
      function startTimer() {
        timerInterval = setInterval(() => {
          timeRemaining--;
          updateTimerDisplay();

          if (timeRemaining <= 0) {
            completeSection("time");
          }
        }, 1000);
      }

      // Update timer display
      function updateTimerDisplay() {
        const minutes = Math.floor(timeRemaining / 60);
        const seconds = timeRemaining % 60;
        const timeStr = `${minutes.toString().padStart(2, "0")}:${seconds
          .toString()
          .padStart(2, "0")}`;

        const timerElement = document.getElementById("timer");
        timerElement.textContent = timeStr;

        if (timeRemaining <= 30) {
          timerElement.classList.add("timer-warning");
        } else {
          timerElement.classList.remove("timer-warning");
        }
      }

      // Stop timer
      function stopTimer() {
        if (timerInterval) {
          clearInterval(timerInterval);
          timerInterval = null;
        }
      }

      // Load current question
      function loadQuestion() {
        if (currentQuestionIndex >= practiceData[currentSectionIndex].length) {
          completeSection("finished");
          return;
        }

        const current = practiceData[currentSectionIndex][currentQuestionIndex];
        const sectionCount = sectionCounts[currentSectionIndex];

        document.getElementById("vietnamese-text").textContent =
          current.vietnamese;
        document.getElementById("counter").textContent = `Câu ${
          currentQuestionIndex + 1
        } / ${sectionCount}`;

        // Update progress
        const progress = ((currentQuestionIndex + 1) / sectionCount) * 100;
        document.getElementById("progress").style.width = `${progress}%`;

        // Hide answer section and reset buttons
        document.getElementById("answer-section").classList.remove("show");
        document.getElementById("next-btn").style.display = "none";
        document.getElementById("correct-btn").style.display = "inline-block";
        document.getElementById("incorrect-btn").style.display = "inline-block";

        // Auto speak Vietnamese
        setTimeout(() => speakVietnamese(), 500);
      }

      // Speak Vietnamese text
      function speakVietnamese() {
        if ("speechSynthesis" in window) {
          const text =
            practiceData[currentSectionIndex][currentQuestionIndex].vietnamese;
          speechSynthesis.cancel();

          const utterance = new SpeechSynthesisUtterance(text);
          const voices = speechSynthesis.getVoices();
          const vietnameseVoice = voices.find(
            (voice) => voice.lang.includes("vi") || voice.lang.includes("VN")
          );

          if (vietnameseVoice) {
            utterance.voice = vietnameseVoice;
            utterance.lang = "vi-VN";
          } else {
            utterance.lang = "vi-VN";
          }

          utterance.rate = 0.7;
          utterance.pitch = 1.0;
          utterance.volume = 1.0;
          speechSynthesis.speak(utterance);

          const speakBtn = document.getElementById("speak-btn");
          speakBtn.style.background =
            "linear-gradient(135deg, #ffa726, #ff7043)";
          speakBtn.textContent = "🔊 Đang phát...";

          utterance.onend = function () {
            speakBtn.style.background =
              "linear-gradient(135deg, #28a745, #20c997)";
            speakBtn.textContent = "🔊 Phát âm";
          };
        }
      }

      // Mark answer
      function markAnswer(isCorrect) {
        totalAnswered++;
        if (isCorrect) {
          correctCount++;
        }

        // Update display
        document.getElementById("correct-count").textContent = correctCount;
        document.getElementById("total-answered").textContent = totalAnswered;

        // Show answer
        showAnswer();

        // Update buttons
        document.getElementById("correct-btn").style.display = "none";
        document.getElementById("incorrect-btn").style.display = "none";
        document.getElementById("next-btn").style.display = "inline-block";
      }

      // Show answer
      function showAnswer() {
        const current = practiceData[currentSectionIndex][currentQuestionIndex];
        document.getElementById("german-answer").textContent = current.german;
        document.getElementById("grammar-tip").textContent = current.tip;
        document.getElementById("case-explanation").textContent =
          current.explanation;
        document.getElementById("answer-section").classList.add("show");

        // Speak German answer
        speakGerman(current.german);
      }

      // Speak German text
      function speakGerman(text) {
        if ("speechSynthesis" in window) {
          speechSynthesis.cancel();
          const utterance = new SpeechSynthesisUtterance(text);
          utterance.lang = "de-DE";
          utterance.rate = 0.7;
          utterance.volume = 1.0;
          speechSynthesis.speak(utterance);
        }
      }

      // Next question
      function nextSentence() {
        currentQuestionIndex++;
        loadQuestion();
      }

      // Complete section
      function completeSection(reason) {
        if (sectionCompleted) return;
        sectionCompleted = true;
        stopTimer();

        // Add to total if doing all sections
        if (isAllSections) {
          totalCorrectAllSections += correctCount;
          totalAnsweredAllSections += totalAnswered;
        }

        // Check if continuing to next section
        if (isAllSections && currentSectionIndex < 6) {
          setTimeout(() => {
            currentSectionIndex++;
            startPracticeSession();
          }, 2000);

          // Show brief transition message
          document.getElementById(
            "vietnamese-text"
          ).textContent = `Hoàn thành phần ${
            currentSectionIndex + 1
          }! Chuyển sang ${sectionNames[currentSectionIndex + 1]}...`;
          return;
        }

        // Show final results
        showResults();
      }

      // Show results
      function showResults() {
        const totalTime = isAllSections
          ? Math.floor((new Date() - allSectionsStartTime) / 1000)
          : timeLimit - timeRemaining;

        const minutes = Math.floor(totalTime / 60);
        const seconds = totalTime % 60;
        const timeStr = `${minutes.toString().padStart(2, "0")}:${seconds
          .toString()
          .padStart(2, "0")}`;

        const finalCorrect = isAllSections
          ? totalCorrectAllSections
          : correctCount;
        const finalAnswered = isAllSections
          ? totalAnsweredAllSections
          : totalAnswered;
        const accuracy =
          finalAnswered > 0
            ? Math.round((finalCorrect / finalAnswered) * 100)
            : 0;

        const targetScore = isAllSections
          ? 42
          : Math.ceil(sectionCounts[currentSectionIndex] * 0.8); // 80% của tổng số câu
        const maxScore = isAllSections
          ? 53
          : sectionCounts[currentSectionIndex];

        // Update final stats
        document.getElementById("final-correct").textContent = finalCorrect;
        document.getElementById("final-answered").textContent = finalAnswered;
        document.getElementById("final-accuracy").textContent = `${accuracy}%`;
        document.getElementById("final-time").textContent = timeStr;

        // Determine result
        let resultEmoji, resultTitle, resultMessage, resultClass;
        if (finalCorrect >= targetScore) {
          resultEmoji = "🏆";
          resultTitle = "Xuất sắc!";
          resultMessage = `Bạn đạt ${finalCorrect}/${maxScore} câu đúng! Chúc mừng!`;
          resultClass = "result-success";
        } else {
          resultEmoji = "📚";
          resultTitle = "Cần luyện tập thêm!";
          resultMessage = `Bạn đạt ${finalCorrect}/${maxScore} câu đúng. Mục tiêu: ${targetScore} câu đúng.`;
          resultClass = "result-failure";
        }

        document.getElementById("result-emoji").textContent = resultEmoji;
        document.getElementById("result-title").textContent = resultTitle;
        document.getElementById("result-title").className = resultClass;
        document.getElementById("result-message").textContent = resultMessage;

        // Show completion screen
        document.getElementById("practice-section").style.display = "none";
        document.getElementById("completion-screen").classList.add("show");
      }

      // Show preview
      function showPreview() {
        const previewContent = document.getElementById("preview-content");
        let html = "";
        let globalIndex = 1;

        practiceData.forEach((section, sectionIndex) => {
          html += `<div style="margin-bottom: 30px;">`;
          html += `<h3 style="color: #667eea; margin-bottom: 15px;">${sectionNames[sectionIndex]}</h3>`;

          section.forEach((item, questionIndex) => {
            html += `
                        <div style="background: rgba(255, 255, 255, 0.1); border-radius: 10px; padding: 15px; margin-bottom: 15px; border: 1px solid rgba(255, 255, 255, 0.2);">
                            <div style="font-weight: bold; margin-bottom: 10px; font-size: 1.1em;">
                                <span style="display: inline-block; background: #667eea; color: white; width: 25px; height: 25px; border-radius: 50%; text-align: center; line-height: 25px; font-size: 0.9em; font-weight: bold; margin-right: 10px;">${globalIndex}</span>
                                ${item.vietnamese}
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; gap: 15px;">
                                <div style="color: #007bff; font-weight: 600; flex: 1;">${
                                  item.german
                                }</div>
                                <button style="background: linear-gradient(135deg, #28a745, #20c997); color: white; border: none; padding: 8px 15px; border-radius: 20px; font-size: 0.9em; cursor: pointer; transition: all 0.3s ease; flex-shrink: 0;" onclick="speakGermanPreview('${item.german.replace(
                                  /'/g,
                                  "\\'"
                                )}')">
                                    🔊 Nghe
                                </button>
                            </div>
                            <div style="font-size: 0.9em; opacity: 0.8; margin-top: 8px; font-style: italic;">${
                              item.tip
                            }</div>
                        </div>
                    `;
            globalIndex++;
          });
          html += `</div>`;
        });

        previewContent.innerHTML = html;
        document.getElementById("selection-screen").style.display = "none";
        document.getElementById("preview-screen").classList.add("show");
      }

      // Speak German text in preview
      function speakGermanPreview(text) {
        if ("speechSynthesis" in window) {
          speechSynthesis.cancel();
          const utterance = new SpeechSynthesisUtterance(text);
          utterance.lang = "de-DE";
          utterance.rate = 0.7;
          utterance.volume = 1.0;
          speechSynthesis.speak(utterance);
        } else {
          alert(
            "Trình duyệt không hỗ trợ text-to-speech. Hãy thử Chrome hoặc Edge!"
          );
        }
      }

      // Hide preview
      function hidePreview() {
        document.getElementById("preview-screen").classList.remove("show");
        document.getElementById("selection-screen").style.display = "block";
      }

      // Hide preview and start
      function hidePreviewAndStart() {
        hidePreview();
        setTimeout(() => startAllSections(), 300);
      }

      // Reset practice
      function resetPractice() {
        currentSectionIndex = 0;
        currentQuestionIndex = 0;
        isStarted = false;
        correctCount = 0;
        totalAnswered = 0;
        timeRemaining = timeLimit;
        sectionCompleted = false;
        isAllSections = false;
        totalCorrectAllSections = 0;
        totalAnsweredAllSections = 0;
        stopTimer();

        // Reset UI
        document.getElementById("selection-screen").style.display = "block";
        document.getElementById("practice-section").style.display = "none";
        document.getElementById("completion-screen").classList.remove("show");
        document.getElementById("preview-screen").classList.remove("show");
      }

      // Shuffle and restart
      function shuffleAndRestart() {
        // Shuffle each section
        practiceData.forEach((section) => {
          for (let i = section.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [section[i], section[j]] = [section[j], section[i]];
          }
        });
        resetPractice();
      }

      // Update display
      function updateDisplay() {
        if (!isStarted) {
          document.getElementById("vietnamese-text").textContent =
            'Chọn phần luyện tập hoặc nhấn "Làm tất cả 7 phần"';
        }
      }

      // Keyboard shortcuts
      document.addEventListener("keydown", function (e) {
        if (!isStarted || sectionCompleted) return;

        switch (e.key) {
          case " ":
            e.preventDefault();
            speakVietnamese();
            break;
          case "1":
            e.preventDefault();
            if (
              document.getElementById("correct-btn").style.display !== "none"
            ) {
              markAnswer(true);
            }
            break;
          case "2":
            e.preventDefault();
            if (
              document.getElementById("incorrect-btn").style.display !== "none"
            ) {
              markAnswer(false);
            }
            break;
          case "Enter":
            e.preventDefault();
            if (document.getElementById("next-btn").style.display !== "none") {
              nextSentence();
            }
            break;
        }
      });

      // Initialize when page loads
      window.onload = init;

      // Add voices changed event
      if ("speechSynthesis" in window) {
        speechSynthesis.onvoiceschanged = initializeVoices;
      }
    </script>
  </body>
</html>
