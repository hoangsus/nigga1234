<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Luy·ªán T·∫≠p Ti·∫øng ƒê·ª©c - German Practice</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      .header {
        background: linear-gradient(135deg, #4caf50, #45a049);
        color: white;
        padding: 30px;
        text-align: center;
      }

      .header h1 {
        font-size: 2.5rem;
        margin-bottom: 10px;
      }

      .header p {
        font-size: 1.1rem;
        opacity: 0.9;
      }

      .mode-selector {
        padding: 30px;
        text-align: center;
        border-bottom: 2px solid #f0f0f0;
      }

      .mode-buttons {
        display: flex;
        gap: 20px;
        justify-content: center;
        flex-wrap: wrap;
      }

      .mode-btn {
        padding: 15px 30px;
        border: none;
        border-radius: 10px;
        font-size: 1.1rem;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        min-width: 200px;
      }

      .mode-btn.study {
        background: linear-gradient(135deg, #2196f3, #1976d2);
        color: white;
      }

      .mode-btn.test {
        background: linear-gradient(135deg, #ff5722, #d84315);
        color: white;
      }

      .mode-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      .content {
        padding: 30px;
        min-height: 400px;
      }

      .card {
        background: #f8f9fa;
        border-radius: 15px;
        padding: 30px;
        margin-bottom: 20px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      }

      .keyword {
        font-size: 3rem;
        font-weight: bold;
        color: #2c3e50;
        text-align: center;
        margin-bottom: 20px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      }

      .question-section {
        background: #e3f2fd;
        border-left: 5px solid #2196f3;
        padding: 20px;
        margin: 20px 0;
        border-radius: 0 10px 10px 0;
      }

      .answer-section {
        background: #e8f5e8;
        border-left: 5px solid #4caf50;
        padding: 20px;
        margin: 20px 0;
        border-radius: 0 10px 10px 0;
      }

      .german-text {
        font-size: 1.3rem;
        font-weight: bold;
        color: #1565c0;
        margin-bottom: 10px;
      }

      .vietnamese-text {
        font-size: 1.1rem;
        color: #666;
        font-style: italic;
      }

      .controls {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin: 20px 0;
        flex-wrap: wrap;
      }

      .btn {
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: bold;
      }

      .btn-primary {
        background: #2196f3;
        color: white;
      }

      .btn-success {
        background: #4caf50;
        color: white;
      }

      .btn-warning {
        background: #ff9800;
        color: white;
      }

      .btn-danger {
        background: #f44336;
        color: white;
      }

      .btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
      }

      .timer {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #f44336;
        color: white;
        padding: 15px 20px;
        border-radius: 10px;
        font-size: 1.2rem;
        font-weight: bold;
        box-shadow: 0 5px 15px rgba(244, 67, 54, 0.3);
        z-index: 1000;
      }

      .progress {
        background: #e0e0e0;
        border-radius: 10px;
        height: 10px;
        margin: 20px 0;
        overflow: hidden;
      }

      .progress-bar {
        background: linear-gradient(90deg, #4caf50, #45a049);
        height: 100%;
        border-radius: 10px;
        transition: width 0.3s ease;
      }

      .score {
        text-align: center;
        font-size: 1.2rem;
        margin: 10px 0;
      }

      .hidden {
        display: none;
      }

      .fade-in {
        animation: fadeIn 0.5s ease-in;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .tips {
        background: #fff3cd;
        border: 1px solid #ffeaa7;
        border-radius: 10px;
        padding: 15px;
        margin: 20px 0;
      }

      .tips h3 {
        color: #856404;
        margin-bottom: 10px;
      }

      .tips ul {
        color: #856404;
        margin-left: 20px;
      }

      @media (max-width: 768px) {
        .header h1 {
          font-size: 2rem;
        }

        .keyword {
          font-size: 2rem;
        }

        .mode-buttons {
          flex-direction: column;
          align-items: center;
        }

        .controls {
          flex-direction: column;
          align-items: center;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üá©üá™ Luy·ªán T·∫≠p Ti·∫øng ƒê·ª©c</h1>
        <p>√în t·∫≠p t·ª´ v·ª±ng v√† c√¢u h·ªèi - tr·∫£ l·ªùi c∆° b·∫£n</p>
      </div>

      <div class="mode-selector" id="modeSelector">
        <h2 style="margin-bottom: 20px">Ch·ªçn ch·∫ø ƒë·ªô h·ªçc t·∫≠p</h2>
        <div class="mode-buttons">
          <button class="mode-btn study" onclick="startStudyMode()">
            üìö Ch·∫ø ƒë·ªô √¥n luy·ªán
            <br /><small>H·ªçc t·ª´ v·ª±ng theo ch·ªß ƒë·ªÅ</small>
          </button>
          <button class="mode-btn test" onclick="startTestMode()">
            ‚è±Ô∏è Ki·ªÉm tra t·ªïng h·ª£p 2 ph√∫t
            <br /><small>Luy·ªán t·∫≠p nhanh t·∫•t c·∫£ ch·ªß ƒë·ªÅ</small>
          </button>
          <button
            class="mode-btn"
            onclick="startTopicTestMode()"
            style="
              background: linear-gradient(135deg, #9c27b0, #673ab7);
              color: white;
            "
          >
            üéØ Ki·ªÉm tra theo ch·ªß ƒë·ªÅ 2 ph√∫t
            <br /><small>Luy·ªán t·∫≠p t·ª´ng ch·ªß ƒë·ªÅ ri√™ng bi·ªát</small>
          </button>
        </div>
      </div>

      <div class="content" id="studyContent">
        <div class="tips">
          <h3>üí° M·∫πo h·ªçc t·∫≠p hi·ªáu qu·∫£:</h3>
          <ul>
            <li>Nghe v√† l·∫∑p l·∫°i nhi·ªÅu l·∫ßn ƒë·ªÉ c·∫£i thi·ªán ph√°t √¢m</li>
            <li>
              Ch√∫ √Ω ng·ªØ ph√°p: ƒë·ªông t·ª´ chia theo ng√¥i (ich spiele, Sie spielen)
            </li>
            <li>
              H·ªçc thu·ªôc c√°c c·ª•m t·ª´ c∆° b·∫£n: "am Wochenende", "mit meinen
              Freunden"
            </li>
            <li>C√¢u tr·∫£ l·ªùi ng·∫Øn g·ªçn nh∆∞ng ƒë·∫ßy ƒë·ªß √Ω</li>
          </ul>
        </div>
      </div>

      <div class="timer hidden" id="timer">2:00</div>
    </div>

    <script>
      // D·ªØ li·ªáu b√†i h·ªçc - s·ª≠a l·∫°i ƒë√∫ng ch·ªß ƒë·ªÅ theo h√¨nh ·∫£nh
      const vocabularyData = {
        Wochenende: [
          {
            keyword: "Ausflug",
            question: "Machen Sie einen Ausflug?",
            questionVN: "B·∫°n c√≥ ƒëi ch∆°i kh√¥ng?",
            answer: "Ja, ich mache gern einen Ausflug.",
            answerVN: "C√≥, t√¥i th√≠ch ƒëi ch∆°i.",
            simpleAnswer: "Ja, ich mache einen Ausflug.",
          },
          {
            keyword: "Sport",
            question: "Machen Sie Sport?",
            questionVN: "B·∫°n c√≥ ch∆°i th·ªÉ thao kh√¥ng?",
            answer: "Ja, ich mache gern Sport.",
            answerVN: "C√≥, t√¥i th√≠ch ch∆°i th·ªÉ thao.",
            simpleAnswer: "Ja, ich mache Sport.",
          },
          {
            keyword: "fernsehen",
            question: "Sehen Sie fern?",
            questionVN: "B·∫°n c√≥ xem TV kh√¥ng?",
            answer: "Ja, ich sehe gern fern.",
            answerVN: "C√≥, t√¥i th√≠ch xem TV.",
            simpleAnswer: "Ja, ich sehe fern.",
          },
          {
            keyword: "Kino",
            question: "Gehen Sie ins Kino?",
            questionVN: "B·∫°n c√≥ ƒëi xem phim kh√¥ng?",
            answer: "Ja, ich gehe gern ins Kino.",
            answerVN: "C√≥, t√¥i th√≠ch ƒëi xem phim.",
            simpleAnswer: "Ja, ich gehe ins Kino.",
          },
          {
            keyword: "kochen",
            question: "Kochen Sie gern?",
            questionVN: "B·∫°n c√≥ th√≠ch n·∫•u ƒÉn kh√¥ng?",
            answer: "Ja, ich koche sehr gern.",
            answerVN: "C√≥, t√¥i r·∫•t th√≠ch n·∫•u ƒÉn.",
            simpleAnswer: "Ja, ich koche gern.",
          },
          {
            keyword: "schlafen",
            question: "Schlafen Sie gern?",
            questionVN: "B·∫°n c√≥ th√≠ch ng·ªß kh√¥ng?",
            answer: "Ja, ich schlafe sehr gern.",
            answerVN: "C√≥, t√¥i r·∫•t th√≠ch ng·ªß.",
            simpleAnswer: "Ja, ich schlafe gern.",
          },
        ],
        Sport: [
          {
            keyword: "Fu√üball",
            question: "Spielen Sie Fu√üball?",
            questionVN: "B·∫°n c√≥ ch∆°i b√≥ng ƒë√° kh√¥ng?",
            answer: "Ja, ich spiele gern Fu√üball.",
            answerVN: "C√≥, t√¥i th√≠ch ch∆°i b√≥ng ƒë√°.",
            simpleAnswer: "Ja, ich spiele Fu√üball.",
          },
          {
            keyword: "Fahrrad fahren",
            question: "Fahren Sie Fahrrad?",
            questionVN: "B·∫°n c√≥ ƒë·∫°p xe kh√¥ng?",
            answer: "Ja, ich fahre gern Fahrrad.",
            answerVN: "C√≥, t√¥i th√≠ch ƒë·∫°p xe.",
            simpleAnswer: "Ja, ich fahre Fahrrad.",
          },
          {
            keyword: "schwimmen",
            question: "Schwimmen Sie gern?",
            questionVN: "B·∫°n c√≥ th√≠ch b∆°i kh√¥ng?",
            answer: "Ja, ich schwimme sehr gern.",
            answerVN: "C√≥, t√¥i r·∫•t th√≠ch b∆°i.",
            simpleAnswer: "Ja, ich schwimme gern.",
          },
          {
            keyword: "wandern",
            question: "Wandern Sie gern?",
            questionVN: "B·∫°n c√≥ th√≠ch ƒëi b·ªô ƒë∆∞·ªùng d√†i kh√¥ng?",
            answer: "Ja, ich wandere sehr gern.",
            answerVN: "C√≥, t√¥i r·∫•t th√≠ch ƒëi b·ªô ƒë∆∞·ªùng d√†i.",
            simpleAnswer: "Ja, ich wandere gern.",
          },
          {
            keyword: "Verein",
            question: "Sind Sie in einem Verein?",
            questionVN: "B·∫°n c√≥ tham gia c√¢u l·∫°c b·ªô kh√¥ng?",
            answer: "Ja, ich bin in einem Sportverein.",
            answerVN: "C√≥, t√¥i tham gia c√¢u l·∫°c b·ªô th·ªÉ thao.",
            simpleAnswer: "Ja, ich bin in einem Verein.",
          },
          {
            keyword: "Wochenende",
            question: "Machen Sie Sport am Wochenende?",
            questionVN: "B·∫°n c√≥ ch∆°i th·ªÉ thao cu·ªëi tu·∫ßn kh√¥ng?",
            answer: "Ja, ich mache Sport am Wochenende.",
            answerVN: "C√≥, t√¥i ch∆°i th·ªÉ thao cu·ªëi tu·∫ßn.",
            simpleAnswer: "Ja, am Wochenende.",
          },
        ],
        Reisen: [
          {
            keyword: "Wohin?",
            question: "Wohin reisen Sie?",
            questionVN: "B·∫°n ƒëi du l·ªãch ƒë√¢u?",
            answer: "Ich reise nach Deutschland.",
            answerVN: "T√¥i ƒëi du l·ªãch ƒê·ª©c.",
            simpleAnswer: "Nach Deutschland.",
          },
          {
            keyword: "Hotel",
            question: "Wohnen Sie im Hotel?",
            questionVN: "B·∫°n c√≥ ·ªü kh√°ch s·∫°n kh√¥ng?",
            answer: "Ja, ich wohne gern im Hotel.",
            answerVN: "C√≥, t√¥i th√≠ch ·ªü kh√°ch s·∫°n.",
            simpleAnswer: "Ja, im Hotel.",
          },
          {
            keyword: "Urlaub",
            question: "Machen Sie Urlaub?",
            questionVN: "B·∫°n c√≥ ƒëi ngh·ªâ kh√¥ng?",
            answer: "Ja, ich mache gern Urlaub.",
            answerVN: "C√≥, t√¥i th√≠ch ƒëi ngh·ªâ.",
            simpleAnswer: "Ja, ich mache Urlaub.",
          },
          {
            keyword: "L√§nder",
            question: "Welche L√§nder besuchen Sie?",
            questionVN: "B·∫°n thƒÉm nh·ªØng n∆∞·ªõc n√†o?",
            answer: "Ich besuche Deutschland und Vietnam.",
            answerVN: "T√¥i thƒÉm ƒê·ª©c v√† Vi·ªát Nam.",
            simpleAnswer: "Deutschland und Vietnam.",
          },
          {
            keyword: "Auto",
            question: "Reisen Sie mit dem Auto?",
            questionVN: "B·∫°n c√≥ ƒëi du l·ªãch b·∫±ng √¥ t√¥ kh√¥ng?",
            answer: "Ja, ich reise gern mit dem Auto.",
            answerVN: "C√≥, t√¥i th√≠ch ƒëi du l·ªãch b·∫±ng √¥ t√¥.",
            simpleAnswer: "Ja, mit dem Auto.",
          },
          {
            keyword: "Wann?",
            question: "Wann reisen Sie?",
            questionVN: "Khi n√†o b·∫°n ƒëi du l·ªãch?",
            answer: "Ich reise im Sommer.",
            answerVN: "T√¥i ƒëi du l·ªãch v√†o m√πa h√®.",
            simpleAnswer: "Im Sommer.",
          },
        ],
        Freizeit: [
          {
            keyword: "Hobby",
            question: "Was ist Ihr Hobby?",
            questionVN: "S·ªü th√≠ch c·ªßa b·∫°n l√† g√¨?",
            answer: "Mein Hobby ist Musik.",
            answerVN: "S·ªü th√≠ch c·ªßa t√¥i l√† √¢m nh·∫°c.",
            simpleAnswer: "Musik.",
          },
          {
            keyword: "Wochenende",
            question: "Was machen Sie am Wochenende?",
            questionVN: "B·∫°n l√†m g√¨ cu·ªëi tu·∫ßn?",
            answer: "Ich lese B√ºcher am Wochenende.",
            answerVN: "T√¥i ƒë·ªçc s√°ch cu·ªëi tu·∫ßn.",
            simpleAnswer: "Ich lese B√ºcher.",
          },
          {
            keyword: "Wann?",
            question: "Wann haben Sie Zeit?",
            questionVN: "Khi n√†o b·∫°n c√≥ th·ªùi gian?",
            answer: "Ich habe am Abend Zeit.",
            answerVN: "T√¥i c√≥ th·ªùi gian v√†o bu·ªïi t·ªëi.",
            simpleAnswer: "Am Abend.",
          },
          {
            keyword: "Fu√üball",
            question: "M√∂gen Sie Fu√üball?",
            questionVN: "B·∫°n c√≥ th√≠ch b√≥ng ƒë√° kh√¥ng?",
            answer: "Ja, ich mag Fu√üball sehr.",
            answerVN: "C√≥, t√¥i r·∫•t th√≠ch b√≥ng ƒë√°.",
            simpleAnswer: "Ja, sehr gern.",
          },
          {
            keyword: "Lieblingssport",
            question: "Was ist Ihr Lieblingssport?",
            questionVN: "M√¥n th·ªÉ thao y√™u th√≠ch c·ªßa b·∫°n l√† g√¨?",
            answer: "Mein Lieblingssport ist Tennis.",
            answerVN: "M√¥n th·ªÉ thao y√™u th√≠ch c·ªßa t√¥i l√† qu·∫ßn v·ª£t.",
            simpleAnswer: "Tennis.",
          },
          {
            keyword: "Sonntag",
            question: "Was machen Sie am Sonntag?",
            questionVN: "B·∫°n l√†m g√¨ v√†o ch·ªß nh·∫≠t?",
            answer: "Ich besuche Freunde am Sonntag.",
            answerVN: "T√¥i thƒÉm b·∫°n b√® v√†o ch·ªß nh·∫≠t.",
            simpleAnswer: "Ich besuche Freunde.",
          },
        ],
      };

      // Bi·∫øn to√†n c·ª•c
      let currentMode = "study";
      let currentItems = [];
      let currentIndex = 0;
      let currentTopic = ""; // Th√™m bi·∫øn ƒë·ªÉ l∆∞u ch·ªß ƒë·ªÅ hi·ªán t·∫°i
      let timer = null;
      let timeLeft = 120; // 2 ph√∫t
      let score = 0;
      let totalQuestions = 0;
      let showAnswer = false;

      // Kh·ªüi t·∫°o t·∫•t c·∫£ items
      function getAllItems() {
        const allItems = [];
        for (const category in vocabularyData) {
          allItems.push(...vocabularyData[category]);
        }
        return shuffleArray(allItems);
      }

      // X√°o tr·ªôn m·∫£ng
      function shuffleArray(array) {
        const shuffled = [...array];
        for (let i = shuffled.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
        }
        return shuffled;
      }

      // Text-to-Speech - d·ª´ng ti·∫øng c≈© tr∆∞·ªõc khi ph√°t ti·∫øng m·ªõi
      function speak(text, lang = "de-DE") {
        if ("speechSynthesis" in window) {
          // D·ª´ng t·∫•t c·∫£ ti·∫øng ƒëang ph√°t
          speechSynthesis.cancel();

          // Ch·ªù m·ªôt ch√∫t ƒë·ªÉ ƒë·∫£m b·∫£o d·ª´ng ho√†n to√†n
          setTimeout(() => {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = lang;
            utterance.rate = 0.8;
            speechSynthesis.speak(utterance);
          }, 100);
        }
      }

      // B·∫Øt ƒë·∫ßu ch·∫ø ƒë·ªô √¥n luy·ªán - hi·ªÉn th·ªã danh s√°ch theo ch·ªß ƒë·ªÅ
      function startStudyMode() {
        currentMode = "study";
        showTopicList();
      }

      // Hi·ªÉn th·ªã danh s√°ch ch·ªß ƒë·ªÅ
      function showTopicList() {
        document.getElementById("modeSelector").classList.add("hidden");
        const content = document.getElementById("studyContent");

        content.innerHTML = `
                <div class="card fade-in">
                    <h2 style="text-align: center; color: #2c3e50; margin-bottom: 30px;">
                        üìö Ch·ªçn ch·ªß ƒë·ªÅ √¥n luy·ªán
                    </h2>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                        ${Object.keys(vocabularyData)
                          .map(
                            (topic) => `
                            <div class="topic-card" onclick="showTopicDetail('${topic}')" style="
                                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                                color: white;
                                padding: 25px;
                                border-radius: 15px;
                                cursor: pointer;
                                transition: all 0.3s ease;
                                text-align: center;
                                box-shadow: 0 5px 15px rgba(0,0,0,0.1);
                            " onmouseover="this.style.transform='translateY(-5px)'" onmouseout="this.style.transform='translateY(0)'">
                                <h3 style="margin-bottom: 15px; font-size: 1.5rem;">
                                    ${getTopicIcon(topic)} ${getTopicTitle(
                              topic
                            )}
                                </h3>
                                <p style="opacity: 0.9; margin-bottom: 15px;">
                                    ${vocabularyData[topic].length} t·ª´ v·ª±ng
                                </p>
                                <div style="background: rgba(255,255,255,0.2); padding: 10px; border-radius: 8px;">
                                    ${vocabularyData[topic]
                                      .slice(0, 3)
                                      .map(
                                        (item) =>
                                          `<span style="font-size: 0.9rem;">${item.keyword}</span>`
                                      )
                                      .join(" ‚Ä¢ ")}${
                              vocabularyData[topic].length > 3 ? " ‚Ä¢ ..." : ""
                            }
                                </div>
                            </div>
                        `
                          )
                          .join("")}
                    </div>
                    
                    <div class="controls" style="margin-top: 30px;">
                        <button class="btn btn-primary" onclick="studyAllTopics()">
                            üìñ √în t·∫•t c·∫£ ch·ªß ƒë·ªÅ
                        </button>
                        <button class="btn btn-danger" onclick="backToMenu()">
                            üè† V·ªÅ menu
                        </button>
                    </div>
                </div>
            `;
      }

      // L·∫•y icon cho ch·ªß ƒë·ªÅ
      function getTopicIcon(topic) {
        const icons = {
          Freizeit: "üéØ",
          Reisen: "‚úàÔ∏è",
          Sport: "‚öΩ",
          Wochenende: "üåÖ",
        };
        return icons[topic] || "üìù";
      }

      // L·∫•y ti√™u ƒë·ªÅ ti·∫øng Vi·ªát cho ch·ªß ƒë·ªÅ
      function getTopicTitle(topic) {
        const titles = {
          Freizeit: "Th·ªùi gian r·∫£nh r·ªói",
          Reisen: "Du l·ªãch",
          Sport: "Th·ªÉ thao",
          Wochenende: "Cu·ªëi tu·∫ßn",
        };
        return titles[topic] || topic;
      }

      // Hi·ªÉn th·ªã chi ti·∫øt m·ªôt ch·ªß ƒë·ªÅ
      function showTopicDetail(topic) {
        speechSynthesis.cancel(); // D·ª´ng ti·∫øng ƒëang ph√°t

        const content = document.getElementById("studyContent");
        const items = vocabularyData[topic];

        content.innerHTML = `
                <div class="card fade-in">
                    <div style="text-align: center; margin-bottom: 30px;">
                        <h2 style="color: #2c3e50;">
                            ${getTopicIcon(topic)} ${getTopicTitle(topic)}
                        </h2>
                        <p style="color: #666; font-size: 1.1rem;">
                            ${items.length} t·ª´ v·ª±ng v√† c√¢u h·ªèi - tr·∫£ l·ªùi
                        </p>
                    </div>
                    
                    <div class="vocabulary-list">
                        ${items
                          .map(
                            (item, index) => `
                            <div class="vocabulary-item" style="
                                background: #f8f9fa;
                                border-left: 5px solid #4CAF50;
                                margin-bottom: 20px;
                                border-radius: 0 10px 10px 0;
                                overflow: hidden;
                                box-shadow: 0 3px 10px rgba(0,0,0,0.05);
                            ">
                                <div style="padding: 20px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                        <div class="keyword" style="
                                            font-size: 1.8rem;
                                            font-weight: bold;
                                            color: #2c3e50;
                                            margin: 0;
                                        ">${item.keyword}</div>
                                        <button class="btn btn-primary" onclick="speak('${item.keyword}')" style="padding: 8px 16px;">
                                            üîä
                                        </button>
                                    </div>
                                    
                                    <div class="question-section" style="
                                        background: #e3f2fd;
                                        padding: 15px;
                                        border-radius: 8px;
                                        margin-bottom: 15px;
                                    ">
                                        <div class="german-text" style="font-size: 1.2rem; font-weight: bold; color: #1565c0; margin-bottom: 8px;">
                                            ${item.question}
                                        </div>
                                        <div class="vietnamese-text" style="font-size: 1rem; color: #666; font-style: italic;">
                                            ${item.questionVN}
                                        </div>
                                        <button class="btn btn-primary" onclick="speak('${item.question}')" 
                                                style="margin-top: 10px; padding: 6px 12px; font-size: 0.9rem;">
                                            üîä Nghe c√¢u h·ªèi
                                        </button>
                                    </div>
                                    
                                    <div class="answer-section" style="
                                        background: #e8f5e8;
                                        padding: 15px;
                                        border-radius: 8px;
                                    ">
                                        <div style="margin-bottom: 10px;">
                                            <div class="german-text" style="font-size: 1.1rem; font-weight: bold; color: #2e7d32; margin-bottom: 5px;">
                                                ‚úÖ ${item.answer}
                                            </div>
                                            <div class="vietnamese-text" style="font-size: 0.95rem; color: #666; margin-bottom: 10px;">
                                                ${item.answerVN}
                                            </div>
                                        </div>
                                        
                                        <div style="background: rgba(255,152,0,0.1); padding: 10px; border-radius: 6px; margin-bottom: 10px;">
                                            <div class="german-text" style="font-size: 1rem; font-weight: bold; color: #FF5722;">
                                                üí° C√¢u tr·∫£ l·ªùi ng·∫Øn: ${item.simpleAnswer}
                                            </div>
                                        </div>
                                        
                                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                            <button class="btn btn-success" onclick="speak('${item.answer}')" style="padding: 6px 12px; font-size: 0.9rem;">
                                                üîä Nghe ƒë√°p √°n ƒë·∫ßy ƒë·ªß
                                            </button>
                                            <button class="btn btn-warning" onclick="speak('${item.simpleAnswer}')" style="padding: 6px 12px; font-size: 0.9rem;">
                                                üîä Nghe ƒë√°p √°n ng·∫Øn
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `
                          )
                          .join("")}
                    </div>
                    
                    <div class="controls" style="margin-top: 30px;">
                        <button class="btn btn-primary" onclick="showTopicList()">
                            ‚¨ÖÔ∏è V·ªÅ danh s√°ch ch·ªß ƒë·ªÅ
                        </button>
                        <button class="btn btn-success" onclick="practiceTopicCards('${topic}')">
                            üéØ Luy·ªán t·∫≠p flashcard
                        </button>
                        <button class="btn btn-danger" onclick="backToMenu()">
                            üè† V·ªÅ menu
                        </button>
                    </div>
                </div>
            `;
      }

      // √în t·∫•t c·∫£ ch·ªß ƒë·ªÅ
      function studyAllTopics() {
        currentItems = getAllItems();
        currentIndex = 0;
        showAnswer = false;
        showStudyCard();
      }

      // B·∫Øt ƒë·∫ßu ch·∫ø ƒë·ªô ki·ªÉm tra theo ch·ªß ƒë·ªÅ
      function startTopicTestMode() {
        currentMode = "topicTest";
        showTopicTestList();
      }

      // Hi·ªÉn th·ªã danh s√°ch ch·ªß ƒë·ªÅ cho ki·ªÉm tra
      function showTopicTestList() {
        document.getElementById("modeSelector").classList.add("hidden");
        const content = document.getElementById("studyContent");

        content.innerHTML = `
                <div class="card fade-in">
                    <h2 style="text-align: center; color: #2c3e50; margin-bottom: 20px;">
                        üéØ Ch·ªçn ch·ªß ƒë·ªÅ ki·ªÉm tra 2 ph√∫t
                    </h2>
                    
                    <div class="tips" style="margin-bottom: 30px;">
                        <h3>üí° M·∫πo ki·ªÉm tra theo ch·ªß ƒë·ªÅ:</h3>
                        <ul>
                            <li>Luy·ªán t·∫≠p t·ª´ng ch·ªß ƒë·ªÅ m·ªôt c√°ch c√≥ h·ªá th·ªëng</li>
                            <li>T·∫≠p trung v√†o ƒëi·ªÉm y·∫øu c·ª• th·ªÉ</li>
                            <li>D·ªÖ d√†ng theo d√µi ti·∫øn ƒë·ªô t·ª´ng ph·∫ßn</li>
                            <li>√Åp d·ª•ng ki·∫øn th·ª©c ngay sau khi √¥n luy·ªán</li>
                        </ul>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                        ${Object.keys(vocabularyData)
                          .map(
                            (topic) => `
                            <div class="topic-card" onclick="startTopicTest('${topic}')" style="
                                background: linear-gradient(135deg, #9C27B0, #673AB7);
                                color: white;
                                padding: 25px;
                                border-radius: 15px;
                                cursor: pointer;
                                transition: all 0.3s ease;
                                text-align: center;
                                box-shadow: 0 5px 15px rgba(0,0,0,0.1);
                                position: relative;
                                overflow: hidden;
                            " onmouseover="this.style.transform='translateY(-5px)'" onmouseout="this.style.transform='translateY(0)'">
                                <div style="position: absolute; top: 10px; right: 15px; background: rgba(255,255,255,0.2); padding: 5px 10px; border-radius: 20px; font-size: 0.8rem;">
                                    ‚è±Ô∏è 2 ph√∫t
                                </div>
                                <h3 style="margin-bottom: 15px; font-size: 1.5rem;">
                                    ${getTopicIcon(topic)} ${getTopicTitle(
                              topic
                            )}
                                </h3>
                                <p style="opacity: 0.9; margin-bottom: 15px;">
                                    ${vocabularyData[topic].length} c√¢u h·ªèi
                                </p>
                                <div style="background: rgba(255,255,255,0.2); padding: 10px; border-radius: 8px; margin-bottom: 15px;">
                                    ${vocabularyData[topic]
                                      .slice(0, 3)
                                      .map(
                                        (item) =>
                                          `<span style="font-size: 0.9rem;">${item.keyword}</span>`
                                      )
                                      .join(" ‚Ä¢ ")}${
                              vocabularyData[topic].length > 3 ? " ‚Ä¢ ..." : ""
                            }
                                </div>
                                <div style="background: rgba(255,255,255,0.1); padding: 8px; border-radius: 6px; font-size: 0.9rem;">
                                    üéØ B·∫Øt ƒë·∫ßu ki·ªÉm tra ngay
                                </div>
                            </div>
                        `
                          )
                          .join("")}
                    </div>
                    
                    <div class="controls" style="margin-top: 30px;">
                        <button class="btn btn-primary" onclick="startRandomTopicTest()">
                            üé≤ Ki·ªÉm tra ch·ªß ƒë·ªÅ ng·∫´u nhi√™n
                        </button>
                        <button class="btn btn-danger" onclick="backToMenu()">
                            üè† V·ªÅ menu
                        </button>
                    </div>
                </div>
            `;
      }

      // B·∫Øt ƒë·∫ßu ki·ªÉm tra m·ªôt ch·ªß ƒë·ªÅ c·ª• th·ªÉ
      function startTopicTest(topic) {
        currentMode = "topicTest";
        currentTopic = topic;
        currentItems = shuffleArray(vocabularyData[topic]);
        currentIndex = 0;
        score = 0;
        totalQuestions = 0;
        timeLeft = 120;
        showAnswer = false;

        document.getElementById("timer").classList.remove("hidden");

        startTimer();
        showTopicTestCard();
      }

      // Hi·ªÉn th·ªã th·∫ª ki·ªÉm tra theo ch·ªß ƒë·ªÅ
      function showTopicTestCard() {
        if (currentIndex >= currentItems.length) {
          endTopicTest();
          return;
        }

        const item = currentItems[currentIndex];
        const content = document.getElementById("studyContent");

        content.innerHTML = `
                <div class="card fade-in">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <h3 style="color: #9C27B0; margin-bottom: 10px;">
                            ${getTopicIcon(
                              currentTopic
                            )} Ki·ªÉm tra: ${getTopicTitle(currentTopic)}
                        </h3>
                        <div style="background: linear-gradient(135deg, #9C27B0, #673AB7); color: white; padding: 8px 16px; border-radius: 20px; display: inline-block; font-size: 0.9rem;">
                            C√¢u ${currentIndex + 1}/${currentItems.length}
                        </div>
                    </div>
                    
                    <div class="keyword">${item.keyword}</div>
                    
                    <div class="question-section">
                        <h3>üéØ ƒêo√°n c√¢u h·ªèi t·ª´ t·ª´ kh√≥a n√†y:</h3>
                        <div class="vietnamese-text">G·ª£i √Ω: ${
                          item.questionVN
                        }</div>
                    </div>
                    
                    <div class="controls">
                        <button class="btn btn-primary" onclick="showTopicTestAnswer()">
                            üëÅÔ∏è Xem c√¢u h·ªèi & ƒë√°p √°n
                        </button>
                        <button class="btn btn-success" onclick="speak('${
                          item.keyword
                        }')" style="background: #9C27B0;">
                            üîä Nghe t·ª´ kh√≥a
                        </button>
                    </div>
                    
                    <div id="testAnswerSection" class="${
                      showAnswer ? "" : "hidden"
                    }">
                        <div class="question-section">
                            <div class="german-text">C√¢u h·ªèi: ${
                              item.question
                            }</div>
                        </div>
                        
                        <div class="answer-section">
                            <div class="german-text">ƒê√°p √°n ng·∫Øn: ${
                              item.simpleAnswer
                            }</div>
                            <div class="vietnamese-text">${item.answerVN}</div>
                        </div>
                        
                        <div class="controls">
                            <button class="btn btn-primary" onclick="speak('${
                              item.question
                            }')">üîä Nghe c√¢u h·ªèi</button>
                            <button class="btn btn-warning" onclick="speak('${
                              item.simpleAnswer
                            }')">üîä Nghe ƒë√°p √°n</button>
                        </div>
                        
                        <div class="controls" style="margin-top: 20px;">
                            <button class="btn btn-success" onclick="markTopicTestCorrect()">‚úÖ Bi·∫øt</button>
                            <button class="btn btn-danger" onclick="markTopicTestIncorrect()">‚ùå Kh√¥ng bi·∫øt</button>
                        </div>
                    </div>
                    
                    <div class="progress">
                        <div class="progress-bar" style="width: ${
                          ((currentIndex + 1) / currentItems.length) * 100
                        }%; background: linear-gradient(90deg, #9C27B0, #673AB7);"></div>
                    </div>
                    <div class="score">
                        C√¢u ${currentIndex + 1} / ${
          currentItems.length
        } | ƒê√∫ng: ${score}/${totalQuestions}
                    </div>
                </div>
            `;
      }

      // Hi·ªÉn th·ªã ƒë√°p √°n trong ki·ªÉm tra theo ch·ªß ƒë·ªÅ
      function showTopicTestAnswer() {
        showAnswer = true;
        showTopicTestCard();
      }

      // ƒê√°nh d·∫•u c√¢u ƒë√∫ng trong ki·ªÉm tra ch·ªß ƒë·ªÅ
      function markTopicTestCorrect() {
        score++;
        totalQuestions++;
        nextTopicTestCard();
      }

      // ƒê√°nh d·∫•u c√¢u sai trong ki·ªÉm tra ch·ªß ƒë·ªÅ
      function markTopicTestIncorrect() {
        totalQuestions++;
        nextTopicTestCard();
      }

      // Chuy·ªÉn c√¢u h·ªèi ti·∫øp theo trong ki·ªÉm tra ch·ªß ƒë·ªÅ
      function nextTopicTestCard() {
        speechSynthesis.cancel();
        showAnswer = false;
        currentIndex++;
        showTopicTestCard();
      }

      // K·∫øt th√∫c b√†i test theo ch·ªß ƒë·ªÅ
      function endTopicTest() {
        clearInterval(timer);
        document.getElementById("timer").classList.add("hidden");

        const percentage =
          totalQuestions > 0 ? Math.round((score / totalQuestions) * 100) : 0;
        let feedback = "";
        let emoji = "";

        if (percentage >= 80) {
          feedback = `Xu·∫•t s·∫Øc! B·∫°n ƒë√£ n·∫Øm v·ªØng ch·ªß ƒë·ªÅ "${getTopicTitle(
            currentTopic
          )}".`;
          emoji = "üèÜ";
        } else if (percentage >= 60) {
          feedback = `T·ªët! B·∫°n c·∫ßn √¥n luy·ªán th√™m ch·ªß ƒë·ªÅ "${getTopicTitle(
            currentTopic
          )}".`;
          emoji = "üëç";
        } else {
          feedback = `H√£y √¥n luy·ªán th√™m ch·ªß ƒë·ªÅ "${getTopicTitle(
            currentTopic
          )}" nh√©!`;
          emoji = "üí™";
        }

        const content = document.getElementById("studyContent");
        content.innerHTML = `
                <div class="card fade-in" style="text-align: center;">
                    <div style="font-size: 4rem; margin-bottom: 20px;">${emoji}</div>
                    <h2 style="color: #2c3e50; margin-bottom: 15px;">K·∫øt qu·∫£ ki·ªÉm tra</h2>
                    <h3 style="color: #9C27B0; margin-bottom: 20px;">
                        ${getTopicIcon(currentTopic)} ${getTopicTitle(
          currentTopic
        )}
                    </h3>
                    
                    <div style="font-size: 3rem; font-weight: bold; color: #9C27B0; margin: 20px 0;">
                        ${score}/${totalQuestions}
                    </div>
                    
                    <div style="font-size: 2rem; color: #FF5722; margin-bottom: 20px;">
                        ${percentage}%
                    </div>
                    
                    <div style="font-size: 1.2rem; color: #666; margin-bottom: 30px;">
                        ${feedback}
                    </div>
                    
                    <div class="tips">
                        <h3>üìù G·ª£i √Ω ti·∫øp theo:</h3>
                        <ul style="text-align: left;">
                            <li>√în luy·ªán l·∫°i ch·ªß ƒë·ªÅ n√†y trong ch·∫ø ƒë·ªô h·ªçc t·∫≠p</li>
                            <li>Th·ª≠ ki·ªÉm tra c√°c ch·ªß ƒë·ªÅ kh√°c</li>
                            <li>Luy·ªán ph√°t √¢m v·ªõi c√°c t·ª´ v·ª±ng c√≤n y·∫øu</li>
                            <li>Th·ª±c h√†nh ki·ªÉm tra t·ªïng h·ª£p khi ƒë√£ th√†nh th·∫°o</li>
                        </ul>
                    </div>
                    
                    <div class="controls" style="margin-top: 30px;">
                        <button class="btn btn-primary" onclick="startTopicTest('${currentTopic}')" style="background: #9C27B0;">
                            üîÑ L√†m l·∫°i ch·ªß ƒë·ªÅ n√†y
                        </button>
                        <button class="btn btn-success" onclick="showTopicDetail('${currentTopic}')">
                            üìö √în luy·ªán ch·ªß ƒë·ªÅ n√†y
                        </button>
                        <button class="btn btn-warning" onclick="showTopicTestList()">
                            üéØ Ch·ªçn ch·ªß ƒë·ªÅ kh√°c
                        </button>
                        <button class="btn btn-danger" onclick="backToMenu()">
                            üè† V·ªÅ menu
                        </button>
                    </div>
                </div>
            `;
      }

      // Ki·ªÉm tra ch·ªß ƒë·ªÅ ng·∫´u nhi√™n
      function startRandomTopicTest() {
        const topics = Object.keys(vocabularyData);
        const randomTopic = topics[Math.floor(Math.random() * topics.length)];
        startTopicTest(randomTopic);
      }

      // B·∫Øt ƒë·∫ßu ch·∫ø ƒë·ªô ki·ªÉm tra
      function startTestMode() {
        currentMode = "test";
        currentItems = getAllItems().slice(0, 20); // Gi·ªõi h·∫°n 20 c√¢u
        currentIndex = 0;
        score = 0;
        totalQuestions = 0;
        timeLeft = 120;
        showAnswer = false;

        document.getElementById("modeSelector").classList.add("hidden");
        document.getElementById("timer").classList.remove("hidden");

        startTimer();
        showTestCard();
      }

      // Hi·ªÉn th·ªã th·∫ª √¥n luy·ªán
      function showStudyCard() {
        if (currentIndex >= currentItems.length) {
          currentIndex = 0;
        }

        const item = currentItems[currentIndex];
        const content = document.getElementById("studyContent");

        content.innerHTML = `
                <div class="card fade-in">
                    <div class="keyword">${item.keyword}</div>
                    
                    <div class="question-section">
                        <div class="german-text">${item.question}</div>
                        <div class="vietnamese-text">${item.questionVN}</div>
                    </div>
                    
                    <div class="controls">
                        <button class="btn btn-primary" onclick="speak('${
                          item.question
                        }')">
                            üîä Nghe c√¢u h·ªèi
                        </button>
                        <button class="btn btn-success" onclick="toggleAnswer()">
                            ${showAnswer ? "üôà ·∫®n ƒë√°p √°n" : "üëÅÔ∏è Xem ƒë√°p √°n"}
                        </button>
                    </div>
                    
                    <div id="answerSection" class="${
                      showAnswer ? "" : "hidden"
                    }">
                        <div class="answer-section">
                            <div class="german-text">C√¢u tr·∫£ l·ªùi ƒë·∫ßy ƒë·ªß: ${
                              item.answer
                            }</div>
                            <div class="vietnamese-text">${item.answerVN}</div>
                            <div class="german-text" style="color: #FF5722; margin-top: 10px;">
                                C√¢u tr·∫£ l·ªùi ng·∫Øn: ${item.simpleAnswer}
                            </div>
                        </div>
                        
                        <div class="controls">
                            <button class="btn btn-primary" onclick="speak('${
                              item.answer
                            }')">
                                üîä Nghe ƒë√°p √°n ƒë·∫ßy ƒë·ªß
                            </button>
                            <button class="btn btn-warning" onclick="speak('${
                              item.simpleAnswer
                            }')">
                                üîä Nghe ƒë√°p √°n ng·∫Øn
                            </button>
                        </div>
                    </div>
                    
                    <div class="controls" style="margin-top: 30px;">
                        <button class="btn btn-primary" onclick="previousCard()">‚¨ÖÔ∏è Tr∆∞·ªõc</button>
                        <button class="btn btn-success" onclick="nextCard()">Ti·∫øp ‚û°Ô∏è</button>
                        <button class="btn btn-danger" onclick="backToMenu()">üè† V·ªÅ menu</button>
                    </div>
                    
                    <div class="progress">
                        <div class="progress-bar" style="width: ${
                          ((currentIndex + 1) / currentItems.length) * 100
                        }%"></div>
                    </div>
                    <div class="score">Th·∫ª ${currentIndex + 1} / ${
          currentItems.length
        }</div>
                </div>
            `;
      }

      // Hi·ªÉn th·ªã th·∫ª ki·ªÉm tra
      function showTestCard() {
        if (currentIndex >= currentItems.length) {
          endTest();
          return;
        }

        const item = currentItems[currentIndex];
        const content = document.getElementById("studyContent");

        content.innerHTML = `
                <div class="card fade-in">
                    <div class="keyword">${item.keyword}</div>
                    
                    <div class="question-section">
                        <h3>ƒêo√°n c√¢u h·ªèi t·ª´ t·ª´ kh√≥a n√†y:</h3>
                        <div class="vietnamese-text">G·ª£i √Ω: ${
                          item.questionVN
                        }</div>
                    </div>
                    
                    <div class="controls">
                        <button class="btn btn-primary" onclick="showTestAnswer()">
                            üëÅÔ∏è Xem c√¢u h·ªèi & ƒë√°p √°n
                        </button>
                        <button class="btn btn-success" onclick="speak('${
                          item.keyword
                        }')">
                            üîä Nghe t·ª´ kh√≥a
                        </button>
                    </div>
                    
                    <div id="testAnswerSection" class="${
                      showAnswer ? "" : "hidden"
                    }">
                        <div class="question-section">
                            <div class="german-text">C√¢u h·ªèi: ${
                              item.question
                            }</div>
                        </div>
                        
                        <div class="answer-section">
                            <div class="german-text">ƒê√°p √°n ng·∫Øn: ${
                              item.simpleAnswer
                            }</div>
                            <div class="vietnamese-text">${item.answerVN}</div>
                        </div>
                        
                        <div class="controls">
                            <button class="btn btn-primary" onclick="speak('${
                              item.question
                            }')">üîä Nghe c√¢u h·ªèi</button>
                            <button class="btn btn-warning" onclick="speak('${
                              item.simpleAnswer
                            }')">üîä Nghe ƒë√°p √°n</button>
                        </div>
                        
                        <div class="controls" style="margin-top: 20px;">
                            <button class="btn btn-success" onclick="markCorrect()">‚úÖ Bi·∫øt</button>
                            <button class="btn btn-danger" onclick="markIncorrect()">‚ùå Kh√¥ng bi·∫øt</button>
                        </div>
                    </div>
                    
                    <div class="progress">
                        <div class="progress-bar" style="width: ${
                          ((currentIndex + 1) / currentItems.length) * 100
                        }%"></div>
                    </div>
                    <div class="score">
                        C√¢u ${currentIndex + 1} / ${
          currentItems.length
        } | ƒê√∫ng: ${score}/${totalQuestions}
                    </div>
                </div>
            `;
      }

      // B·∫≠t/t·∫Øt hi·ªÉn th·ªã ƒë√°p √°n trong ch·∫ø ƒë·ªô √¥n luy·ªán
      function toggleAnswer() {
        showAnswer = !showAnswer;
        showStudyCard();
      }

      // Hi·ªÉn th·ªã ƒë√°p √°n trong ch·∫ø ƒë·ªô ki·ªÉm tra
      function showTestAnswer() {
        showAnswer = true;
        showTestCard();
      }

      // ƒê√°nh d·∫•u c√¢u ƒë√∫ng
      function markCorrect() {
        score++;
        totalQuestions++;
        nextTestCard();
      }

      // ƒê√°nh d·∫•u c√¢u sai
      function markIncorrect() {
        totalQuestions++;
        nextTestCard();
      }

      // Chuy·ªÉn th·∫ª ti·∫øp theo - d·ª´ng ti·∫øng tr∆∞·ªõc khi chuy·ªÉn
      function nextCard() {
        speechSynthesis.cancel(); // D·ª´ng ti·∫øng ƒëang ph√°t
        showAnswer = false;
        currentIndex++;
        showStudyCard();
      }

      // Chuy·ªÉn th·∫ª tr∆∞·ªõc - d·ª´ng ti·∫øng tr∆∞·ªõc khi chuy·ªÉn
      function previousCard() {
        speechSynthesis.cancel(); // D·ª´ng ti·∫øng ƒëang ph√°t
        showAnswer = false;
        currentIndex =
          currentIndex > 0 ? currentIndex - 1 : currentItems.length - 1;
        showStudyCard();
      }

      // Chuy·ªÉn c√¢u h·ªèi ti·∫øp theo trong test - d·ª´ng ti·∫øng tr∆∞·ªõc khi chuy·ªÉn
      function nextTestCard() {
        speechSynthesis.cancel(); // D·ª´ng ti·∫øng ƒëang ph√°t
        showAnswer = false;
        currentIndex++;
        showTestCard();
      }

      // B·∫Øt ƒë·∫ßu timer
      function startTimer() {
        timer = setInterval(() => {
          timeLeft--;
          const minutes = Math.floor(timeLeft / 60);
          const seconds = timeLeft % 60;
          document.getElementById("timer").textContent = `${minutes}:${seconds
            .toString()
            .padStart(2, "0")}`;

          if (timeLeft <= 0) {
            endTest();
          }
        }, 1000);
      }

      // K·∫øt th√∫c b√†i test
      function endTest() {
        clearInterval(timer);
        document.getElementById("timer").classList.add("hidden");

        const percentage =
          totalQuestions > 0 ? Math.round((score / totalQuestions) * 100) : 0;
        let feedback = "";
        let emoji = "";

        if (percentage >= 80) {
          feedback = "Xu·∫•t s·∫Øc! B·∫°n ƒë√£ n·∫Øm v·ªØng t·ª´ v·ª±ng ti·∫øng ƒê·ª©c.";
          emoji = "üèÜ";
        } else if (percentage >= 60) {
          feedback = "T·ªët! B·∫°n c·∫ßn √¥n luy·ªán th√™m m·ªôt ch√∫t.";
          emoji = "üëç";
        } else {
          feedback = "C·∫ßn c·ªë g·∫Øng h∆°n! H√£y √¥n luy·ªán th√™m nh√©.";
          emoji = "üí™";
        }

        const content = document.getElementById("studyContent");
        content.innerHTML = `
                <div class="card fade-in" style="text-align: center;">
                    <div style="font-size: 4rem; margin-bottom: 20px;">${emoji}</div>
                    <h2 style="color: #2c3e50; margin-bottom: 20px;">K·∫øt qu·∫£ b√†i test</h2>
                    
                    <div style="font-size: 3rem; font-weight: bold; color: #4CAF50; margin: 20px 0;">
                        ${score}/${totalQuestions}
                    </div>
                    
                    <div style="font-size: 2rem; color: #FF5722; margin-bottom: 20px;">
                        ${percentage}%
                    </div>
                    
                    <div style="font-size: 1.2rem; color: #666; margin-bottom: 30px;">
                        ${feedback}
                    </div>
                    
                    <div class="tips">
                        <h3>üìù L·ªùi khuy√™n ƒë·ªÉ c·∫£i thi·ªán:</h3>
                        <ul style="text-align: left;">
                            <li>√în luy·ªán c√°c t·ª´ v·ª±ng c√≤n y·∫øu trong ch·∫ø ƒë·ªô h·ªçc t·∫≠p</li>
                            <li>Luy·ªán ph√°t √¢m b·∫±ng c√°ch nghe v√† l·∫∑p l·∫°i</li>
                            <li>H·ªçc thu·ªôc c√°c m·∫´u c√¢u tr·∫£ l·ªùi ng·∫Øn</li>
                            <li>Th·ª±c h√†nh th∆∞·ªùng xuy√™n m·ªói ng√†y</li>
                        </ul>
                    </div>
                    
                    <div class="controls" style="margin-top: 30px;">
                        <button class="btn btn-primary" onclick="startTestMode()">üîÑ L√†m l·∫°i test</button>
                        <button class="btn btn-success" onclick="startStudyMode()">üìö √în luy·ªán</button>
                        <button class="btn btn-danger" onclick="backToMenu()">üè† V·ªÅ menu</button>
                    </div>
                </div>
            `;
      }

      // V·ªÅ menu ch√≠nh - d·ª´ng t·∫•t c·∫£ ti·∫øng
      function backToMenu() {
        speechSynthesis.cancel(); // D·ª´ng ti·∫øng ƒëang ph√°t
        clearInterval(timer);
        document.getElementById("timer").classList.add("hidden");
        document.getElementById("modeSelector").classList.remove("hidden");

        const content = document.getElementById("studyContent");
        content.innerHTML = `
                <div class="tips">
                    <h3>üí° M·∫πo h·ªçc t·∫≠p hi·ªáu qu·∫£:</h3>
                    <ul>
                        <li>Nghe v√† l·∫∑p l·∫°i nhi·ªÅu l·∫ßn ƒë·ªÉ c·∫£i thi·ªán ph√°t √¢m</li>
                        <li>Ch√∫ √Ω ng·ªØ ph√°p: ƒë·ªông t·ª´ chia theo ng√¥i (ich spiele, Sie spielen)</li>
                        <li>H·ªçc thu·ªôc c√°c c·ª•m t·ª´ c∆° b·∫£n: "am Wochenende", "mit meinen Freunden"</li>
                        <li>C√¢u tr·∫£ l·ªùi ng·∫Øn g·ªçn nh∆∞ng ƒë·∫ßy ƒë·ªß √Ω</li>
                    </ul>
                </div>
            `;

        // Reset c√°c bi·∫øn
        currentIndex = 0;
        currentTopic = "";
        showAnswer = false;
        score = 0;
        totalQuestions = 0;
        timeLeft = 120;
      }

      // Kh·ªüi t·∫°o ·ª©ng d·ª•ng
      function initApp() {
        // Ki·ªÉm tra h·ªó tr·ª£ Speech Synthesis
        if (!("speechSynthesis" in window)) {
          console.warn("Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ text-to-speech");
        }

        // Th√™m keyboard shortcuts
        document.addEventListener("keydown", function (e) {
          if (currentMode === "study") {
            if (e.key === "ArrowRight" || e.key === " ") {
              e.preventDefault();
              nextCard();
            } else if (e.key === "ArrowLeft") {
              e.preventDefault();
              previousCard();
            } else if (e.key === "Enter") {
              e.preventDefault();
              toggleAnswer();
            }
          } else if (currentMode === "test" && showAnswer) {
            if (e.key === "1") {
              e.preventDefault();
              markCorrect();
            } else if (e.key === "2") {
              e.preventDefault();
              markIncorrect();
            }
          }

          if (e.key === "Escape") {
            e.preventDefault();
            backToMenu();
          }
        });
      }

      // Kh·ªüi t·∫°o khi trang load
      window.addEventListener("load", initApp);
    </script>
  </body>
</html>
