<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tr√≤ ch∆°i Bu·ªïi 1 - Gi·ªõi thi·ªáu b·∫£n th√¢n</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: #333;
        padding: 20px;
      }

      .container {
        max-width: 1000px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
      }

      .header {
        text-align: center;
        margin-bottom: 30px;
      }

      .header h1 {
        font-size: 2.5em;
        color: #4a47a3;
        margin-bottom: 10px;
      }

      .subtitle {
        font-size: 1.2em;
        color: #666;
        margin-bottom: 20px;
      }

      .back-to-index {
        position: fixed;
        bottom: 30px;
        right: 30px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 50px;
        padding: 15px 25px;
        font-size: 1em;
        font-weight: bold;
        cursor: pointer;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        transition: all 0.3s ease;
        opacity: 0;
        visibility: hidden;
        transform: translateY(100px);
        z-index: 1000;
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .back-to-index.visible {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      .back-to-index:hover {
        background: linear-gradient(135deg, #5a6fd8 0%, #6a42a0 100%);
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
      }

      .game-menu {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .game-card {
        background: linear-gradient(135deg, #f8f9ff 0%, #e3f2fd 100%);
        border: 2px solid #2196f3;
        border-radius: 15px;
        padding: 25px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .game-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        border-color: #1976d2;
      }

      .game-card.active {
        border-color: #4caf50;
        background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
      }

      .game-icon {
        font-size: 3em;
        margin-bottom: 15px;
      }

      .game-title {
        font-size: 1.3em;
        font-weight: bold;
        color: #1976d2;
        margin-bottom: 10px;
      }

      .game-description {
        color: #666;
        margin-bottom: 15px;
        line-height: 1.5;
      }

      .game-stats {
        font-size: 0.9em;
        color: #888;
      }

      .game-area {
        display: none;
        min-height: 400px;
      }

      .game-area.active {
        display: block;
      }

      .game-header {
        background: linear-gradient(135deg, #2196f3 0%, #1976d2 100%);
        color: white;
        padding: 20px;
        border-radius: 15px;
        margin-bottom: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 15px;
      }

      .game-info h3 {
        margin-bottom: 5px;
      }

      .game-controls {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s ease;
      }

      .btn-primary {
        background: #4caf50;
        color: white;
      }

      .btn-primary:hover {
        background: #45a049;
      }

      .btn-secondary {
        background: #f44336;
        color: white;
      }

      .btn-secondary:hover {
        background: #da190b;
      }

      .btn-back {
        background: #ff9800;
        color: white;
      }

      .btn-back:hover {
        background: #e68900;
      }

      /* Game 1: Flash Cards */
      .flashcard {
        background: white;
        border: 3px solid #2196f3;
        border-radius: 15px;
        padding: 40px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        min-height: 300px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        position: relative;
      }

      .flashcard:hover {
        transform: scale(1.02);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      }

      .flashcard.flipped {
        background: #e8f5e8;
        border-color: #4caf50;
      }

      .card-content {
        font-size: 2em;
        margin-bottom: 20px;
        font-weight: bold;
      }

      .card-pronunciation {
        font-size: 1.2em;
        color: #8e44ad;
        margin-bottom: 15px;
        font-style: italic;
      }

      .card-translation {
        font-size: 1.5em;
        color: #27ae60;
        font-weight: bold;
      }

      .card-hint {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        color: #666;
        font-size: 0.9em;
      }

      /* Game 2: Memory Game */
      .memory-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 15px;
        max-width: 600px;
        margin: 0 auto;
      }

      .memory-card {
        aspect-ratio: 1;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
        color: white;
        font-weight: bold;
        position: relative;
        overflow: hidden;
      }

      .memory-card:hover {
        transform: scale(1.05);
      }

      .memory-card.flipped {
        background: white;
        color: #333;
        border: 2px solid #2196f3;
      }

      .memory-card.matched {
        background: #4caf50;
        color: white;
      }

      .memory-card-content {
        font-size: 1.1em;
        text-align: center;
        padding: 10px;
      }

      /* Game 3: Quiz */
      .quiz-question {
        background: #f8f9ff;
        border: 2px solid #2196f3;
        border-radius: 15px;
        padding: 30px;
        margin-bottom: 20px;
        text-align: center;
      }

      .quiz-question h3 {
        color: #1976d2;
        margin-bottom: 20px;
        font-size: 1.5em;
      }

      .quiz-options {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 20px;
      }

      .quiz-option {
        background: white;
        border: 2px solid #dee2e6;
        border-radius: 10px;
        padding: 15px;
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: center;
      }

      .quiz-option:hover {
        border-color: #2196f3;
        background: #e3f2fd;
      }

      .quiz-option.correct {
        border-color: #4caf50;
        background: #e8f5e8;
        color: #155724;
      }

      .quiz-option.wrong {
        border-color: #f44336;
        background: #ffebee;
        color: #721c24;
      }

      .score-display {
        text-align: center;
        font-size: 1.2em;
        margin: 20px 0;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 10px;
      }

      /* Responsive */
      @media (max-width: 768px) {
        .container {
          padding: 20px;
          margin: 10px;
        }

        .header h1 {
          font-size: 2em;
        }

        .memory-grid {
          grid-template-columns: repeat(3, 1fr);
          gap: 10px;
        }

        .quiz-options {
          grid-template-columns: 1fr;
        }

        .back-to-index {
          bottom: 20px;
          right: 20px;
          padding: 12px 20px;
          font-size: 0.9em;
        }
      }

      @media (max-width: 480px) {
        .memory-grid {
          grid-template-columns: repeat(2, 1fr);
        }

        .flashcard {
          padding: 20px;
          min-height: 250px;
        }

        .card-content {
          font-size: 1.5em;
        }

        .back-to-index {
          padding: 10px 15px;
          font-size: 0.8em;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üéÆ Tr√≤ ch∆°i Bu·ªïi 1</h1>
        <div class="subtitle">
          Gi·ªõi thi·ªáu b·∫£n th√¢n - Luy·ªán t·∫≠p t·ª´ v·ª±ng th√∫ v·ªã
        </div>
      </div>

      <div class="game-menu" id="gameMenu">
        <div class="game-card" onclick="startGame('flashcards')">
          <div class="game-icon">üÉè</div>
          <div class="game-title">Th·∫ª ghi nh·ªõ</div>
          <div class="game-description">
            L·∫≠t th·∫ª ƒë·ªÉ xem nghƒ©a ti·∫øng Vi·ªát. H·ªçc t·ª´ v·ª±ng m·ªôt c√°ch tr·ª±c quan v√†
            hi·ªáu qu·∫£.
          </div>
          <div class="game-stats">üìö 20 t·ª´ ‚Ä¢ ‚è±Ô∏è 10 ph√∫t</div>
        </div>

        <div class="game-card" onclick="startGame('memory')">
          <div class="game-icon">üß†</div>
          <div class="game-title">Tr√≤ ch∆°i ghi nh·ªõ</div>
          <div class="game-description">
            T√¨m c·∫∑p t·ª´ ti·∫øng ƒê·ª©c v√† nghƒ©a ti·∫øng Vi·ªát. R√®n luy·ªán tr√≠ nh·ªõ v√† t·ª´
            v·ª±ng.
          </div>
          <div class="game-stats">üéØ 8 c·∫∑p ‚Ä¢ ‚è±Ô∏è 15 ph√∫t</div>
        </div>

        <div class="game-card" onclick="startGame('quiz')">
          <div class="game-icon">‚ùì</div>
          <div class="game-title">C√¢u h·ªèi tr·∫Øc nghi·ªám</div>
          <div class="game-description">
            Tr·∫£ l·ªùi c√¢u h·ªèi v·ªÅ t·ª´ v·ª±ng v√† ng·ªØ ph√°p c∆° b·∫£n. Ki·ªÉm tra ki·∫øn th·ª©c ƒë√£
            h·ªçc.
          </div>
          <div class="game-stats">üìù 15 c√¢u ‚Ä¢ ‚è±Ô∏è 12 ph√∫t</div>
        </div>

        <div class="game-card" onclick="startGame('listening')">
          <div class="game-icon">üéß</div>
          <div class="game-title">Luy·ªán nghe</div>
          <div class="game-description">
            Nghe t·ª´ ti·∫øng ƒê·ª©c v√† ch·ªçn nghƒ©a ƒë√∫ng. R√®n luy·ªán kh·∫£ nƒÉng nh·∫≠n bi·∫øt
            √¢m thanh.
          </div>
          <div class="game-stats">üîä 12 t·ª´ ‚Ä¢ ‚è±Ô∏è 8 ph√∫t</div>
        </div>
      </div>

      <!-- Flashcards Game -->
      <div class="game-area" id="flashcardsGame">
        <div class="game-header">
          <div class="game-info">
            <h3>üÉè Th·∫ª ghi nh·ªõ</h3>
            <p>
              Th·∫ª <span id="currentCard">1</span> /
              <span id="totalCards">20</span>
            </p>
          </div>
          <div class="game-controls">
            <button class="btn btn-primary" onclick="prevCard()">
              ‚¨ÖÔ∏è Tr∆∞·ªõc
            </button>
            <button class="btn btn-primary" onclick="nextCard()">
              Ti·∫øp ‚û°Ô∏è
            </button>
            <button class="btn btn-back" onclick="backToMenu()">üè† Menu</button>
          </div>
        </div>

        <div class="flashcard" id="flashcard" onclick="flipCard()">
          <div class="card-content" id="cardContent">ich</div>
          <div class="card-pronunciation" id="cardPronunciation">[√≠ch]</div>
          <div
            class="card-translation"
            id="cardTranslation"
            style="display: none"
          >
            t√¥i
          </div>
          <div class="card-hint">üí° B·∫•m ƒë·ªÉ xem nghƒ©a</div>
        </div>
      </div>

      <!-- Memory Game -->
      <div class="game-area" id="memoryGame">
        <div class="game-header">
          <div class="game-info">
            <h3>üß† Tr√≤ ch∆°i ghi nh·ªõ</h3>
            <p>
              ƒêi·ªÉm: <span id="memoryScore">0</span> ‚Ä¢ L∆∞·ª£t:
              <span id="memoryMoves">0</span>
            </p>
          </div>
          <div class="game-controls">
            <button class="btn btn-primary" onclick="resetMemory()">
              üîÑ Ch∆°i l·∫°i
            </button>
            <button class="btn btn-back" onclick="backToMenu()">üè† Menu</button>
          </div>
        </div>

        <div class="memory-grid" id="memoryGrid">
          <!-- Memory cards will be generated by JavaScript -->
        </div>
      </div>

      <!-- Quiz Game -->
      <div class="game-area" id="quizGame">
        <div class="game-header">
          <div class="game-info">
            <h3>‚ùì C√¢u h·ªèi tr·∫Øc nghi·ªám</h3>
            <p>
              C√¢u <span id="currentQuestion">1</span> /
              <span id="totalQuestions">15</span>
            </p>
          </div>
          <div class="game-controls">
            <button
              class="btn btn-primary"
              onclick="nextQuestion()"
              id="nextBtn"
              style="display: none"
            >
              Ti·∫øp ‚û°Ô∏è
            </button>
            <button class="btn btn-back" onclick="backToMenu()">üè† Menu</button>
          </div>
        </div>

        <div class="quiz-question" id="quizQuestion">
          <h3 id="questionText">T·ª´ "ich" c√≥ nghƒ©a l√† g√¨?</h3>
          <div class="quiz-options" id="quizOptions">
            <!-- Options will be generated by JavaScript -->
          </div>
        </div>

        <div class="score-display" id="quizScore" style="display: none">
          ƒêi·ªÉm c·ªßa b·∫°n: <span id="finalScore">0</span>/15
        </div>
      </div>

      <!-- Listening Game -->
      <div class="game-area" id="listeningGame">
        <div class="game-header">
          <div class="game-info">
            <h3>üéß Luy·ªán nghe</h3>
            <p>
              T·ª´ <span id="currentListening">1</span> /
              <span id="totalListening">12</span>
            </p>
          </div>
          <div class="game-controls">
            <button class="btn btn-primary" onclick="playAudio()" id="playBtn">
              üîä Nghe l·∫°i
            </button>
            <button
              class="btn btn-primary"
              onclick="nextListening()"
              id="nextListeningBtn"
              style="display: none"
            >
              Ti·∫øp ‚û°Ô∏è
            </button>
            <button class="btn btn-back" onclick="backToMenu()">üè† Menu</button>
          </div>
        </div>

        <div class="quiz-question">
          <h3>üéß Nghe v√† ch·ªçn nghƒ©a ƒë√∫ng:</h3>
          <div class="quiz-options" id="listeningOptions">
            <!-- Options will be generated by JavaScript -->
          </div>
        </div>

        <div class="score-display" id="listeningScore" style="display: none">
          ƒêi·ªÉm nghe: <span id="finalListeningScore">0</span>/12
        </div>
      </div>
    </div>

    <!-- Back to Index Button -->
    <a href="index.html" class="back-to-index" id="backToIndex">
      üè† V·ªÅ trang ch·ªß
    </a>

    <script>
      // Vocabulary data for games
      const vocabulary = [
        { german: "ich", pronunciation: "[√≠ch]", vietnamese: "t√¥i" },
        { german: "bin", pronunciation: "[bin]", vietnamese: "l√†" },
        { german: "hei√üe", pronunciation: "[hai-s∆°]", vietnamese: "t√™n l√†" },
        { german: "Hallo", pronunciation: "[ha-l√¥]", vietnamese: "xin ch√†o" },
        { german: "Tsch√ºs", pronunciation: "[ch√∫y-s]", vietnamese: "t·∫°m bi·ªát" },
        { german: "komme", pronunciation: "[c√¥-m∆°]", vietnamese: "ƒë·∫øn t·ª´" },
        { german: "spreche", pronunciation: "[spre-xe]", vietnamese: "n√≥i" },
        { german: "aus", pronunciation: "[aus]", vietnamese: "t·ª´" },
        { german: "und", pronunciation: "[unt]", vietnamese: "v√†" },
        { german: "mein", pronunciation: "[main]", vietnamese: "c·ªßa t√¥i" },
        { german: "Name", pronunciation: "[na-m∆°]", vietnamese: "t√™n" },
        { german: "ja", pronunciation: "[ya]", vietnamese: "c√≥" },
        { german: "nein", pronunciation: "[nain]", vietnamese: "kh√¥ng" },
        { german: "okay", pronunciation: "[√¥-k√¢y]", vietnamese: "ƒë∆∞·ª£c r·ªìi" },
        { german: "bitte", pronunciation: "[bi-t∆°]", vietnamese: "l√†m ∆°n" },
        {
          german: "Deutschland",
          pronunciation: "[ƒê√≥i-t-lant]",
          vietnamese: "n∆∞·ªõc ƒê·ª©c",
        },
        {
          german: "Englisch",
          pronunciation: "[√âng-l√≠t]",
          vietnamese: "ti·∫øng Anh",
        },
        { german: "Mama", pronunciation: "[Ma-ma]", vietnamese: "m·∫π" },
        { german: "Wie", pronunciation: "[v√¨]", vietnamese: "nh∆∞ th·∫ø n√†o" },
        { german: "Was", pronunciation: "[v√°t]", vietnamese: "c√°i g√¨" },
      ];

      let currentGameData = {};

      // Back to index button visibility
      const backToIndexBtn = document.getElementById("backToIndex");

      window.addEventListener("scroll", () => {
        if (window.scrollY > 300) {
          backToIndexBtn.classList.add("visible");
        } else {
          backToIndexBtn.classList.remove("visible");
        }
      });

      // Game control functions
      function startGame(gameType) {
        document.getElementById("gameMenu").style.display = "none";
        document
          .querySelectorAll(".game-area")
          .forEach((area) => area.classList.remove("active"));

        switch (gameType) {
          case "flashcards":
            document.getElementById("flashcardsGame").classList.add("active");
            initFlashcards();
            break;
          case "memory":
            document.getElementById("memoryGame").classList.add("active");
            initMemoryGame();
            break;
          case "quiz":
            document.getElementById("quizGame").classList.add("active");
            initQuizGame();
            break;
          case "listening":
            document.getElementById("listeningGame").classList.add("active");
            initListeningGame();
            break;
        }
      }

      function backToMenu() {
        document
          .querySelectorAll(".game-area")
          .forEach((area) => area.classList.remove("active"));
        document.getElementById("gameMenu").style.display = "grid";
      }

      // Flashcards Game
      function initFlashcards() {
        currentGameData.flashcards = {
          currentIndex: 0,
          cards: vocabulary.slice(0, 20),
          isFlipped: false,
        };

        document.getElementById("totalCards").textContent =
          currentGameData.flashcards.cards.length;
        showFlashcard();
      }

      function showFlashcard() {
        const data = currentGameData.flashcards;
        const card = data.cards[data.currentIndex];

        document.getElementById("currentCard").textContent =
          data.currentIndex + 1;
        document.getElementById("cardContent").textContent = card.german;
        document.getElementById("cardPronunciation").textContent =
          card.pronunciation;
        document.getElementById("cardTranslation").textContent =
          card.vietnamese;

        // Reset card state
        document.getElementById("flashcard").classList.remove("flipped");
        document.getElementById("cardTranslation").style.display = "none";
        data.isFlipped = false;
      }

      function flipCard() {
        const data = currentGameData.flashcards;
        const flashcard = document.getElementById("flashcard");
        const translation = document.getElementById("cardTranslation");

        if (!data.isFlipped) {
          flashcard.classList.add("flipped");
          translation.style.display = "block";
          data.isFlipped = true;
        }
      }

      function nextCard() {
        const data = currentGameData.flashcards;
        if (data.currentIndex < data.cards.length - 1) {
          data.currentIndex++;
          showFlashcard();
        }
      }

      function prevCard() {
        const data = currentGameData.flashcards;
        if (data.currentIndex > 0) {
          data.currentIndex--;
          showFlashcard();
        }
      }

      // Memory Game
      function initMemoryGame() {
        const cards = vocabulary.slice(0, 8);
        const memoryCards = [];

        // Create pairs (German word + Vietnamese meaning)
        cards.forEach((word) => {
          memoryCards.push({
            type: "german",
            content: word.german,
            id: word.german,
          });
          memoryCards.push({
            type: "vietnamese",
            content: word.vietnamese,
            id: word.german,
          });
        });

        // Shuffle cards
        for (let i = memoryCards.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [memoryCards[i], memoryCards[j]] = [memoryCards[j], memoryCards[i]];
        }

        currentGameData.memory = {
          cards: memoryCards,
          flippedCards: [],
          matchedPairs: 0,
          moves: 0,
          score: 0,
        };

        renderMemoryGrid();
      }

      function renderMemoryGrid() {
        const grid = document.getElementById("memoryGrid");
        grid.innerHTML = "";

        currentGameData.memory.cards.forEach((card, index) => {
          const cardElement = document.createElement("div");
          cardElement.className = "memory-card";
          cardElement.innerHTML = `<div class="memory-card-content">?</div>`;
          cardElement.onclick = () => flipMemoryCard(index);
          grid.appendChild(cardElement);
        });
      }

      function flipMemoryCard(index) {
        const data = currentGameData.memory;

        if (data.flippedCards.length === 2 || data.flippedCards.includes(index))
          return;

        const cardElement = document.querySelectorAll(".memory-card")[index];
        const card = data.cards[index];

        cardElement.classList.add("flipped");
        cardElement.querySelector(".memory-card-content").textContent =
          card.content;
        data.flippedCards.push(index);

        if (data.flippedCards.length === 2) {
          data.moves++;
          document.getElementById("memoryMoves").textContent = data.moves;

          setTimeout(() => checkMemoryMatch(), 1000);
        }
      }

      function checkMemoryMatch() {
        const data = currentGameData.memory;
        const [first, second] = data.flippedCards;
        const firstCard = data.cards[first];
        const secondCard = data.cards[second];

        if (firstCard.id === secondCard.id) {
          // Match found
          document
            .querySelectorAll(".memory-card")
            [first].classList.add("matched");
          document
            .querySelectorAll(".memory-card")
            [second].classList.add("matched");
          data.matchedPairs++;
          data.score += 10;

          if (data.matchedPairs === 8) {
            setTimeout(
              () => alert("üéâ Ch√∫c m·ª´ng! B·∫°n ƒë√£ ho√†n th√†nh tr√≤ ch∆°i!"),
              500
            );
          }
        } else {
          // No match
          const firstElement = document.querySelectorAll(".memory-card")[first];
          const secondElement =
            document.querySelectorAll(".memory-card")[second];

          firstElement.classList.remove("flipped");
          secondElement.classList.remove("flipped");
          firstElement.querySelector(".memory-card-content").textContent = "?";
          secondElement.querySelector(".memory-card-content").textContent = "?";
        }

        document.getElementById("memoryScore").textContent = data.score;
        data.flippedCards = [];
      }

      function resetMemory() {
        initMemoryGame();
        document.getElementById("memoryScore").textContent = "0";
        document.getElementById("memoryMoves").textContent = "0";
      }

      // Quiz Game
      function initQuizGame() {
        const questions = [];

        vocabulary.slice(0, 15).forEach((word) => {
          const wrongAnswers = vocabulary
            .filter((w) => w.vietnamese !== word.vietnamese)
            .sort(() => Math.random() - 0.5)
            .slice(0, 3)
            .map((w) => w.vietnamese);

          const options = [word.vietnamese, ...wrongAnswers].sort(
            () => Math.random() - 0.5
          );

          questions.push({
            question: `T·ª´ "${word.german}" c√≥ nghƒ©a l√† g√¨?`,
            options: options,
            correct: word.vietnamese,
          });
        });

        currentGameData.quiz = {
          questions: questions,
          currentIndex: 0,
          score: 0,
          answered: false,
        };

        document.getElementById("totalQuestions").textContent =
          questions.length;
        showQuizQuestion();
      }

      function showQuizQuestion() {
        const data = currentGameData.quiz;
        const question = data.questions[data.currentIndex];

        document.getElementById("currentQuestion").textContent =
          data.currentIndex + 1;
        document.getElementById("questionText").textContent = question.question;

        const optionsContainer = document.getElementById("quizOptions");
        optionsContainer.innerHTML = "";

        question.options.forEach((option) => {
          const optionElement = document.createElement("div");
          optionElement.className = "quiz-option";
          optionElement.textContent = option;
          optionElement.onclick = () =>
            selectQuizOption(option, question.correct);
          optionsContainer.appendChild(optionElement);
        });

        data.answered = false;
        document.getElementById("nextBtn").style.display = "none";
      }

      function selectQuizOption(selected, correct) {
        if (currentGameData.quiz.answered) return;

        currentGameData.quiz.answered = true;

        document.querySelectorAll(".quiz-option").forEach((option) => {
          if (option.textContent === correct) {
            option.classList.add("correct");
          } else if (option.textContent === selected && selected !== correct) {
            option.classList.add("wrong");
          }
        });

        if (selected === correct) {
          currentGameData.quiz.score++;
        }

        setTimeout(() => {
          document.getElementById("nextBtn").style.display = "inline-block";
        }, 1000);
      }

      function nextQuestion() {
        const data = currentGameData.quiz;

        if (data.currentIndex < data.questions.length - 1) {
          data.currentIndex++;
          showQuizQuestion();
        } else {
          // Show final score
          document.getElementById("quizQuestion").style.display = "none";
          document.getElementById("nextBtn").style.display = "none";
          document.getElementById("quizScore").style.display = "block";
          document.getElementById("finalScore").textContent = data.score;
        }
      }

      // Listening Game
      function initListeningGame() {
        const listeningWords = vocabulary.slice(0, 12);

        currentGameData.listening = {
          words: listeningWords,
          currentIndex: 0,
          score: 0,
          answered: false,
        };

        document.getElementById("totalListening").textContent =
          listeningWords.length;
        showListeningQuestion();
      }

      function showListeningQuestion() {
        const data = currentGameData.listening;
        const word = data.words[data.currentIndex];

        document.getElementById("currentListening").textContent =
          data.currentIndex + 1;

        // Create wrong answers
        const wrongAnswers = vocabulary
          .filter((w) => w.vietnamese !== word.vietnamese)
          .sort(() => Math.random() - 0.5)
          .slice(0, 3)
          .map((w) => w.vietnamese);

        const options = [word.vietnamese, ...wrongAnswers].sort(
          () => Math.random() - 0.5
        );

        const optionsContainer = document.getElementById("listeningOptions");
        optionsContainer.innerHTML = "";

        options.forEach((option) => {
          const optionElement = document.createElement("div");
          optionElement.className = "quiz-option";
          optionElement.textContent = option;
          optionElement.onclick = () =>
            selectListeningOption(option, word.vietnamese);
          optionsContainer.appendChild(optionElement);
        });

        data.answered = false;
        document.getElementById("nextListeningBtn").style.display = "none";

        // Auto play audio
        setTimeout(() => playAudio(), 500);
      }

      function playAudio() {
        const data = currentGameData.listening;
        const word = data.words[data.currentIndex];

        const utterance = new SpeechSynthesisUtterance(word.german);
        utterance.lang = "de-DE";
        utterance.rate = 0.8;
        speechSynthesis.speak(utterance);
      }

      function selectListeningOption(selected, correct) {
        if (currentGameData.listening.answered) return;

        currentGameData.listening.answered = true;

        document
          .querySelectorAll("#listeningOptions .quiz-option")
          .forEach((option) => {
            if (option.textContent === correct) {
              option.classList.add("correct");
            } else if (
              option.textContent === selected &&
              selected !== correct
            ) {
              option.classList.add("wrong");
            }
          });

        if (selected === correct) {
          currentGameData.listening.score++;
        }

        setTimeout(() => {
          document.getElementById("nextListeningBtn").style.display =
            "inline-block";
        }, 1000);
      }

      function nextListening() {
        const data = currentGameData.listening;

        if (data.currentIndex < data.words.length - 1) {
          data.currentIndex++;
          showListeningQuestion();
        } else {
          // Show final score
          document.querySelector(
            "#listeningGame .quiz-question"
          ).style.display = "none";
          document.getElementById("nextListeningBtn").style.display = "none";
          document.getElementById("listeningScore").style.display = "block";
          document.getElementById("finalListeningScore").textContent =
            data.score;
        }
      }

      // Initialize back to index button
      setTimeout(() => {
        backToIndexBtn.classList.add("visible");
      }, 1000);
    </script>
  </body>
</html>
