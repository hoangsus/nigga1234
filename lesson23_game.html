<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Luy·ªán t·∫≠p t·ª´ v·ª±ng ti·∫øng ƒê·ª©c</title>
    <style>
      body {
        font-family: "Arial", sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        margin: 0;
        padding: 20px;
        min-height: 100vh;
      }

      .container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        border-radius: 15px;
        padding: 30px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      }

      h1 {
        text-align: center;
        color: #333;
        margin-bottom: 30px;
        font-size: 2.5em;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      }

      .controls {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-bottom: 30px;
        flex-wrap: wrap;
      }

      button {
        padding: 12px 24px;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        font-size: 16px;
        font-weight: bold;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .mode-btn {
        background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        color: white;
      }

      .mode-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      .mode-btn.active {
        background: linear-gradient(45deg, #2ecc71, #27ae60);
      }

      .category-btn {
        background: linear-gradient(45deg, #3498db, #2980b9);
        color: white;
      }

      .category-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      .category-btn.active {
        background: linear-gradient(45deg, #e74c3c, #c0392b);
      }

      .quiz-container {
        background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        border-radius: 15px;
        padding: 30px;
        margin-bottom: 20px;
        box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .progress-bar {
        background: #ddd;
        border-radius: 10px;
        height: 20px;
        margin-bottom: 20px;
        overflow: hidden;
      }

      .progress-fill {
        background: linear-gradient(45deg, #2ecc71, #27ae60);
        height: 100%;
        border-radius: 10px;
        transition: width 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 14px;
      }

      .question {
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        margin-bottom: 20px;
        color: #2c3e50;
        padding: 20px;
        background: white;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .speaker-btn {
        background: linear-gradient(45deg, #f39c12, #e67e22);
        color: white;
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        font-size: 24px;
        cursor: pointer;
        margin: 10px;
        transition: all 0.3s ease;
      }

      .speaker-btn:hover {
        transform: scale(1.1);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      .input-container {
        text-align: center;
        margin-bottom: 20px;
      }

      input[type="text"] {
        padding: 15px;
        font-size: 18px;
        border: 2px solid #ddd;
        border-radius: 10px;
        width: 300px;
        max-width: 90%;
        text-align: center;
        transition: border-color 0.3s ease;
      }

      input[type="text"]:focus {
        outline: none;
        border-color: #3498db;
        box-shadow: 0 0 10px rgba(52, 152, 219, 0.3);
      }

      .feedback {
        text-align: center;
        font-size: 18px;
        font-weight: bold;
        margin: 20px 0;
        padding: 15px;
        border-radius: 10px;
        transition: all 0.3s ease;
      }

      .correct {
        background: linear-gradient(45deg, #2ecc71, #27ae60);
        color: white;
      }

      .incorrect {
        background: linear-gradient(45deg, #e74c3c, #c0392b);
        color: white;
      }

      .stats {
        display: flex;
        justify-content: space-around;
        background: #34495e;
        color: white;
        padding: 20px;
        border-radius: 10px;
        margin-top: 20px;
      }

      .stat-item {
        text-align: center;
      }

      .stat-number {
        font-size: 24px;
        font-weight: bold;
        display: block;
      }

      .vocab-list {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 15px;
        margin-top: 20px;
      }

      .vocab-item {
        background: white;
        padding: 15px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        border-left: 4px solid #3498db;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .vocab-content {
        flex: 1;
      }

      .vocab-item strong {
        color: #2c3e50;
      }

      .next-btn {
        background: linear-gradient(45deg, #9b59b6, #8e44ad);
        color: white;
        padding: 15px 30px;
        font-size: 18px;
      }

      .next-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      .reset-btn {
        background: linear-gradient(45deg, #e67e22, #d35400);
        color: white;
        padding: 10px 20px;
        font-size: 14px;
      }

      .completed {
        text-align: center;
        font-size: 24px;
        color: #2ecc71;
        font-weight: bold;
        padding: 40px;
      }

      @media (max-width: 600px) {
        .container {
          padding: 20px;
        }

        h1 {
          font-size: 2em;
        }

        .controls {
          flex-direction: column;
          align-items: center;
        }

        input[type="text"] {
          width: 90%;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üá©üá™ Luy·ªán t·∫≠p t·ª´ v·ª±ng ti·∫øng ƒê·ª©c</h1>

      <div class="controls">
        <button
          class="mode-btn active"
          onclick="setMode('vietnamese-to-german')"
        >
          Vi·ªát ‚Üí ƒê·ª©c
        </button>
        <button class="mode-btn" onclick="setMode('german-to-vietnamese')">
          ƒê·ª©c ‚Üí Vi·ªát
        </button>
        <button class="mode-btn" onclick="setMode('study')">Xem t·ª´ v·ª±ng</button>
      </div>

      <div class="controls">
        <button class="category-btn active" onclick="setCategory('all')">
          T·∫•t c·∫£
        </button>
        <button class="category-btn" onclick="setCategory('time')">
          Th·ªùi gian
        </button>
        <button class="category-btn" onclick="setCategory('family')">
          Gia ƒë√¨nh
        </button>
        <button class="category-btn" onclick="setCategory('daily')">
          H√†ng ng√†y
        </button>
        <button class="reset-btn" onclick="resetProgress()">L√†m l·∫°i</button>
      </div>

      <div id="quiz-mode" class="quiz-container">
        <div class="progress-bar">
          <div class="progress-fill" id="progress-fill">0/0</div>
        </div>

        <div class="question" id="question"></div>
        <div class="input-container">
          <input
            type="text"
            id="answer"
            placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi..."
            onkeypress="checkEnter(event)"
          />
        </div>
        <div class="input-container">
          <button class="next-btn" onclick="checkAnswer()">Ki·ªÉm tra</button>
          <button
            class="next-btn"
            onclick="nextQuestion()"
            id="next-btn"
            style="display: none"
          >
            C√¢u ti·∫øp theo
          </button>
        </div>
        <div class="feedback" id="feedback"></div>

        <div id="completed" class="completed" style="display: none">
          üéâ Ch√∫c m·ª´ng! B·∫°n ƒë√£ ho√†n th√†nh t·∫•t c·∫£ t·ª´ v·ª±ng!<br />
          <button
            class="next-btn"
            onclick="resetProgress()"
            style="margin-top: 20px"
          >
            L√†m l·∫°i
          </button>
        </div>
      </div>

      <div id="study-mode" class="vocab-list" style="display: none"></div>

      <div class="stats">
        <div class="stat-item">
          <span class="stat-number" id="correct-count">0</span>
          <span>ƒê√∫ng</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" id="total-count">0</span>
          <span>T·ªïng s·ªë</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" id="accuracy">0%</span>
          <span>ƒê·ªô ch√≠nh x√°c</span>
        </div>
      </div>
    </div>

    <script>
      // T·ª´ v·ª±ng theo ƒë√∫ng th·ª© t·ª± trong h√¨nh ·∫£nh
      const vocabulary = {
        time: [
          // H√¨nh 1 - Time related vocabulary
          { vi: "G·∫ßn tr∆∞·ªõc 4h", de: "kurz vor vier" },
          { vi: "ƒê√∫ng 4h", de: "gleich vier" },
          { vi: "ƒê√∫ng 4h", de: "genau vier Uhr" },
          { vi: "4:05", de: "f√ºnf (Minuten) nach vier" },
          { vi: "B√¢y gi·ªù l√† 14:30", de: "Es ist vierzehn Uhr drei√üig" },
          { vi: "B√¢y gi·ªù l√† 2:30", de: "Es ist halb drei" },
          { vi: "3h", de: "um drei Uhr" },
          { vi: "T·ª´ 2 ‚Üí 3h", de: "von zwei bis drei Uhr" },
          { vi: "T·ª´ 3h", de: "ab drei Uhr" },
          { vi: "B·∫Øt ƒë·∫ßu", de: "anfangen" },
          { vi: "Kh·ªüi ƒë·∫ßu", de: "der Anfang" },
          { vi: "D·ª´ng l·∫°i", de: "aufh√∂ren" },
          { vi: "K·∫øt Th√∫c", de: "das Ende" },
          { vi: "K√©o d√†i", de: "dauern" },
          { vi: "T√™n", de: "der Vorname" },
          { vi: "T√™n ƒë·ªám", de: "der Familienname" },
          { vi: "H·ªç T√™n", de: "der Nachname" },
          // H√¨nh 3 - Days and time
          { vi: "ƒêi·ªán Tho·∫°i", de: "das Telefon" },
          { vi: "G·ªçi ƒëi·ªán", de: "telefonieren" },
          { vi: "G·ªçi", de: "anrufen" },
          { vi: "Email", de: "die E-mail" },
          { vi: "Tu·∫ßn", de: "die Woche" },
          { vi: "Th·ª© 2", de: "Montag" },
          { vi: "Th·ª© 3", de: "Dienstag" },
          { vi: "Th·ª© 4", de: "Mittwoch" },
          { vi: "Th·ª© 5", de: "Donnerstag" },
          { vi: "Th·ª© 6", de: "Freitag" },
          { vi: "Th·ª© 7", de: "Samstag" },
          { vi: "Ch·ªß Nh·∫≠t", de: "Sonntag" },
          { vi: "V√†o Ng√†y", de: "am + Tag" },
          { vi: "V√†o th·ª© 2", de: "am Montag" },
          { vi: "Cu·ªëi tu·∫ßn", de: "das Wochenende" },
          { vi: "V√†o cu·ªëi tu·∫ßn", de: "am Wochenende" },
          { vi: "Ng√†y Ngh·ªâ", de: "der Feiertag" },
          { vi: "NƒÉm th√°ng", de: "das Jahr / der Monat" },
          { vi: "Th√°ng 1", de: "Januar" },
          { vi: "Th√°ng 2", de: "Februar" },
          { vi: "Th√°ng 3", de: "M√§rz" },
          // H√¨nh 4 - More months and time
          { vi: "Th√°ng 4", de: "April" },
          { vi: "Th√°ng 5", de: "Mai" },
          { vi: "Th√°ng 6", de: "Juni" },
          { vi: "Th√°ng 7", de: "Juli" },
          { vi: "Th√°ng 8", de: "August" },
          { vi: "V√ÄO ng√†y ƒë·∫ßu th√°ng 8", de: "am ersten August" },
          { vi: "Th·ªùi gian", de: "die Uhrzeit" },
          { vi: "Khi n√†o", de: "Wann...?" },
          { vi: "M·∫•y gi·ªù?", de: "Wie sp√§t ist es?" },
          { vi: "B√¢y gi·ªù l√† m·∫•y gi·ªù?", de: "Wie viel Uhr ist es?" },
          { vi: "N√≥ l√†", de: "Es ist" },
          { vi: "1h", de: "ein Uhr" },
          { vi: "1:30", de: "halb zwei" },
          { vi: "2:45", de: "viertel vor drei" },
          { vi: "3:15", de: "viertel nach drei" },
          { vi: "3:55", de: "f√ºnf (Minuten) vor vier" },
          { vi: "Th√°ng 9", de: "September" },
          { vi: "Th√°ng 10", de: "Oktober" },
          { vi: "Th√°ng 11", de: "November" },
          { vi: "Th√°ng 12", de: "Dezember" },
          { vi: "Trong th√°ng", de: "im + Monat" },
          { vi: "Trong th√°ng 1", de: "im Januar" },
        ],
        family: [
          // H√¨nh 2 - Family and personal info
          { vi: "ƒê√°nh v·∫ßn", de: "buchstabieren" },
          { vi: "B√†", de: "die Gro√ümutter / Oma" },
          { vi: "Ng∆∞·ªùi ƒë√†n √¥ng", de: "der Mann" },
          { vi: "Qu√Ω b√†", de: "die Frau Dame" },
          { vi: "Qu√Ω √¥ng", de: "der Herr" },
          { vi: "Nam", de: "m√§nnlich" },
          { vi: "N·ªØ", de: "weiblich" },
          { vi: "C√¥ g√°i", de: "das M√§dchen" },
          { vi: "Ng∆∞·ªùi tr·∫ª", de: "die Jungen" },
          { vi: "ƒê·ªãa ch·ªâ", de: "die Adresse" },
          { vi: "N∆°i ·ªü", de: "der Wohnort" },
          { vi: "Sinh s·ªëng", de: "wohnen" },
          { vi: "S·ªëng", de: "leben" },
          { vi: "ƒê∆∞·ªùng", de: "die Stra√üe" },
          { vi: "Kh√¥ng gian", de: "der Platz" },
          { vi: "S·ªë", de: "die Nummer" },
          { vi: "S·ªë nh√†", de: "die Hausnummer" },
          { vi: "Ph·ªë", de: "die Stadt" },
          { vi: "M√£ b∆∞u ƒëi·ªán", de: "die Postleitzahl" },
          { vi: "L√†ng", de: "das Dorf" },
          { vi: "ƒê·∫•t n∆∞·ªõc", de: "das Land" },
          { vi: "Sinh ·ªü", de: "Geboren in" },
          { vi: "Tu·ªïi", de: "Jahre alt sein" },
          { vi: "30 tu·ªïi", de: "drei√üig Jahre alt" },
          { vi: "Gia ƒë√¨nh", de: "die Familie" },
          { vi: "T√¨nh tr·∫°ng h√¥n nh√¢n", de: "der Familienstand" },
          { vi: "ƒê√£ k·∫øt h√¥n", de: "verheiratet" },
          { vi: "K·∫øt h√¥n", de: "heiraten" },
          { vi: "V·ª£", de: "die Ehefrau" },
          { vi: "Ch·ªìng", de: "der Ehemann / Ehemann" },
          { vi: "ƒê√°m c∆∞·ªõi", de: "die Hochzeit" },
          { vi: "B·ªë", de: "der Vater" },
          { vi: "M·∫π", de: "die Mutter" },
          { vi: "B·ªë m·∫π", de: "die Eltern" },
          { vi: "ƒê·ª©a tr·∫ª", de: "das Kind" },
          { vi: "Em b√©", de: "das Baby" },
          { vi: "Con trai", de: "der Sohn" },
          { vi: "Con g√°i", de: "die Tochter" },
          { vi: "Anh em trai", de: "die Geschwister / der Bruder" },
          { vi: "Ch·ªã em g√°i", de: "die Schwester" },
          { vi: "Anh ch·ªã em", de: "die Geschwister" },
          { vi: "√îng", de: "der Gro√üvater / Opa" },
        ],
        daily: [
          // H√¨nh 1 - Daily vocabulary
          { vi: "Ban g√°i", de: "die Freundin" },
          { vi: "Ng∆∞·ªùi quen", de: "der / die Bekannte" },
          { vi: "Ng∆∞·ªùi L·ªõn", de: "der / die Erwachsene" },
          { vi: "Thanh thi·∫øu ni√™n", de: "der Jugendliche" },
          { vi: "Nh√† tr·∫ª", de: "der Kindergarten" },
          { vi: "H·ªô chi·∫øu", de: "der Pass" },
          { vi: "H·ªô chi·∫øu du l·ªãch", de: "der Reisepass" },
          { vi: "CMND", de: "der Ausweis" },
          { vi: "Gi·∫•y T·ªù", de: "die Papiere" },
          { vi: "M·∫´u ƒë∆°n", de: "das Formular" },
          { vi: "ƒêi·ªÅn m·∫´u ƒë∆°n", de: "ein Formular ausf√ºllen" },
          { vi: "Qu·ªëc T·ªãch", de: "die Staatsangeh√∂rigkeit" },
          { vi: "B·∫±ng l√°i xe", de: "der F√ºhrerschein" },
          { vi: "K√Ω t√™n", de: "unterschreiben" },
          { vi: "Ch·ªØ k√Ω", de: "die Unterschrift" },
          { vi: "T√¥i sinh ra v√†o", de: "Ich bin geboren am" },
          { vi: "Ng√†y sinh", de: "das Geburtsdatum" },
          { vi: "Sinh nh·∫≠t", de: "der Geburtstag" },
          { vi: "B·∫°n trai", de: "der Freund" },
          { vi: "M√πa xu√¢n", de: "der Fr√ºhling" },
          { vi: "M√πa H·∫°", de: "der Sommer" },
          { vi: "M√πa Thu", de: "der Herbst" },
          { vi: "M√πa Xu√¢n", de: "der Winter" },
          { vi: "Ng√†y", de: "der Tag" },
          { vi: "S√°ng", de: "der Morgen" },
          { vi: "Tr∆∞·ªõc Tr∆∞a", de: "der Vormittag" },
          { vi: "Bu·ªïi tr∆∞a", de: "der Mittag" },
          { vi: "Sau Tr∆∞a", de: "der Nachmittag" },
          { vi: "T·ªëi ƒë√™m", de: "der Abend / die Nacht" },
          { vi: "V√†o s√°ng", de: "am Morgen" },
          { vi: "V√†o l√∫c tr∆∞a", de: "am Vormittag" },
          { vi: "V√†o Tr∆∞a", de: "am Mittag" },
          { vi: "Chi·ªÅu v√†o sau tr∆∞a", de: "am Nachmittag" },
          { vi: "V√†o t·ªëi", de: "am Abend" },
          { vi: "Ch√∫c ng·ªß ngon", de: "in der Nacht / Gute Nacht" },
          { vi: "Ng√†y ƒë·∫ßu", de: "der erste" },
        ],
      };

      let currentMode = "vietnamese-to-german";
      let currentCategory = "all";
      let currentQuestionIndex = 0;
      let correctAnswers = 0;
      let totalQuestions = 0;
      let currentVocab = [];
      let questionOrder = [];
      let usedQuestions = new Set();

      function getAllVocabulary() {
        return [...vocabulary.time, ...vocabulary.family, ...vocabulary.daily];
      }

      function getCurrentVocabulary() {
        if (currentCategory === "all") {
          return getAllVocabulary();
        }
        return vocabulary[currentCategory] || [];
      }

      function speakText(text, lang = "de-DE") {
        if ("speechSynthesis" in window) {
          const utterance = new SpeechSynthesisUtterance(text);
          utterance.lang = lang;
          utterance.rate = 0.8;
          utterance.pitch = 1;
          speechSynthesis.speak(utterance);
        }
      }

      function setMode(mode) {
        currentMode = mode;
        document
          .querySelectorAll(".mode-btn")
          .forEach((btn) => btn.classList.remove("active"));
        event.target.classList.add("active");

        if (mode === "study") {
          document.getElementById("quiz-mode").style.display = "none";
          document.getElementById("study-mode").style.display = "grid";
          showStudyMode();
        } else {
          document.getElementById("quiz-mode").style.display = "block";
          document.getElementById("study-mode").style.display = "none";
          resetProgress();
        }
      }

      function setCategory(category) {
        currentCategory = category;
        document
          .querySelectorAll(".category-btn")
          .forEach((btn) => btn.classList.remove("active"));
        event.target.classList.add("active");

        if (currentMode === "study") {
          showStudyMode();
        } else {
          resetProgress();
        }
      }

      function showStudyMode() {
        const studyContainer = document.getElementById("study-mode");
        const vocab = getCurrentVocabulary();

        studyContainer.innerHTML = vocab
          .map(
            (item) => `
                <div class="vocab-item">
                    <div class="vocab-content">
                        <strong>üáªüá≥ ${item.vi}</strong><br>
                        <span>üá©üá™ ${item.de}</span>
                    </div>
                    <button class="speaker-btn" onclick="speakText('${item.de}')">üîä</button>
                </div>
            `
          )
          .join("");
      }

      function resetProgress() {
        currentVocab = getCurrentVocabulary();
        questionOrder = [...Array(currentVocab.length).keys()]; // [0, 1, 2, ...]
        usedQuestions = new Set();
        currentQuestionIndex = 0;
        correctAnswers = 0;
        totalQuestions = 0;

        document.getElementById("completed").style.display = "none";
        document.getElementById("question").style.display = "block";
        document.getElementById("answer").style.display = "block";
        document.querySelector(".input-container").style.display = "block";

        updateProgress();
        updateStats();
        startNewQuestion();
      }

      function updateProgress() {
        const progress = (usedQuestions.size / currentVocab.length) * 100;
        const progressFill = document.getElementById("progress-fill");
        progressFill.style.width = progress + "%";
        progressFill.textContent = `${usedQuestions.size}/${currentVocab.length}`;
      }

      function startNewQuestion() {
        if (usedQuestions.size >= currentVocab.length) {
          // Ho√†n th√†nh t·∫•t c·∫£ c√¢u h·ªèi
          document.getElementById("completed").style.display = "block";
          document.getElementById("question").style.display = "none";
          document.getElementById("answer").style.display = "none";
          document.querySelector(".input-container").style.display = "none";
          return;
        }

        // T√¨m c√¢u h·ªèi ti·∫øp theo theo th·ª© t·ª±
        while (
          currentQuestionIndex < questionOrder.length &&
          usedQuestions.has(questionOrder[currentQuestionIndex])
        ) {
          currentQuestionIndex++;
        }

        if (currentQuestionIndex >= questionOrder.length) {
          currentQuestionIndex = 0;
        }

        const questionIndex = questionOrder[currentQuestionIndex];
        const question = currentVocab[questionIndex];

        const questionElement = document.getElementById("question");
        if (currentMode === "vietnamese-to-german") {
          questionElement.innerHTML = `üáªüá≥ ${question.vi}<br><small>D·ªãch sang ti·∫øng ƒê·ª©c</small>`;
        } else {
          questionElement.innerHTML = `üá©üá™ ${question.de}
                    <button class="speaker-btn" onclick="speakText('${question.de}')">üîä</button>
                    <br><small>D·ªãch sang ti·∫øng Vi·ªát</small>`;
        }

        document.getElementById("answer").value = "";
        document.getElementById("feedback").textContent = "";
        document.getElementById("feedback").className = "feedback";
        document.getElementById("next-btn").style.display = "none";

        updateProgress();
      }

      function checkAnswer() {
        const questionIndex = questionOrder[currentQuestionIndex];
        const userAnswer = document
          .getElementById("answer")
          .value.trim()
          .toLowerCase();
        const question = currentVocab[questionIndex];

        let correctAnswer;
        if (currentMode === "vietnamese-to-german") {
          correctAnswer = question.de.toLowerCase();
        } else {
          correctAnswer = question.vi.toLowerCase();
        }

        const feedbackElement = document.getElementById("feedback");
        totalQuestions++;
        usedQuestions.add(questionIndex);

        // Ki·ªÉm tra nhi·ªÅu kh·∫£ nƒÉng ƒë√∫ng
        const normalizedUserAnswer = userAnswer.replace(/[\/\(\)]/g, "").trim();
        const normalizedCorrectAnswer = correctAnswer
          .replace(/[\/\(\)]/g, "")
          .trim();

        const isCorrect =
          normalizedUserAnswer === normalizedCorrectAnswer ||
          normalizedCorrectAnswer.includes(normalizedUserAnswer) ||
          normalizedUserAnswer.includes(
            normalizedCorrectAnswer.split(" ")[0]
          ) ||
          normalizedUserAnswer === normalizedCorrectAnswer.split(" / ")[0] ||
          normalizedUserAnswer === normalizedCorrectAnswer.split(" / ")[1];

        if (isCorrect) {
          correctAnswers++;
          feedbackElement.innerHTML = "‚úÖ Ch√≠nh x√°c!";
          feedbackElement.className = "feedback correct";

          // Ph√°t √¢m c√¢u tr·∫£ l·ªùi ƒë√∫ng n·∫øu l√† ti·∫øng ƒê·ª©c
          if (currentMode === "vietnamese-to-german") {
            setTimeout(() => speakText(question.de), 500);
          }
        } else {
          const correctText =
            currentMode === "vietnamese-to-german" ? question.de : question.vi;
          feedbackElement.innerHTML = `‚ùå Sai r·ªìi!<br>ƒê√°p √°n ƒë√∫ng: <strong>${correctText}</strong>`;
          feedbackElement.className = "feedback incorrect";

          // Ph√°t √¢m c√¢u tr·∫£ l·ªùi ƒë√∫ng n·∫øu l√† ti·∫øng ƒê·ª©c
          if (currentMode === "vietnamese-to-german") {
            setTimeout(() => speakText(question.de), 500);
          }
        }

        updateStats();
        updateProgress();
        document.getElementById("next-btn").style.display = "inline-block";
      }

      function nextQuestion() {
        currentQuestionIndex++;
        startNewQuestion();
      }

      function checkEnter(event) {
        if (event.key === "Enter") {
          const nextBtn = document.getElementById("next-btn");
          if (nextBtn.style.display === "none") {
            checkAnswer();
          } else {
            nextQuestion();
          }
        }
      }

      function updateStats() {
        document.getElementById("correct-count").textContent = correctAnswers;
        document.getElementById("total-count").textContent = totalQuestions;
        const accuracy =
          totalQuestions > 0
            ? Math.round((correctAnswers / totalQuestions) * 100)
            : 0;
        document.getElementById("accuracy").textContent = accuracy + "%";
      }

      // Kh·ªüi t·∫°o
      resetProgress();
    </script>
  </body>
</html>
