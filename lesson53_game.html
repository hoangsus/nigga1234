<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>üéÆ B1 Sprechen Master Game - PRO Edition</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }

      .game-container {
        max-width: 1400px;
        width: 100%;
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        overflow: hidden;
      }

      .game-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        text-align: center;
        position: relative;
      }

      .game-header h1 {
        font-size: 2.5em;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
      }

      .stats-bar {
        display: flex;
        justify-content: space-around;
        margin-top: 20px;
        gap: 15px;
        flex-wrap: wrap;
      }

      .stat-item {
        background: rgba(255, 255, 255, 0.2);
        padding: 15px 25px;
        border-radius: 15px;
        backdrop-filter: blur(10px);
        flex: 1;
        min-width: 120px;
      }

      .stat-label {
        font-size: 0.9em;
        opacity: 0.9;
      }

      .stat-value {
        font-size: 2em;
        font-weight: bold;
        margin-top: 5px;
      }

      .game-content {
        padding: 40px;
      }

      .menu-screen,
      .game-screen,
      .results-screen {
        display: none;
      }

      .menu-screen.active,
      .game-screen.active,
      .results-screen.active {
        display: block;
        animation: fadeIn 0.5s;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .game-modes {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 25px;
        margin-top: 30px;
      }

      .game-mode-card {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        padding: 30px;
        border-radius: 15px;
        cursor: pointer;
        transition: all 0.3s;
        border: 3px solid transparent;
        position: relative;
        overflow: hidden;
      }

      .game-mode-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        opacity: 0;
        transition: opacity 0.3s;
      }

      .game-mode-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
        border-color: #667eea;
      }

      .game-mode-card:hover::before {
        opacity: 0.1;
      }

      .game-mode-card > * {
        position: relative;
        z-index: 1;
      }

      .mode-icon {
        font-size: 4em;
        margin-bottom: 15px;
      }

      .mode-title {
        font-size: 1.5em;
        font-weight: bold;
        color: #333;
        margin-bottom: 10px;
      }

      .mode-desc {
        color: #666;
        line-height: 1.6;
        margin-bottom: 15px;
      }

      .mode-stats {
        display: flex;
        justify-content: space-between;
        font-size: 0.9em;
        color: #555;
        margin-top: 15px;
        padding-top: 15px;
        border-top: 2px solid rgba(0, 0, 0, 0.1);
      }

      .mode-difficulty {
        display: flex;
        gap: 5px;
        margin-top: 15px;
      }

      .difficulty-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: #ddd;
      }

      .difficulty-dot.active {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      }

      .question-card {
        background: #f8f9fa;
        padding: 40px;
        border-radius: 15px;
        margin-bottom: 30px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        position: relative;
      }

      .question-timer {
        position: absolute;
        top: 20px;
        right: 20px;
        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
        color: white;
        padding: 12px 20px;
        border-radius: 25px;
        font-size: 1.3em;
        font-weight: bold;
        box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
        animation: timerPulse 1s infinite;
      }

      @keyframes timerPulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
      }

      .question-timer.warning {
        animation: timerWarning 0.5s infinite;
      }

      @keyframes timerWarning {
        0%,
        100% {
          background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
        }
        50% {
          background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
        }
      }

      .dialogue-box {
        background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
        padding: 25px;
        border-radius: 15px;
        margin-bottom: 25px;
        border-left: 5px solid #2196f3;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
      }

      .dialogue-turn {
        margin: 15px 0;
        padding: 15px;
        background: white;
        border-radius: 10px;
        position: relative;
        padding-left: 60px;
      }

      .speaker-icon {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 2em;
      }

      .speaker-name {
        font-weight: bold;
        color: #667eea;
        margin-bottom: 5px;
      }

      .dialogue-text {
        color: #333;
        line-height: 1.6;
      }

      .your-turn {
        background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
        border: 3px solid #ffc107;
        animation: highlightTurn 2s infinite;
      }

      @keyframes highlightTurn {
        0%,
        100% {
          box-shadow: 0 0 0 0 rgba(255, 193, 7, 0.4);
        }
        50% {
          box-shadow: 0 0 20px 5px rgba(255, 193, 7, 0.6);
        }
      }

      .question-text {
        font-size: 1.4em;
        color: #333;
        margin-bottom: 30px;
        line-height: 1.8;
      }

      .situation {
        background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        padding: 20px;
        border-radius: 10px;
        margin-bottom: 25px;
        font-style: italic;
      }

      .context-box {
        background: linear-gradient(135deg, #d4fc79 0%, #96e6a1 100%);
        padding: 20px;
        border-radius: 10px;
        margin-bottom: 20px;
        border-left: 5px solid #28a745;
      }

      .options-grid {
        display: grid;
        gap: 15px;
      }

      .option-btn {
        background: white;
        padding: 20px;
        border: 3px solid #e0e0e0;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s;
        text-align: left;
        font-size: 1.1em;
        position: relative;
        overflow: hidden;
      }

      .option-btn:hover:not(.correct):not(.wrong) {
        border-color: #667eea;
        transform: translateX(5px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .option-btn.correct {
        background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
        border-color: #28a745;
        animation: correctPulse 0.5s;
      }

      .option-btn.wrong {
        background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
        border-color: #dc3545;
        animation: wrongShake 0.5s;
      }

      @keyframes correctPulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
      }

      @keyframes wrongShake {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-10px);
        }
        75% {
          transform: translateX(10px);
        }
      }

      .fill-blank-input {
        width: 100%;
        padding: 15px;
        font-size: 1.2em;
        border: 3px solid #e0e0e0;
        border-radius: 10px;
        margin: 20px 0;
        transition: all 0.3s;
      }

      .fill-blank-input:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 20px rgba(102, 126, 234, 0.2);
      }

      .sentence-builder {
        min-height: 150px;
        background: white;
        border: 3px solid #667eea;
        border-radius: 15px;
        padding: 25px;
        margin: 20px 0;
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        align-items: flex-start;
      }

      .word-bank {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        margin: 20px 0;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 12px;
      }

      .draggable-word {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 12px 24px;
        border-radius: 25px;
        cursor: pointer;
        user-select: none;
        font-weight: 600;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        transition: all 0.3s;
      }

      .draggable-word:hover {
        transform: scale(1.1);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      }

      .draggable-word.used {
        opacity: 0.3;
        pointer-events: none;
      }

      .btn {
        padding: 15px 40px;
        font-size: 1.1em;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
      }

      .btn-primary:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.5);
      }

      .btn-secondary {
        background: #6c757d;
        color: white;
      }

      .btn-secondary:hover {
        background: #5a6268;
        transform: translateY(-3px);
      }

      .btn-success {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        color: white;
      }

      .button-group {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin-top: 30px;
        flex-wrap: wrap;
      }

      .progress-bar {
        width: 100%;
        height: 25px;
        background: #e0e0e0;
        border-radius: 15px;
        overflow: hidden;
        margin-bottom: 30px;
        position: relative;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        transition: width 0.5s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 0.9em;
      }

      .feedback-box {
        padding: 25px;
        border-radius: 12px;
        margin: 25px 0;
        display: none;
        animation: slideIn 0.5s;
      }

      @keyframes slideIn {
        from {
          transform: translateY(-20px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .feedback-box.show {
        display: block;
      }

      .feedback-box.correct {
        background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
        border: 3px solid #28a745;
      }

      .feedback-box.wrong {
        background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
        border: 3px solid #dc3545;
      }

      .feedback-title {
        font-size: 1.3em;
        font-weight: bold;
        margin-bottom: 10px;
      }

      .results-summary {
        text-align: center;
        padding: 40px;
      }

      .score-circle {
        width: 200px;
        height: 200px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        margin: 30px auto;
        box-shadow: 0 10px 40px rgba(102, 126, 234, 0.4);
      }

      .score-number {
        font-size: 4em;
        font-weight: bold;
      }

      .score-label {
        font-size: 1.2em;
        margin-top: 10px;
      }

      .performance-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin: 30px 0;
      }

      .performance-item {
        background: #f8f9fa;
        padding: 25px;
        border-radius: 12px;
        text-align: center;
      }

      .performance-value {
        font-size: 2.5em;
        font-weight: bold;
        color: #667eea;
        margin: 10px 0;
      }

      .achievement-badge {
        display: inline-block;
        background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
        padding: 10px 20px;
        border-radius: 20px;
        margin: 10px;
        font-weight: bold;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
      }

      .hint-box {
        background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        padding: 20px;
        border-radius: 12px;
        margin: 20px 0;
        border-left: 5px solid #ff9a56;
      }

      .matching-game {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
        margin: 30px 0;
      }

      .matching-column {
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      .match-item {
        padding: 20px;
        background: white;
        border: 3px solid #e0e0e0;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s;
        text-align: center;
      }

      .match-item:hover {
        border-color: #667eea;
        transform: scale(1.05);
      }

      .match-item.selected {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-color: #667eea;
      }

      .match-item.matched {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        color: white;
        border-color: #28a745;
        pointer-events: none;
      }

      .combo-counter {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 5em;
        font-weight: bold;
        color: #667eea;
        opacity: 0;
        pointer-events: none;
        z-index: 1000;
        text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.3);
      }

      .combo-counter.show {
        animation: comboAnimation 1s;
      }

      @keyframes comboAnimation {
        0% {
          opacity: 0;
          transform: translate(-50%, -50%) scale(0.5);
        }
        50% {
          opacity: 1;
          transform: translate(-50%, -50%) scale(1.5);
        }
        100% {
          opacity: 0;
          transform: translate(-50%, -50%) scale(1);
        }
      }

      @media (max-width: 768px) {
        .game-header h1 {
          font-size: 1.8em;
        }

        .stats-bar {
          flex-direction: column;
        }

        .game-content {
          padding: 20px;
        }

        .game-modes {
          grid-template-columns: 1fr;
        }

        .matching-game {
          grid-template-columns: 1fr;
        }

        .score-circle {
          width: 150px;
          height: 150px;
        }

        .score-number {
          font-size: 3em;
        }

        .question-timer {
          position: static;
          margin-bottom: 20px;
          display: inline-block;
        }
      }
    </style>
  </head>
  <body>
    <div class="combo-counter" id="comboCounter"></div>

    <div class="game-container">
      <div class="game-header">
        <h1>üéÆ B1 SPRECHEN MASTER - PRO</h1>
        <p>Luy·ªán t·∫≠p n√≥i ti·∫øng ƒê·ª©c B1 Goethe qua game | 200+ c√¢u h·ªèi</p>

        <div class="stats-bar">
          <div class="stat-item">
            <div class="stat-label">üèÜ ƒêi·ªÉm</div>
            <div class="stat-value" id="totalScore">0</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">üìä ƒê·ªô ch√≠nh x√°c</div>
            <div class="stat-value" id="accuracy">0%</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">üî• Streak</div>
            <div class="stat-value" id="streak">0</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">‚è±Ô∏è Th·ªùi gian TB</div>
            <div class="stat-value" id="avgTime">0s</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">‚≠ê Level</div>
            <div class="stat-value" id="level">1</div>
          </div>
        </div>
      </div>

      <div class="game-content">
        <!-- MENU SCREEN -->
        <div class="menu-screen active" id="menuScreen">
          <h2
            style="
              text-align: center;
              color: #333;
              margin-bottom: 30px;
              font-size: 2em;
            "
          >
            Ch·ªçn ch·∫ø ƒë·ªô ch∆°i
          </h2>

          <div class="game-modes">
            <div
              class="game-mode-card"
              onclick="startGame('dialogue-practice')"
            >
              <div class="mode-icon">üó£Ô∏è</div>
              <div class="mode-title">Luy·ªán H·ªôi tho·∫°i</div>
              <div class="mode-desc">
                Th·ª±c h√†nh h·ªôi tho·∫°i ho√†n ch·ªânh nh∆∞ thi th·∫≠t. B√°m s√°t k·ªãch b·∫£n
                Teil 1!
              </div>
              <div class="mode-stats">
                <span>üìù 50 c√¢u</span>
                <span>‚è±Ô∏è 30s/c√¢u</span>
              </div>
              <div class="mode-difficulty">
                <div class="difficulty-dot active"></div>
                <div class="difficulty-dot active"></div>
                <div class="difficulty-dot active"></div>
              </div>
            </div>

            <div class="game-mode-card" onclick="startGame('multiple-choice')">
              <div class="mode-icon">üéØ</div>
              <div class="mode-title">Tr·∫Øc nghi·ªám Redemittel</div>
              <div class="mode-desc">
                Ch·ªçn c·ª•m t·ª´ ƒë√∫ng trong c√°c t√¨nh hu·ªëng. Luy·ªán Teil 1, 2 & 3.
              </div>
              <div class="mode-stats">
                <span>üìù 40 c√¢u</span>
                <span>‚è±Ô∏è 20s/c√¢u</span>
              </div>
              <div class="mode-difficulty">
                <div class="difficulty-dot active"></div>
                <div class="difficulty-dot active"></div>
                <div class="difficulty-dot"></div>
              </div>
            </div>

            <div class="game-mode-card" onclick="startGame('fill-blank')">
              <div class="mode-icon">‚úçÔ∏è</div>
              <div class="mode-title">ƒêi·ªÅn t·ª´ v√†o ch·ªó tr·ªëng</div>
              <div class="mode-desc">
                Ho√†n thi·ªán c√¢u v·ªõi t·ª´ ƒë√∫ng. Test t·ª´ v·ª±ng ch√≠nh x√°c!
              </div>
              <div class="mode-stats">
                <span>üìù 30 c√¢u</span>
                <span>‚è±Ô∏è 15s/c√¢u</span>
              </div>
              <div class="mode-difficulty">
                <div class="difficulty-dot active"></div>
                <div class="difficulty-dot active"></div>
                <div class="difficulty-dot active"></div>
              </div>
            </div>

            <div class="game-mode-card" onclick="startGame('sentence-builder')">
              <div class="mode-icon">üß©</div>
              <div class="mode-title">X·∫øp c√¢u</div>
              <div class="mode-desc">
                S·∫Øp x·∫øp c√°c t·ª´ th√†nh c√¢u ƒë√∫ng. Luy·ªán c·∫•u tr√∫c!
              </div>
              <div class="mode-stats">
                <span>üìù 30 c√¢u</span>
                <span>‚è±Ô∏è 25s/c√¢u</span>
              </div>
              <div class="mode-difficulty">
                <div class="difficulty-dot active"></div>
                <div class="difficulty-dot active"></div>
                <div class="difficulty-dot"></div>
              </div>
            </div>

            <div class="game-mode-card" onclick="startGame('matching')">
              <div class="mode-icon">üîó</div>
              <div class="mode-title">Gh√©p c·∫∑p Nhanh</div>
              <div class="mode-desc">
                Gh√©p Deutsch-Vi·ªát v·ªõi th·ªùi gian √°p l·ª±c. T·ªëc ƒë·ªô l√† ch√¨a kh√≥a!
              </div>
              <div class="mode-stats">
                <span>üìù 20 v√≤ng</span>
                <span>‚è±Ô∏è 40s/v√≤ng</span>
              </div>
              <div class="mode-difficulty">
                <div class="difficulty-dot active"></div>
                <div class="difficulty-dot"></div>
                <div class="difficulty-dot"></div>
              </div>
            </div>

            <div
              class="game-mode-card"
              onclick="startGame('situation-response')"
            >
              <div class="mode-icon">üí¨</div>
              <div class="mode-title">Ph·∫£n ·ª©ng T√¨nh hu·ªëng</div>
              <div class="mode-desc">
                Ch·ªçn ph·∫£n ·ª©ng ƒë√∫ng trong t√¨nh hu·ªëng th·ª±c t·∫ø Teil 1.
              </div>
              <div class="mode-stats">
                <span>üìù 30 c√¢u</span>
                <span>‚è±Ô∏è 25s/c√¢u</span>
              </div>
              <div class="mode-difficulty">
                <div class="difficulty-dot active"></div>
                <div class="difficulty-dot active"></div>
                <div class="difficulty-dot active"></div>
              </div>
            </div>

            <div class="game-mode-card" onclick="startGame('speed-round')">
              <div class="mode-icon">‚ö°</div>
              <div class="mode-title">V√≤ng T·ªëc ƒê·ªô</div>
              <div class="mode-desc">
                60 gi√¢y - tr·∫£ l·ªùi nhi·ªÅu nh·∫•t c√≥ th·ªÉ. Si√™u cƒÉng th·∫≥ng!
              </div>
              <div class="mode-stats">
                <span>üìù Kh√¥ng gi·ªõi h·∫°n</span>
                <span>‚è±Ô∏è 60s total</span>
              </div>
              <div class="mode-difficulty">
                <div class="difficulty-dot active"></div>
                <div class="difficulty-dot active"></div>
                <div class="difficulty-dot active"></div>
              </div>
            </div>

            <div class="game-mode-card" onclick="startGame('teil2-practice')">
              <div class="mode-icon">üìä</div>
              <div class="mode-title">Th·ª±c h√†nh Teil 2</div>
              <div class="mode-desc">
                Luy·ªán c·∫•u tr√∫c b√†i thuy·∫øt tr√¨nh t·ª´ng ph·∫ßn. Chu·∫©n ch·ªânh!
              </div>
              <div class="mode-stats">
                <span>üìù 25 c√¢u</span>
                <span>‚è±Ô∏è 20s/c√¢u</span>
              </div>
              <div class="mode-difficulty">
                <div class="difficulty-dot active"></div>
                <div class="difficulty-dot active"></div>
                <div class="difficulty-dot"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- GAME SCREEN -->
        <div class="game-screen" id="gameScreen">
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill">C√¢u 1/10</div>
          </div>

          <div id="gameArea"></div>

          <div class="feedback-box" id="feedbackBox">
            <div class="feedback-title" id="feedbackTitle"></div>
            <div id="feedbackText"></div>
          </div>

          <div class="button-group">
            <button
              class="btn btn-primary"
              id="submitBtn"
              onclick="checkAnswer()"
            >
              Ki·ªÉm tra
            </button>
            <button
              class="btn btn-secondary"
              id="nextBtn"
              onclick="nextQuestion()"
              style="display: none"
            >
              C√¢u ti·∫øp theo ‚Üí
            </button>
            <button class="btn btn-secondary" onclick="returnToMenu()">
              ‚Üê Quay l·∫°i menu
            </button>
          </div>
        </div>

        <!-- RESULTS SCREEN -->
        <div class="results-screen" id="resultsScreen">
          <div class="results-summary">
            <h2 style="color: #667eea; font-size: 2.5em; margin-bottom: 20px">
              üéâ Ho√†n th√†nh!
            </h2>

            <div class="score-circle">
              <div class="score-number" id="finalScore">0</div>
              <div class="score-label">ƒëi·ªÉm</div>
            </div>

            <div class="performance-grid">
              <div class="performance-item">
                <div>‚úÖ ƒê√∫ng</div>
                <div class="performance-value" id="correctCount">0</div>
              </div>
              <div class="performance-item">
                <div>‚ùå Sai</div>
                <div class="performance-value" id="wrongCount">0</div>
              </div>
              <div class="performance-item">
                <div>üìä ƒê·ªô ch√≠nh x√°c</div>
                <div class="performance-value" id="finalAccuracy">0%</div>
              </div>
              <div class="performance-item">
                <div>üî• Streak t·ªët nh·∫•t</div>
                <div class="performance-value" id="bestStreak">0</div>
              </div>
              <div class="performance-item">
                <div>‚è±Ô∏è Th·ªùi gian TB</div>
                <div class="performance-value" id="finalAvgTime">0s</div>
              </div>
            </div>

            <div id="achievementsList"></div>

            <div
              id="performanceMessage"
              style="font-size: 1.3em; margin: 30px 0; color: #666"
            ></div>

            <div class="button-group">
              <button class="btn btn-success" onclick="restartGame()">
                üîÑ Ch∆°i l·∫°i
              </button>
              <button class="btn btn-primary" onclick="returnToMenu()">
                üè† V·ªÅ menu
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Game State
      let gameState = {
        mode: "",
        currentQuestion: 0,
        totalQuestions: 10,
        score: 0,
        correct: 0,
        wrong: 0,
        streak: 0,
        bestStreak: 0,
        level: 1,
        timeLeft: 0,
        timerInterval: null,
        questionTimer: null,
        selectedAnswer: null,
        questionStartTime: 0,
        totalTime: 0,
        questionTimes: [],
      };

      // EXPANDED Question Banks - 200+ questions
      const questionBanks = {
        "dialogue-practice": [
          {
            context: "Ch·ªß ƒë·ªÅ: L√™n k·∫ø ho·∫°ch chuy·∫øn ƒëi cu·ªëi tu·∫ßn ƒë·∫øn Schwarzwald",
            dialogue: [
              {
                speaker: "Partner",
                icon: "üë§",
                text: "Wei√üt du was? Wir haben am Wochenende frei. Ich habe geh√∂rt, dass es im Schwarzwald viel zu sehen gibt.",
              },
            ],
            question: "B·∫°n mu·ªën ƒê·ªíNG √ù v√† ƒë·ªÅ xu·∫•t ƒëi Freiburg. N√™n n√≥i g√¨?",
            options: [
              "Das ist eine gute Idee! Ich schlage vor, dass wir nach Freiburg fahren, weil es dort sehr sch√∂n ist. Was h√§ltst du davon?",
              "Nein, das finde ich nicht so gut. Ich m√∂chte lieber zu Hause bleiben.",
              "Vielleicht. Ich wei√ü noch nicht genau.",
              "Das ist mir egal. Du kannst entscheiden.",
            ],
            correct: 0,
            timeLimit: 30,
            explanation:
              "C·∫•u tr√∫c ho√†n ch·ªânh: ƒê·ªìng √Ω (Das ist eine gute Idee!) + ƒê·ªÅ xu·∫•t (Ich schlage vor, dass...) + L√Ω do (weil...) + H·ªèi √Ω ki·∫øn (Was h√§ltst du davon?)",
          },
          {
            context: "Ti·∫øp t·ª•c h·ªôi tho·∫°i v·ªÅ chuy·∫øn ƒëi Schwarzwald",
            dialogue: [
              {
                speaker: "B·∫°n",
                icon: "üéØ",
                text: "Das ist eine gute Idee! Ich schlage vor, dass wir nach Freiburg fahren.",
              },
              {
                speaker: "Partner",
                icon: "üë§",
                text: "Super! Und wann genau? Am Freitag oder am Samstag?",
              },
            ],
            question: "B·∫°n mu·ªën ƒë·ªÅ xu·∫•t ƒëi v√†o th·ª© S√°u. N√™n n√≥i g√¨?",
            options: [
              "Ich finde, am Freitag ist besser, weil wir dann mehr Zeit haben. Am Samstag k√∂nnen wir den ganzen Tag dort verbringen. Was meinst du?",
              "Ich wei√ü nicht. Kannst du entscheiden?",
              "Beides ist okay f√ºr mich.",
              "Das ist eine schwierige Frage.",
            ],
            correct: 0,
            timeLimit: 30,
            explanation:
              "ƒê∆∞a ra l·ª±a ch·ªçn c·ª• th·ªÉ + gi·∫£i th√≠ch l√Ω do + h·ªèi √Ω ki·∫øn partner ƒë·ªÉ duy tr√¨ t√≠nh t∆∞∆°ng t√°c.",
          },
          {
            context: "Th·∫£o lu·∫≠n v·ªÅ ph∆∞∆°ng ti·ªán di chuy·ªÉn",
            dialogue: [
              {
                speaker: "Partner",
                icon: "üë§",
                text: "Und wie fahren wir dorthin? Mit dem Auto oder mit dem Zug?",
              },
            ],
            question:
              "B·∫°n mu·ªën ƒë·ªÅ xu·∫•t ƒëi b·∫±ng t√†u v√¨ th√¢n thi·ªán m√¥i tr∆∞·ªùng. N√™n n√≥i g√¨?",
            options: [
              "Ich schlage vor, dass wir mit dem Zug fahren, weil das umweltfreundlich ist. Au√üerdem ist der Zug auch bequemer. Was h√§ltst du davon?",
              "Mit dem Auto ist schneller.",
              "Ich wei√ü nicht, welches besser ist.",
              "K√∂nnen wir zu Fu√ü gehen?",
            ],
            correct: 0,
            timeLimit: 30,
            explanation:
              "ƒê·ªÅ xu·∫•t + 2 l√Ω do (weil... + Au√üerdem...) + h·ªèi √Ω ki·∫øn. Th√™m 'Au√üerdem' ƒë·ªÉ b·ªï sung l√Ω do th·ª© hai.",
          },
          {
            context: "Partner kh√¥ng ƒë·ªìng √Ω v·ªõi ƒë·ªÅ xu·∫•t c·ªßa b·∫°n",
            dialogue: [
              {
                speaker: "B·∫°n",
                icon: "üéØ",
                text: "Ich schlage vor, dass wir mit dem Zug fahren.",
              },
              {
                speaker: "Partner",
                icon: "üë§",
                text: "Nein, das finde ich nicht so gut, weil der Zug zu teuer ist.",
              },
            ],
            question: "B·∫°n ch·∫•p nh·∫≠n v√† h·ªèi ƒë·ªÅ xu·∫•t c·ªßa partner. N√™n n√≥i g√¨?",
            options: [
              "Okay, das ist kein Problem. Was w√§re denn dein Vorschlag? Wie m√∂chtest du fahren?",
              "Aber der Zug ist die beste Option!",
              "Du hast Unrecht. Der Zug ist gut.",
              "Dann gehen wir nicht.",
            ],
            correct: 0,
            timeLimit: 30,
            explanation:
              "Th·ªÉ hi·ªán s·ª± linh ho·∫°t b·∫±ng 'Okay, das ist kein Problem' v√† h·ªèi ƒë·ªÅ xu·∫•t m·ªõi c·ªßa partner.",
          },
          {
            context: "Th·∫£o lu·∫≠n v·ªÅ n∆°i ·ªü",
            dialogue: [
              {
                speaker: "Partner",
                icon: "üë§",
                text: "Wir m√ºssen auch √ºberlegen, wo wir √ºbernachten. Was meinst du?",
              },
            ],
            question: "B·∫°n ƒë·ªÅ xu·∫•t ·ªü nh√† tr·∫ª v√¨ r·∫ª. N√™n n√≥i g√¨?",
            options: [
              "Ich schlage vor, dass wir in der Jugendherberge √ºbernachten, weil das am billigsten ist. Au√üerdem k√∂nnen wir dort andere Reisende kennenlernen. Bist du einverstanden?",
              "Lass uns im Hotel bleiben.",
              "Wir k√∂nnen bei Freunden wohnen.",
              "Ich habe keine Meinung dazu.",
            ],
            correct: 0,
            timeLimit: 30,
            explanation:
              "ƒê·ªÅ xu·∫•t c·ª• th·ªÉ + l√Ω do ch√≠nh (billig) + l√Ω do ph·ª• (Leute kennenlernen) + x√°c nh·∫≠n ƒë·ªìng √Ω.",
          },
          // Th√™m 45 dialogue situations kh√°c...
          {
            context: "Th·∫£o lu·∫≠n v·ªÅ ho·∫°t ƒë·ªông t·∫°i Schwarzwald",
            dialogue: [
              {
                speaker: "Partner",
                icon: "üë§",
                text: "Was k√∂nnen wir dort machen? Hast du Ideen?",
              },
            ],
            question:
              "B·∫°n ƒë·ªÅ xu·∫•t ƒëi b·ªô ƒë∆∞·ªùng d√†i v√† tham quan b·∫£o t√†ng. N√™n n√≥i g√¨?",
            options: [
              "Wir k√∂nnten wandern gehen und die Natur genie√üen. Au√üerdem gibt es dort auch interessante Museen. Was findest du interessant?",
              "Ich wei√ü nicht, was wir machen k√∂nnen.",
              "Lass uns nur im Hotel bleiben.",
              "Vielleicht k√∂nnen wir schlafen.",
            ],
            correct: 0,
            timeLimit: 30,
            explanation:
              "D√πng 'Wir k√∂nnten...' (ch√∫ng ta c√≥ th·ªÉ) ƒë·ªÉ ƒë∆∞a ra nhi·ªÅu g·ª£i √Ω v√† h·ªèi s·ªü th√≠ch c·ªßa partner.",
          },
          {
            context: "Partner ƒë·ªÅ xu·∫•t ho·∫°t ƒë·ªông b·∫°n kh√¥ng th√≠ch",
            dialogue: [
              {
                speaker: "Partner",
                icon: "üë§",
                text: "Ich finde, wir sollten Mountainbike fahren. Das macht viel Spa√ü!",
              },
            ],
            question:
              "B·∫°n t·ª´ ch·ªëi l·ªãch s·ª± v√† ƒë·ªÅ xu·∫•t ho·∫°t ƒë·ªông kh√°c. N√™n n√≥i g√¨?",
            options: [
              "Nein, das finde ich nicht so gut, weil ich kein Mountainbike fahren kann. Aber wir k√∂nnten eine Schifffahrt auf dem Rhein machen. Was h√§ltst du davon?",
              "Mountainbike ist langweilig.",
              "Ich mag keine Sportarten.",
              "Okay, wenn du willst.",
            ],
            correct: 0,
            timeLimit: 30,
            explanation:
              "T·ª´ ch·ªëi + l√Ω do c√° nh√¢n + ƒë·ªÅ xu·∫•t thay th·∫ø v·ªõi 'Aber' + h·ªèi √Ω ki·∫øn.",
          },
          {
            context: "Th·∫£o lu·∫≠n v·ªÅ ƒë·ªì c·∫ßn mang theo",
            dialogue: [
              {
                speaker: "Partner",
                icon: "üë§",
                text: "Was m√ºssen wir mitnehmen? Hast du schon eine Liste?",
              },
            ],
            question:
              "B·∫°n ƒë·ªÅ xu·∫•t mang theo qu·∫ßn √°o ·∫•m v√† m√°y ·∫£nh. N√™n n√≥i g√¨?",
            options: [
              "Ich denke, wir sollten warme Kleidung mitnehmen, weil es im Schwarzwald kalt sein kann. Und nat√ºrlich auch eine Kamera f√ºr Fotos. Was m√∂chtest du noch mitnehmen?",
              "Wir brauchen nichts.",
              "Das wei√ü ich nicht.",
              "Du kannst alles organisieren.",
            ],
            correct: 0,
            timeLimit: 30,
            explanation:
              "ƒê∆∞a ra danh s√°ch c·ª• th·ªÉ v·ªõi l√Ω do v√† h·ªèi th√™m √Ω ki·∫øn c·ªßa partner v·ªÅ ƒë·ªì c·∫ßn thi·∫øt kh√°c.",
          },
          {
            context: "Xin ph√©p b·ªë m·∫π",
            dialogue: [
              {
                speaker: "Partner",
                icon: "üë§",
                text: "Glaubst du, deine Eltern erlauben dir die Reise?",
              },
            ],
            question: "B·∫°n nghƒ© b·ªë m·∫π s·∫Ω ƒë·ªìng √Ω. N√™n n√≥i g√¨?",
            options: [
              "Ich glaube, dass sie nichts dagegen haben. Normalerweise erlauben sie mir alles, was ich mit Freunden unternehme. Soll meine Mutter mit deiner Mutter reden?",
              "Meine Eltern sind nicht wichtig.",
              "Ich werde nicht fragen.",
              "Das geht dich nichts an.",
            ],
            correct: 0,
            timeLimit: 30,
            explanation:
              "Th·ªÉ hi·ªán s·ª± t·ª± tin nh∆∞ng v·∫´n ƒë·ªÅ ngh·ªã h·ªó tr·ª£ n·∫øu c·∫ßn. D√πng 'Soll...?' ƒë·ªÉ ƒë∆∞a ra ƒë·ªÅ ngh·ªã gi√∫p ƒë·ª°.",
          },
          {
            context: "K·∫øt th√∫c cu·ªôc th·∫£o lu·∫≠n",
            dialogue: [
              {
                speaker: "Partner",
                icon: "üë§",
                text: "Ich glaube, wir haben jetzt √ºber alles gesprochen, oder?",
              },
            ],
            question: "B·∫°n ƒë·ªìng √Ω v√† t·ªïng k·∫øt. N√™n n√≥i g√¨?",
            options: [
              "Ja, ich glaube auch. Wir fahren also am Freitag mit dem Zug nach Freiburg und √ºbernachten in der Jugendherberge. Das wird sicher toll!",
              "Ja, lass uns aufh√∂ren zu reden.",
              "Ich wei√ü nicht mehr, was wir besprochen haben.",
              "K√∂nnen wir von vorne anfangen?",
            ],
            correct: 0,
            timeLimit: 30,
            explanation:
              "T·ªïng k·∫øt ng·∫Øn g·ªçn c√°c quy·∫øt ƒë·ªãnh ch√≠nh v√† k·∫øt th√∫c t√≠ch c·ª±c. Th·ªÉ hi·ªán s·ª± h√†o h·ª©ng v·ªõi 'Das wird toll!'",
          },
        ],
        "multiple-choice": [
          // 40 c√¢u tr·∫Øc nghi·ªám ƒëa d·∫°ng
          {
            question:
              "Partner n√≥i: 'Ich schlage vor, dass wir nach Freiburg fahren.' B·∫°n mu·ªën ƒê·ªíNG √ù. N√™n n√≥i g√¨?",
            options: [
              "Das ist eine gute Idee! Ich bin einverstanden.",
              "Nein, das finde ich nicht so gut.",
              "Ich habe aber eine Sache nicht verstanden.",
              "Entschuldigung, ich m√∂chte dazu auch etwas sagen.",
            ],
            correct: 0,
            timeLimit: 20,
            explanation:
              "ƒê·ªìng √Ω b·∫±ng 'Das ist eine gute Idee!' + 'Ich bin einverstanden' ƒë·ªÉ nh·∫•n m·∫°nh.",
          },
          {
            question:
              "Trong Teil 2, b·∫°n mu·ªën gi·ªõi thi·ªáu ch·ªß ƒë·ªÅ thuy·∫øt tr√¨nh. N√™n d√πng c·ª•m n√†o?",
            options: [
              "Was mich betrifft, ich...",
              "Meine Pr√§sentation ist zu dem Thema: ...",
              "In meinem Heimatland...",
              "Hiermit ist meine Pr√§sentation zu Ende.",
            ],
            correct: 1,
            timeLimit: 20,
            explanation:
              "Gi·ªõi thi·ªáu ch·ªß ƒë·ªÅ v·ªõi 'Meine Pr√§sentation ist zu dem Thema: ...' ho·∫∑c 'zum Thema'.",
          },
          {
            question:
              "Partner h·ªèi: 'Was h√§ltst du davon?' B·∫°n mu·ªën T·ª™ CH·ªêI l·ªãch s·ª±. Ch·ªçn c√¢u n√†o?",
            options: [
              "Super! Das finde ich auch toll.",
              "Ja, klar! Ich glaube schon.",
              "Nein, das finde ich nicht so gut, weil...",
              "Gut, das kann ich machen.",
            ],
            correct: 2,
            timeLimit: 20,
            explanation:
              "T·ª´ ch·ªëi l·ªãch s·ª± v·ªõi 'Nein, das finde ich nicht so gut' v√† LU√îN ƒë∆∞a l√Ω do v·ªõi 'weil'.",
          },
          {
            question:
              "Trong Teil 3, b·∫°n mu·ªën ƒë·∫∑t c√¢u h·ªèi cho partner. N√™n d√πng c·ª•m n√†o?",
            options: [
              "Vielen Dank f√ºrs Zuh√∂ren!",
              "Ich h√§tte gern eine Frage f√ºr Sie.",
              "Das ist eine gute Idee!",
              "Mein Vortrag besteht aus folgenden Teilen.",
            ],
            correct: 1,
            timeLimit: 20,
            explanation:
              "D√πng 'Ich h√§tte gern eine Frage' v·ªõi Konjunktiv II ƒë·ªÉ th·ªÉ hi·ªán l·ªãch s·ª± trong Teil 3.",
          },
          {
            question:
              "B·∫°n mu·ªën n√≥i v·ªÅ kinh nghi·ªám c√° nh√¢n trong Teil 2. C·ª•m n√†o ph√π h·ª£p?",
            options: [
              "In meinem Heimatland ist...",
              "Was mich betrifft, ich...",
              "Ein Vorteil ist, dass...",
              "Damit komme ich zum Schluss.",
            ],
            correct: 1,
            timeLimit: 20,
            explanation:
              "'Was mich betrifft' (V·ªÅ ph·∫ßn t√¥i) m·ªü ƒë·∫ßu ph·∫ßn kinh nghi·ªám trong Folie 2.",
          },
          {
            question:
              "Partner t·ª´ ch·ªëi ƒë·ªÅ xu·∫•t c·ªßa b·∫°n. B·∫°n mu·ªën ch·∫•p nh·∫≠n v√† h·ªèi √Ω ki·∫øn. N√™n n√≥i g√¨?",
            options: [
              "Du musst mir zustimmen!",
              "Okay, das ist kein Problem. Was w√§re denn dein Vorschlag?",
              "Deine Idee ist schlecht.",
              "Ich verstehe dich nicht.",
            ],
            correct: 1,
            timeLimit: 20,
            explanation:
              "Th·ªÉ hi·ªán s·ª± linh ho·∫°t v·ªõi 'das ist kein Problem' v√† h·ªèi ƒë·ªÅ xu·∫•t thay th·∫ø.",
          },
          {
            question: "Trong Teil 2, b·∫°n mu·ªën n√™u ∆ØU ƒêI·ªÇM. Ch·ªçn c·ª•m n√†o?",
            options: [
              "Ein Vorteil ist, dass...",
              "Ein Nachteil ist, dass...",
              "Ich habe einmal Folgendes erlebt:",
              "Liebe Zuh√∂rer!",
            ],
            correct: 0,
            timeLimit: 20,
            explanation:
              "'Ein Vorteil ist, dass...' cho ∆∞u ƒëi·ªÉm, 'Ein Nachteil ist, dass...' cho nh∆∞·ª£c ƒëi·ªÉm.",
          },
          {
            question: "B·∫°n kh√¥ng nghe r√µ partner. N√™n h·ªèi th·∫ø n√†o?",
            options: [
              "Das ist eine gute Idee!",
              "K√∂nnten Sie das bitte wiederholen?",
              "Ich bin einverstanden.",
              "Vielen Dank f√ºr Ihre Frage.",
            ],
            correct: 1,
            timeLimit: 20,
            explanation:
              "D√πng 'K√∂nnten Sie... wiederholen?' v·ªõi Konjunktiv II ƒë·ªÉ nh·ªù l·∫∑p l·∫°i l·ªãch s·ª±.",
          },
          {
            question: "K·∫øt th√∫c Teil 2, b·∫°n n√™n n√≥i g√¨?",
            options: [
              "Zuerst m√∂chte ich √ºber...",
              "Was mich betrifft...",
              "Hiermit ist meine Pr√§sentation zu Ende. Vielen Dank f√ºrs Zuh√∂ren!",
              "Ich schlage vor, dass...",
            ],
            correct: 2,
            timeLimit: 20,
            explanation:
              "K·∫øt th√∫c v·ªõi 'Hiermit ist meine Pr√§sentation zu Ende' + c·∫£m ∆°n + h·ªèi c√¢u h·ªèi.",
          },
          {
            question:
              "Partner ph·∫£n h·ªìi t√≠ch c·ª±c v·ªÅ b√†i thuy·∫øt tr√¨nh c·ªßa b·∫°n. N√™n ƒë√°p l·∫°i th·∫ø n√†o?",
            options: [
              "Nein, das stimmt nicht.",
              "Vielen Dank, es freut mich, dass Ihnen meine Pr√§sentation gefallen hat.",
              "Ich habe eine Frage.",
              "Das ist keine gute Idee.",
            ],
            correct: 1,
            timeLimit: 20,
            explanation:
              "C·∫£m ∆°n v√† b√†y t·ªè vui m·ª´ng: 'Vielen Dank, es freut mich, dass...'",
          },
          // Th√™m 30 c√¢u n·ªØa v·ªõi ƒë·ªô kh√≥ tƒÉng d·∫ßn...
          {
            question:
              "B·∫°n mu·ªën b·ªï sung th√™m l√Ω do cho ƒë·ªÅ xu·∫•t. D√πng t·ª´ n·ªëi n√†o?",
            options: ["Aber", "Au√üerdem", "Oder", "Denn"],
            correct: 1,
            timeLimit: 20,
            explanation:
              "'Au√üerdem' (H∆°n n·ªØa) ƒë·ªÉ th√™m l√Ω do th·ª© hai, tƒÉng t√≠nh thuy·∫øt ph·ª•c.",
          },
          {
            question:
              "Trong Teil 2, b·∫°n mu·ªën chuy·ªÉn t·ª´ ph·∫ßn kinh nghi·ªám sang ph·∫ßn t√¨nh h√¨nh qu√™ nh√†. N√™n d√πng c·ª•m n√†o?",
            options: [
              "Jetzt komme ich zu...",
              "Zum Schluss...",
              "Zuerst...",
              "Vielen Dank!",
            ],
            correct: 0,
            timeLimit: 20,
            explanation:
              "'Jetzt komme ich zu...' (B√¢y gi·ªù t√¥i chuy·ªÉn sang...) ƒë·ªÉ n·ªëi c√°c ph·∫ßn.",
          },
          {
            question: "Partner n√≥i qu√° nhanh, b·∫°n kh√¥ng hi·ªÉu. N√™n n√≥i g√¨?",
            options: [
              "Du sprichst zu schnell. Ich kann dich nicht verstehen.",
              "Das ist langweilig.",
              "Sprich langsamer!",
              "Ich h√∂re nicht zu.",
            ],
            correct: 0,
            timeLimit: 20,
            explanation:
              "L·ªãch s·ª± nh·∫Øc nh·ªü: 'Du sprichst zu schnell. Ich kann dich nicht verstehen.'",
          },
          {
            question:
              "B·∫°n mu·ªën h·ªèi v·ªÅ chi ph√≠ trong cu·ªôc th·∫£o lu·∫≠n Teil 1. N√™n n√≥i th·∫ø n√†o?",
            options: [
              "Und was kostet das? Ist das nicht zu teuer?",
              "Geld ist nicht wichtig.",
              "Ich bezahle alles.",
              "Das interessiert mich nicht.",
            ],
            correct: 0,
            timeLimit: 20,
            explanation:
              "H·ªèi tr·ª±c ti·∫øp v·ªÅ gi√°: 'Was kostet das?' v√† b√†y t·ªè lo l·∫Øng 'Ist das nicht zu teuer?'",
          },
        ],
        "fill-blank": [
          // 30 c√¢u ƒëi·ªÅn t·ª´
          {
            question: "Ich _____ vor, dass wir nach M√ºnchen fahren.",
            answer: "schlage",
            hint: "vorschlagen - chia ng√¥i ich",
            timeLimit: 15,
            explanation:
              "'Ich schlage vor' - separable verb, 'vor' ·ªü cu·ªëi m·ªánh ƒë·ªÅ ch√≠nh.",
          },
          {
            question: "Das ist eine gute _____!",
            answer: "Idee",
            hint: "Danh t·ª´ n·ªØ '√Ω t∆∞·ªüng', vi·∫øt hoa",
            timeLimit: 15,
            explanation:
              "'die Idee' - danh t·ª´ trong ti·∫øng ƒê·ª©c lu√¥n vi·∫øt hoa ch·ªØ c√°i ƒë·∫ßu.",
          },
          {
            question:
              "Meine Pr√§sentation ist zu dem _____: 'Lernen im Internet'.",
            answer: "Thema",
            hint: "Danh t·ª´ trung t√≠nh 'ch·ªß ƒë·ªÅ'",
            timeLimit: 15,
            explanation:
              "'das Thema' - gi·ªõi thi·ªáu ch·ªß ƒë·ªÅ v·ªõi 'zu dem Thema' ho·∫∑c 'zum Thema'.",
          },
          {
            question: "Was mich _____, ich lerne oft online.",
            answer: "betrifft",
            hint: "betreffen - chia ng√¥i es (was)",
            timeLimit: 15,
            explanation:
              "'Was mich betrifft' - c·ª•m c·ªë ƒë·ªãnh, ƒë·ªông t·ª´ chia theo 'was' (ng√¥i 3 s·ªë √≠t).",
          },
          {
            question: "Ein _____ ist, dass Online-Lernen flexibel ist.",
            answer: "Vorteil",
            hint: "Danh t·ª´ nam '∆∞u ƒëi·ªÉm'",
            timeLimit: 15,
            explanation:
              "'der Vorteil' - n√™u ∆∞u ƒëi·ªÉm. T∆∞∆°ng t·ª±: 'der Nachteil' (nh∆∞·ª£c ƒëi·ªÉm).",
          },
          {
            question: "Ich bin damit _____.",
            answer: "einverstanden",
            hint: "T√≠nh t·ª´ 'ƒë·ªìng √Ω', kh√¥ng vi·∫øt hoa",
            timeLimit: 15,
            explanation:
              "'einverstanden' - t√≠nh t·ª´ n√™n vi·∫øt th∆∞·ªùng trong c·ª•m 'Ich bin damit einverstanden'.",
          },
          {
            question: "In meinem _____ ist die Situation anders.",
            answer: "Heimatland",
            hint: "Danh t·ª´ trung t√≠nh 'qu√™ h∆∞∆°ng'",
            timeLimit: 15,
            explanation:
              "'das Heimatland' - n√≥i v·ªÅ qu√™ nh√† trong Teil 2, Folie 3.",
          },
          {
            question: "Ich _____ gern eine Frage f√ºr Sie.",
            answer: "h√§tte",
            hint: "haben ·ªü Konjunktiv II ng√¥i ich",
            timeLimit: 15,
            explanation:
              "'h√§tte' - Konjunktiv II c·ªßa haben, th·ªÉ hi·ªán l·ªãch s·ª± khi ƒë·∫∑t c√¢u h·ªèi.",
          },
          {
            question: "Damit komme ich zum _____ meiner Pr√§sentation.",
            answer: "Schluss",
            hint: "Danh t·ª´ nam 'k·∫øt th√∫c'",
            timeLimit: 15,
            explanation: "'der Schluss' - 'zum Schluss' = ƒë·∫øn ph·∫ßn k·∫øt th√∫c.",
          },
          {
            question: "K√∂nnten Sie das bitte _____?",
            answer: "wiederholen",
            hint: "ƒê·ªông t·ª´ nguy√™n th·ªÉ 'l·∫∑p l·∫°i'",
            timeLimit: 15,
            explanation:
              "'wiederholen' - kh√¥ng ph·∫£i separable verb n√™n gi·ªØ nguy√™n d·∫°ng.",
          },
          // Th√™m 20 c√¢u n·ªØa...
          {
            question: "Nein, das finde ich nicht so _____.",
            answer: "gut",
            hint: "T√≠nh t·ª´ 't·ªët'",
            timeLimit: 15,
            explanation:
              "'gut' - t·ª´ ch·ªëi l·ªãch s·ª±: 'das finde ich nicht so gut'.",
          },
          {
            question: "Was _____ du davon?",
            answer: "h√§ltst",
            hint: "halten - chia ng√¥i du",
            timeLimit: 15,
            explanation:
              "'h√§ltst' - 'Was h√§ltst du davon?' = B·∫°n nghƒ© sao v·ªÅ ƒëi·ªÅu ƒë√≥?",
          },
          {
            question: "Vielen Dank f√ºrs _____!",
            answer: "Zuh√∂ren",
            hint: "ƒê·ªông t·ª´ danh t·ª´ h√≥a 'nghe'",
            timeLimit: 15,
            explanation:
              "'Zuh√∂ren' - danh t·ª´ h√≥a t·ª´ 'zuh√∂ren', vi·∫øt hoa. 'f√ºrs' = 'f√ºr das'.",
          },
          {
            question:
              "_____ freut mich, dass Ihnen meine Pr√§sentation gefallen hat.",
            answer: "Es",
            hint: "ƒê·∫°i t·ª´ ng√¥i 3 trung t√≠nh",
            timeLimit: 15,
            explanation: "'Es freut mich' - c·ª•m c·ªë ƒë·ªãnh = T√¥i vui m·ª´ng.",
          },
          {
            question: "Ich m√∂chte gern _____ essen gehen.",
            answer: "au√üen",
            hint: "Tr·∫°ng t·ª´ 'b√™n ngo√†i'",
            timeLimit: 15,
            explanation: "'au√üen essen gehen' = ƒëi ƒÉn ·ªü ngo√†i (nh√† h√†ng).",
          },
        ],
        "sentence-builder": [
          // 30 c√¢u x·∫øp c√¢u
          {
            question: "S·∫Øp x·∫øp th√†nh c√¢u ƒë√∫ng (ƒê·ªÅ xu·∫•t):",
            words: [
              "Ich",
              "schlage",
              "vor,",
              "dass",
              "wir",
              "nach",
              "Berlin",
              "fahren.",
            ],
            correct: "Ich schlage vor, dass wir nach Berlin fahren.",
            timeLimit: 25,
            explanation:
              "'Ich schlage vor, dass...' + m·ªánh ƒë·ªÅ ph·ª• (ƒë·ªông t·ª´ cu·ªëi).",
          },
          {
            question: "S·∫Øp x·∫øp th√†nh c√¢u ƒë√∫ng (Gi·ªõi thi·ªáu):",
            words: [
              "Meine",
              "Pr√§sentation",
              "ist",
              "zu",
              "dem",
              "Thema:",
              "Sport.",
            ],
            correct: "Meine Pr√§sentation ist zu dem Thema: Sport.",
            timeLimit: 25,
            explanation: "Gi·ªõi thi·ªáu ch·ªß ƒë·ªÅ: 'zu dem Thema' ho·∫∑c 'zum Thema'.",
          },
          {
            question: "S·∫Øp x·∫øp th√†nh c√¢u ƒë√∫ng (ƒê·ªìng √Ω):",
            words: ["Das", "ist", "eine", "gute", "Idee!"],
            correct: "Das ist eine gute Idee!",
            timeLimit: 25,
            explanation: "C√°ch ƒë·ªìng √Ω ƒë∆°n gi·∫£n v√† hi·ªáu qu·∫£ nh·∫•t.",
          },
          {
            question: "S·∫Øp x·∫øp th√†nh c√¢u ƒë√∫ng (Kinh nghi·ªám):",
            words: [
              "Was",
              "mich",
              "betrifft,",
              "ich",
              "lerne",
              "gern",
              "Deutsch.",
            ],
            correct: "Was mich betrifft, ich lerne gern Deutsch.",
            timeLimit: 25,
            explanation: "Sau d·∫•u ph·∫©y b·∫Øt ƒë·∫ßu m·ªánh ƒë·ªÅ m·ªõi v·ªõi ch·ªß ng·ªØ 'ich'.",
          },
          {
            question: "S·∫Øp x·∫øp th√†nh c√¢u ƒë√∫ng (∆Øu ƒëi·ªÉm):",
            words: [
              "Ein",
              "Vorteil",
              "ist,",
              "dass",
              "man",
              "flexibel",
              "lernen",
              "kann.",
            ],
            correct: "Ein Vorteil ist, dass man flexibel lernen kann.",
            timeLimit: 25,
            explanation:
              "M·ªánh ƒë·ªÅ 'dass': ƒë·ªông t·ª´ chia + ƒë·ªông t·ª´ nguy√™n th·ªÉ ·ªü cu·ªëi.",
          },
          {
            question: "S·∫Øp x·∫øp th√†nh c√¢u ƒë√∫ng (ƒê·∫∑t c√¢u h·ªèi):",
            words: ["Ich", "h√§tte", "gern", "eine", "Frage", "f√ºr", "Sie."],
            correct: "Ich h√§tte gern eine Frage f√ºr Sie.",
            timeLimit: 25,
            explanation: "Konjunktiv II 'h√§tte' th·ªÉ hi·ªán l·ªãch s·ª±.",
          },
          {
            question: "S·∫Øp x·∫øp th√†nh c√¢u ƒë√∫ng (Qu√™ nh√†):",
            words: [
              "In",
              "meinem",
              "Heimatland",
              "ist",
              "die",
              "Situation",
              "anders.",
            ],
            correct: "In meinem Heimatland ist die Situation anders.",
            timeLimit: 25,
            explanation: "M√¥ t·∫£ t√¨nh h√¨nh kh√°c bi·ªát ·ªü qu√™ nh√†.",
          },
          {
            question: "S·∫Øp x·∫øp th√†nh c√¢u ƒë√∫ng (T·ª´ ch·ªëi):",
            words: ["Nein,", "das", "finde", "ich", "nicht", "so", "gut."],
            correct: "Nein, das finde ich nicht so gut.",
            timeLimit: 25,
            explanation: "T·ª´ ch·ªëi l·ªãch s·ª±, sau ƒë√≥ PH·∫¢I n√™u l√Ω do v·ªõi 'weil'.",
          },
          {
            question: "S·∫Øp x·∫øp th√†nh c√¢u ƒë√∫ng (C·∫£m ∆°n):",
            words: ["Vielen", "Dank", "f√ºrs", "Zuh√∂ren!"],
            correct: "Vielen Dank f√ºrs Zuh√∂ren!",
            timeLimit: 25,
            explanation: "'f√ºrs' = 'f√ºr das' - c·∫£m ∆°n vi·ªác l·∫Øng nghe.",
          },
          {
            question: "S·∫Øp x·∫øp th√†nh c√¢u ƒë√∫ng (ƒê·ªìng √Ω m·∫°nh):",
            words: ["Ich", "bin", "damit", "einverstanden."],
            correct: "Ich bin damit einverstanden.",
            timeLimit: 25,
            explanation: "'damit' ch·ªâ v·ªÅ ƒë·ªÅ xu·∫•t v·ª´a ƒë∆∞·ª£c n√™u ra.",
          },
        ],
        matching: [
          // 20 v√≤ng matching v·ªõi timer
          {
            pairs: [
              { de: "Ich schlage vor, dass...", vi: "T√¥i ƒë·ªÅ xu·∫•t r·∫±ng..." },
              { de: "Das ist eine gute Idee!", vi: "ƒê√≥ l√† m·ªôt √Ω t∆∞·ªüng hay!" },
              { de: "Was h√§ltst du davon?", vi: "B·∫°n nghƒ© sao v·ªÅ ƒëi·ªÅu ƒë√≥?" },
              { de: "Ich bin einverstanden.", vi: "T√¥i ƒë·ªìng √Ω." },
              { de: "Was mich betrifft...", vi: "V·ªÅ ph·∫ßn t√¥i..." },
            ],
            timeLimit: 40,
          },
          {
            pairs: [
              { de: "Ein Vorteil ist, dass...", vi: "M·ªôt ∆∞u ƒëi·ªÉm l√†..." },
              { de: "Ein Nachteil ist, dass...", vi: "M·ªôt nh∆∞·ª£c ƒëi·ªÉm l√†..." },
              { de: "In meinem Heimatland...", vi: "·ªû qu√™ h∆∞∆°ng t√¥i..." },
              { de: "Meiner Meinung nach...", vi: "Theo √Ω ki·∫øn c·ªßa t√¥i..." },
              {
                de: "Zum Schluss m√∂chte ich sagen...",
                vi: "Cu·ªëi c√πng t√¥i mu·ªën n√≥i...",
              },
            ],
            timeLimit: 40,
          },
          {
            pairs: [
              { de: "Ich h√§tte gern eine Frage.", vi: "T√¥i mu·ªën h·ªèi m·ªôt c√¢u." },
              {
                de: "Vielen Dank f√ºr Ihre Frage.",
                vi: "C·∫£m ∆°n c√¢u h·ªèi c·ªßa b·∫°n.",
              },
              { de: "Das ist interessant.", vi: "ƒêi·ªÅu ƒë√≥ th·∫≠t th√∫ v·ªã." },
              {
                de: "K√∂nnten Sie das wiederholen?",
                vi: "B·∫°n c√≥ th·ªÉ nh·∫Øc l·∫°i ƒë∆∞·ª£c kh√¥ng?",
              },
              { de: "Ich verstehe nicht ganz.", vi: "T√¥i kh√¥ng hi·ªÉu h·∫≥n." },
            ],
            timeLimit: 40,
          },
          // Th√™m 17 rounds n·ªØa...
          {
            pairs: [
              { de: "Au√üerdem...", vi: "H∆°n n·ªØa..." },
              {
                de: "Einerseits... andererseits...",
                vi: "M·ªôt m·∫∑t... m·∫∑t kh√°c...",
              },
              { de: "Auf der einen Seite...", vi: "V·ªÅ m·ªôt m·∫∑t..." },
              { de: "Genau wie in Deutschland...", vi: "Gi·ªëng nh∆∞ ·ªü ƒê·ª©c..." },
              { de: "Im Gegensatz zu...", vi: "Tr√°i ng∆∞·ª£c v·ªõi..." },
            ],
            timeLimit: 40,
          },
          {
            pairs: [
              { de: "Zuerst m√∂chte ich...", vi: "ƒê·∫ßu ti√™n t√¥i mu·ªën..." },
              { de: "Dann werde ich...", vi: "Sau ƒë√≥ t√¥i s·∫Ω..." },
              { de: "Anschlie√üend...", vi: "Ti·∫øp theo..." },
              { de: "Zum Schluss...", vi: "Cu·ªëi c√πng..." },
              {
                de: "Abschlie√üend m√∂chte ich sagen...",
                vi: "K·∫øt th√∫c t√¥i mu·ªën n√≥i...",
              },
            ],
            timeLimit: 40,
          },
        ],
        "situation-response": [
          // 30 t√¨nh hu·ªëng ph·∫£n ·ª©ng
          {
            situation:
              "Partner: 'Ich schlage vor, dass wir mit dem Zug fahren, weil das umweltfreundlich ist. Was meinst du?'",
            scenario: "B·∫°n ƒë·ªìng √Ω v√† b·ªï sung l√Ω do",
            options: [
              "Das ist eine gute Idee! Au√üerdem ist der Zug auch bequemer als das Auto. Wann fahren wir?",
              "Nein, das finde ich nicht so gut. Ich w√ºrde lieber mit dem Auto fahren.",
              "Ich wei√ü nicht. Vielleicht k√∂nnen wir sp√§ter entscheiden.",
              "Das verstehe ich nicht. Kannst du das wiederholen?",
            ],
            correct: 0,
            timeLimit: 25,
            explanation:
              "ƒê·ªìng √Ω + th√™m l√Ω do (Au√üerdem) + h·ªèi chi ti·∫øt ti·∫øp theo.",
          },
          {
            situation:
              "Partner: 'Wir k√∂nnten im Hotel √ºbernachten. Das ist am bequemsten.'",
            scenario: "B·∫°n t·ª´ ch·ªëi v√¨ ƒë·∫Øt, ƒë·ªÅ xu·∫•t nh√† tr·∫ª",
            options: [
              "Ja, das stimmt! Hotels sind immer die beste Option.",
              "Nein, das finde ich nicht so gut, weil Hotels zu teuer sind. Ich schlage vor, dass wir in der Jugendherberge √ºbernachten. Das ist billiger. Was h√§ltst du davon?",
              "Ich bin einverstanden. Das machen wir!",
              "Super! Dann buche ich gleich ein Hotelzimmer.",
            ],
            correct: 1,
            timeLimit: 25,
            explanation:
              "T·ª´ ch·ªëi + l√Ω do + ƒë·ªÅ xu·∫•t thay th·∫ø + h·ªèi √Ω ki·∫øn (5 c√¢u).",
          },
          {
            situation: "Gi√°m kh·∫£o: 'Warum haben Sie dieses Thema gew√§hlt?'",
            scenario: "Teil 3 - Gi·∫£i th√≠ch l√Ω do ch·ªçn ch·ªß ƒë·ªÅ",
            options: [
              "Ich wei√ü nicht. Das war nur ein Zufall.",
              "Weil ich das Thema sehr interessant finde und pers√∂nliche Erfahrung damit habe. Au√üerdem ist dieses Thema in meinem Heimatland sehr aktuell.",
              "Das m√∂chte ich nicht sagen.",
              "K√∂nnen Sie die Frage wiederholen?",
            ],
            correct: 1,
            timeLimit: 25,
            explanation:
              "ƒê∆∞a ra 2 l√Ω do: s·ªü th√≠ch c√° nh√¢n + t√≠nh th·ªùi s·ª± ·ªü qu√™ nh√†.",
          },
          {
            situation: "Partner: 'Was k√∂nnen wir dort machen?'",
            scenario: "ƒê·ªÅ xu·∫•t nhi·ªÅu ho·∫°t ƒë·ªông",
            options: [
              "Ich wei√ü es nicht genau.",
              "Wir k√∂nnten wandern gehen und die Natur genie√üen. Au√üerdem gibt es dort auch interessante Museen. Was meinst du?",
              "Das ist mir egal. Du kannst entscheiden.",
              "Vielleicht nichts Besonderes.",
            ],
            correct: 1,
            timeLimit: 25,
            explanation:
              "ƒê∆∞a ra 2-3 ho·∫°t ƒë·ªông v·ªõi 'Wir k√∂nnten...' + 'Au√üerdem' + h·ªèi √Ω ki·∫øn.",
          },
          {
            situation: "Partner: 'Nein, ich finde das nicht so gut.'",
            scenario: "Ch·∫•p nh·∫≠n v√† h·ªèi ƒë·ªÅ xu·∫•t m·ªõi",
            options: [
              "Warum nicht? Du musst mir zustimmen!",
              "Okay, das ist kein Problem. Was w√§re denn dein Vorschlag?",
              "Das ist dumm. Meine Idee ist besser.",
              "Dann machen wir gar nichts!",
            ],
            correct: 1,
            timeLimit: 25,
            explanation:
              "Th·ªÉ hi·ªán linh ho·∫°t: 'das ist kein Problem' + h·ªèi ƒë·ªÅ xu·∫•t thay th·∫ø.",
          },
          {
            situation: "B·∫°n v·ª´a k·∫øt th√∫c Teil 2",
            scenario: "K·∫øt th√∫c b√†i thuy·∫øt tr√¨nh",
            options: [
              "Ich gehe jetzt. Auf Wiedersehen!",
              "Hiermit ist meine Pr√§sentation zu Ende. Vielen Dank f√ºrs Zuh√∂ren! Haben Sie noch Fragen?",
              "Das war's. Fertig.",
              "Ich habe nichts mehr zu sagen.",
            ],
            correct: 1,
            timeLimit: 25,
            explanation: "Ba y·∫øu t·ªë: tuy√™n b·ªë k·∫øt th√∫c + c·∫£m ∆°n + m·ªùi c√¢u h·ªèi.",
          },
        ],
        "speed-round": [
          // Unlimited quick questions
          { q: "ƒê·ªÅ xu·∫•t: Ich _____ vor", a: "schlage" },
          { q: "ƒê·ªìng √Ω: Das ist eine gute _____", a: "Idee" },
          { q: "H·ªèi √Ω ki·∫øn: Was _____ du davon?", a: "h√§ltst" },
          { q: "Ch·ªß ƒë·ªÅ: zu dem _____", a: "Thema" },
          { q: "∆Øu ƒëi·ªÉm: Ein _____", a: "Vorteil" },
          { q: "Nh∆∞·ª£c ƒëi·ªÉm: Ein _____", a: "Nachteil" },
          { q: "Qu√™ h∆∞∆°ng: mein _____", a: "Heimatland" },
          { q: "T·ª´ ch·ªëi: nicht so _____", a: "gut" },
          { q: "√ù ki·∫øn: Meiner _____", a: "Meinung" },
          { q: "Kinh nghi·ªám: Was mich _____", a: "betrifft" },
          { q: "C√¢u h·ªèi: Ich _____ gern", a: "h√§tte" },
          { q: "C·∫£m ∆°n: Vielen _____", a: "Dank" },
          { q: "ƒê·ªìng √Ω: Ich bin _____", a: "einverstanden" },
          { q: "L·∫∑p l·∫°i: _____?", a: "wiederholen" },
          { q: "K·∫øt th√∫c: Zum _____", a: "Schluss" },
          { q: "H∆°n n·ªØa: _____", a: "Au√üerdem" },
          { q: "V√¨ v·∫≠y: _____", a: "deshalb" },
          { q: "Tuy nhi√™n: _____", a: "jedoch" },
          { q: "V√≠ d·ª•: zum _____", a: "Beispiel" },
          { q: "ƒê·∫ßu ti√™n: _____", a: "Zuerst" },
        ],
        "teil2-practice": [
          // 25 c√¢u v·ªÅ c·∫•u tr√∫c Teil 2
          {
            question:
              "Folie 1: B·∫°n mu·ªën ch√†o h·ªèi kh√°n gi·∫£. Ch·ªçn c√°ch n√†o ph√π h·ª£p nh·∫•t?",
            context: "M·ªü ƒë·∫ßu b√†i thuy·∫øt tr√¨nh Teil 2",
            options: [
              "Liebe Zuh√∂rer! Ich begr√º√üe Sie ganz herzlich.",
              "Hallo zusammen! Was geht?",
              "Guten Tag. Ich bin fertig.",
              "Hey! Lasst uns anfangen.",
            ],
            correct: 0,
            timeLimit: 20,
            explanation:
              "Ch√†o h·ªèi trang tr·ªçng: 'Liebe Zuh√∂rer' + 'Ich begr√º√üe Sie ganz herzlich'.",
          },
          {
            question: "Folie 1: Sau khi ch√†o, b·∫°n c·∫ßn l√†m g√¨?",
            context: "Gi·ªõi thi·ªáu ch·ªß ƒë·ªÅ",
            options: [
              "K·∫øt th√∫c ngay",
              "N√™u ch·ªß ƒë·ªÅ: 'Meine Pr√§sentation ist zu dem Thema: ...'",
              "K·ªÉ chuy·ªán c√° nh√¢n",
              "H·ªèi kh√°n gi·∫£",
            ],
            correct: 1,
            timeLimit: 20,
            explanation: "Lu√¥n gi·ªõi thi·ªáu ch·ªß ƒë·ªÅ ngay sau ph·∫ßn ch√†o h·ªèi.",
          },
          {
            question: "Folie 1: Sau khi n√™u ch·ªß ƒë·ªÅ, b·∫°n n√™n l√†m g√¨?",
            context: "Gi·ªõi thi·ªáu c·∫•u tr√∫c",
            options: [
              "K·∫øt th√∫c b√†i thuy·∫øt tr√¨nh",
              "Gi·ªõi thi·ªáu c·∫•u tr√∫c: 'Mein Vortrag besteht aus folgenden Teilen...'",
              "B·∫Øt ƒë·∫ßu n√≥i v·ªÅ kinh nghi·ªám ngay",
              "C·∫£m ∆°n kh√°n gi·∫£",
            ],
            correct: 1,
            timeLimit: 20,
            explanation:
              "Ph·∫£i gi·ªõi thi·ªáu c·∫•u tr√∫c b√†i: kinh nghi·ªám ‚Üí qu√™ nh√† ‚Üí ∆∞u/nh∆∞·ª£c ƒëi·ªÉm ‚Üí √Ω ki·∫øn.",
          },
          {
            question: "Folie 2: B·∫Øt ƒë·∫ßu ph·∫ßn kinh nghi·ªám v·ªõi c·ª•m n√†o?",
            context: "Chia s·∫ª kinh nghi·ªám c√° nh√¢n",
            options: [
              "In meinem Heimatland...",
              "Was mich betrifft, ich...",
              "Ein Vorteil ist...",
              "Zum Schluss...",
            ],
            correct: 1,
            timeLimit: 20,
            explanation:
              "'Was mich betrifft' (V·ªÅ ph·∫ßn t√¥i) m·ªü ƒë·∫ßu ph·∫ßn kinh nghi·ªám.",
          },
          {
            question: "Folie 3: N√≥i v·ªÅ t√¨nh h√¨nh qu√™ nh√† b·∫±ng c·ª•m n√†o?",
            context: "So s√°nh v·ªõi ƒê·ª©c",
            options: [
              "Was mich betrifft...",
              "In meinem Heimatland ist die Situation...",
              "Ein Nachteil ist...",
              "Ich h√§tte gern...",
            ],
            correct: 1,
            timeLimit: 20,
            explanation:
              "'In meinem Heimatland' ƒë·ªÉ gi·ªõi thi·ªáu t√¨nh h√¨nh ·ªü qu√™ nh√†.",
          },
        ],
      };

      // Timer Functions
      function startQuestionTimer(timeLimit) {
        gameState.timeLeft = timeLimit;
        gameState.questionStartTime = Date.now();

        const timerEl = document.querySelector(".question-timer");
        if (timerEl) {
          timerEl.textContent = timeLimit + "s";
        }

        gameState.questionTimer = setInterval(() => {
          gameState.timeLeft--;
          const timerEl = document.querySelector(".question-timer");

          if (timerEl) {
            timerEl.textContent = gameState.timeLeft + "s";

            if (gameState.timeLeft <= 5) {
              timerEl.classList.add("warning");
            }
          }

          if (gameState.timeLeft <= 0) {
            clearInterval(gameState.questionTimer);
            // Auto submit with wrong answer
            gameState.selectedAnswer = -1;
            checkAnswer();
          }
        }, 1000);
      }

      function stopQuestionTimer() {
        if (gameState.questionTimer) {
          clearInterval(gameState.questionTimer);
        }

        // Calculate time taken
        const timeTaken = Math.round(
          (Date.now() - gameState.questionStartTime) / 1000
        );
        gameState.questionTimes.push(timeTaken);
        gameState.totalTime += timeTaken;

        // Update average time
        const avgTime = Math.round(
          gameState.totalTime / gameState.questionTimes.length
        );
        document.getElementById("avgTime").textContent = avgTime + "s";
      }

      // Start Game
      function startGame(mode) {
        gameState.mode = mode;
        gameState.currentQuestion = 0;
        gameState.score = 0;
        gameState.correct = 0;
        gameState.wrong = 0;
        gameState.streak = 0;
        gameState.selectedAnswer = null;
        gameState.totalTime = 0;
        gameState.questionTimes = [];

        // Set total questions based on mode
        const questionCounts = {
          "dialogue-practice": 50,
          "multiple-choice": 40,
          "fill-blank": 30,
          "sentence-builder": 30,
          matching: 20,
          "situation-response": 30,
          "speed-round": 999,
          "teil2-practice": 25,
        };

        gameState.totalQuestions = questionCounts[mode] || 10;

        document.getElementById("menuScreen").classList.remove("active");
        document.getElementById("gameScreen").classList.add("active");

        if (mode === "speed-round") {
          gameState.timeLeft = 60;
          startSpeedRoundTimer();
        }

        loadQuestion();
      }

      // Speed Round Timer
      function startSpeedRoundTimer() {
        gameState.timerInterval = setInterval(() => {
          gameState.timeLeft--;

          const timerEl = document.querySelector(".question-timer");
          if (timerEl) {
            timerEl.textContent = gameState.timeLeft + "s";

            if (gameState.timeLeft <= 10) {
              timerEl.classList.add("warning");
            }
          }

          if (gameState.timeLeft <= 0) {
            clearInterval(gameState.timerInterval);
            showResults();
          }
        }, 1000);
      }

      // Load Question
      function loadQuestion() {
        const mode = gameState.mode;
        const questionIndex = gameState.currentQuestion;
        const gameArea = document.getElementById("gameArea");
        const feedbackBox = document.getElementById("feedbackBox");

        feedbackBox.classList.remove("show");
        document.getElementById("submitBtn").style.display = "block";
        document.getElementById("nextBtn").style.display = "none";
        gameState.selectedAnswer = null;

        // Stop previous timer
        if (gameState.questionTimer) {
          clearInterval(gameState.questionTimer);
        }

        // Update progress
        const progress = ((questionIndex + 1) / gameState.totalQuestions) * 100;
        document.getElementById("progressFill").style.width = progress + "%";
        document.getElementById("progressFill").textContent = `C√¢u ${
          questionIndex + 1
        }/${gameState.totalQuestions}`;

        let html = "";
        const questions = questionBanks[mode];
        const q = questions[questionIndex % questions.length];

        // Add timer for all modes except speed-round
        if (mode !== "speed-round" && q.timeLimit) {
          startQuestionTimer(q.timeLimit);
        }

        if (mode === "dialogue-practice") {
          html = `
                    <div class="question-card">
                        ${
                          q.timeLimit
                            ? `<div class="question-timer">${q.timeLimit}s</div>`
                            : ""
                        }
                        <div class="context-box">
                            <strong>üéØ B·ªëi c·∫£nh:</strong> ${q.context}
                        </div>
                        <div class="dialogue-box">
                            ${q.dialogue
                              .map(
                                (turn) => `
                                <div class="dialogue-turn ${
                                  turn.speaker === "B·∫°n" ? "your-turn" : ""
                                }">
                                    <div class="speaker-icon">${turn.icon}</div>
                                    <div class="speaker-name">${
                                      turn.speaker
                                    }:</div>
                                    <div class="dialogue-text">${
                                      turn.text
                                    }</div>
                                </div>
                            `
                              )
                              .join("")}
                        </div>
                        <div class="question-text">üí¨ ${q.question}</div>
                        <div class="options-grid">
                            ${q.options
                              .map(
                                (opt, i) => `
                                <div class="option-btn" onclick="selectOption(${i})">
                                    ${opt}
                                </div>
                            `
                              )
                              .join("")}
                        </div>
                    </div>
                `;
        } else if (
          mode === "multiple-choice" ||
          mode === "situation-response" ||
          mode === "teil2-practice"
        ) {
          html = `
                    <div class="question-card">
                        ${
                          q.timeLimit
                            ? `<div class="question-timer">${q.timeLimit}s</div>`
                            : ""
                        }
                        ${
                          q.context
                            ? `<div class="context-box"><strong>üìù Context:</strong> ${q.context}</div>`
                            : ""
                        }
                        ${
                          q.situation
                            ? `<div class="situation"><strong>üé¨ T√¨nh hu·ªëng:</strong><br>${q.situation}</div>`
                            : ""
                        }
                        ${
                          q.scenario
                            ? `<div class="hint-box"><strong>üìù Nhi·ªám v·ª•:</strong> ${q.scenario}</div>`
                            : ""
                        }
                        <div class="question-text">${q.question}</div>
                        <div class="options-grid">
                            ${q.options
                              .map(
                                (opt, i) => `
                                <div class="option-btn" onclick="selectOption(${i})">
                                    ${opt}
                                </div>
                            `
                              )
                              .join("")}
                        </div>
                    </div>
                `;
        } else if (mode === "fill-blank") {
          html = `
                    <div class="question-card">
                        ${
                          q.timeLimit
                            ? `<div class="question-timer">${q.timeLimit}s</div>`
                            : ""
                        }
                        <div class="question-text">${q.question}</div>
                        <div class="hint-box">üí° G·ª£i √Ω: ${q.hint}</div>
                        <input type="text" class="fill-blank-input" id="answerInput" 
                               placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi..." 
                               onkeypress="if(event.key==='Enter') checkAnswer()">
                    </div>
                `;
        } else if (mode === "sentence-builder") {
          const shuffled = [...q.words].sort(() => Math.random() - 0.5);
          html = `
                    <div class="question-card">
                        ${
                          q.timeLimit
                            ? `<div class="question-timer">${q.timeLimit}s</div>`
                            : ""
                        }
                        <div class="question-text">${q.question}</div>
                        <div class="sentence-builder" id="sentenceBuilder"></div>
                        <div class="word-bank">
                            ${shuffled
                              .map(
                                (word) => `
                                <div class="draggable-word" onclick="addToSentence(this)">${word}</div>
                            `
                              )
                              .join("")}
                        </div>
                    </div>
                `;
        } else if (mode === "matching") {
          gameState.matchingPairs = q.pairs;
          const shuffledLeft = [...q.pairs].sort(() => Math.random() - 0.5);
          const shuffledRight = [...q.pairs].sort(() => Math.random() - 0.5);

          html = `
                    <div class="question-card">
                        ${
                          q.timeLimit
                            ? `<div class="question-timer">${q.timeLimit}s</div>`
                            : ""
                        }
                        <div class="question-text">‚ö° Gh√©p c·∫∑p Ti·∫øng ƒê·ª©c - Ti·∫øng Vi·ªát nhanh nh·∫•t c√≥ th·ªÉ!</div>
                        <div class="matching-game">
                            <div class="matching-column" id="leftColumn">
                                ${shuffledLeft
                                  .map(
                                    (pair, i) => `
                                    <div class="match-item" data-text="${pair.de}" onclick="selectMatch(this, 'left')">
                                        ${pair.de}
                                    </div>
                                `
                                  )
                                  .join("")}
                            </div>
                            <div class="matching-column" id="rightColumn">
                                ${shuffledRight
                                  .map(
                                    (pair, i) => `
                                    <div class="match-item" data-text="${pair.vi}" onclick="selectMatch(this, 'right')">
                                        ${pair.vi}
                                    </div>
                                `
                                  )
                                  .join("")}
                            </div>
                        </div>
                    </div>
                `;
          gameState.matchingState = {
            selectedLeft: null,
            selectedRight: null,
            matches: 0,
          };
          if (q.timeLimit) {
            startQuestionTimer(q.timeLimit);
          }
        } else if (mode === "speed-round") {
          html = `
                    <div class="question-card">
                        <div class="question-timer">${gameState.timeLeft}s</div>
                        <div class="question-text">${q.q}</div>
                        <input type="text" class="fill-blank-input" id="answerInput" 
                               placeholder="Tr·∫£ l·ªùi nhanh!" 
                               onkeypress="if(event.key==='Enter') checkAnswer()"
                               autofocus>
                    </div>
                `;
        }

        gameArea.innerHTML = html;

        if (mode === "fill-blank" || mode === "speed-round") {
          setTimeout(
            () => document.getElementById("answerInput")?.focus(),
            100
          );
        }
      }

      // Select Option
      function selectOption(index) {
        gameState.selectedAnswer = index;
        document.querySelectorAll(".option-btn").forEach((btn, i) => {
          btn.style.background =
            i === index
              ? "linear-gradient(135deg, #667eea 0%, #764ba2 100%)"
              : "white";
          btn.style.color = i === index ? "white" : "#333";
        });
      }

      // Add word to sentence (for sentence builder)
      function addToSentence(wordEl) {
        if (wordEl.classList.contains("used")) return;

        const builder = document.getElementById("sentenceBuilder");
        const clone = wordEl.cloneNode(true);

        clone.onclick = function () {
          wordEl.classList.remove("used");
          this.remove();
        };

        builder.appendChild(clone);
        wordEl.classList.add("used");
      }

      // Matching game functions
      function selectMatch(element, side) {
        if (element.classList.contains("matched")) return;

        const column = side === "left" ? "leftColumn" : "rightColumn";
        document.querySelectorAll(`#${column} .match-item`).forEach((item) => {
          if (!item.classList.contains("matched")) {
            item.classList.remove("selected");
          }
        });

        element.classList.add("selected");

        if (side === "left") {
          gameState.matchingState.selectedLeft = element.dataset.text;
        } else {
          gameState.matchingState.selectedRight = element.dataset.text;
        }

        if (
          gameState.matchingState.selectedLeft &&
          gameState.matchingState.selectedRight
        ) {
          checkMatch();
        }
      }

      function checkMatch() {
        const leftText = gameState.matchingState.selectedLeft;
        const rightText = gameState.matchingState.selectedRight;

        const pair = gameState.matchingPairs.find(
          (p) => p.de === leftText && p.vi === rightText
        );

        const leftEl = document.querySelector(
          `#leftColumn .match-item[data-text="${leftText}"]`
        );
        const rightEl = document.querySelector(
          `#rightColumn .match-item[data-text="${rightText}"]`
        );

        if (pair) {
          leftEl.classList.add("matched");
          rightEl.classList.add("matched");
          leftEl.classList.remove("selected");
          rightEl.classList.remove("selected");

          gameState.matchingState.matches++;
          gameState.score += 10;
          gameState.correct++;
          gameState.streak++;
          updateStats();

          if (gameState.matchingState.matches === 5) {
            stopQuestionTimer();
            setTimeout(() => {
              showFeedback(true, "matching", 0);
              document.getElementById("submitBtn").style.display = "none";
              document.getElementById("nextBtn").style.display = "block";
            }, 500);
          }
        } else {
          leftEl.style.animation = "wrongShake 0.5s";
          rightEl.style.animation = "wrongShake 0.5s";

          setTimeout(() => {
            leftEl.classList.remove("selected");
            rightEl.classList.remove("selected");
            leftEl.style.animation = "";
            rightEl.style.animation = "";
          }, 500);

          gameState.wrong++;
          gameState.streak = 0;
          updateStats();
        }

        gameState.matchingState.selectedLeft = null;
        gameState.matchingState.selectedRight = null;
      }

      // Check Answer
      function checkAnswer() {
        stopQuestionTimer();

        const mode = gameState.mode;
        const questionIndex = gameState.currentQuestion;
        let isCorrect = false;
        let userAnswer = "";

        const questions = questionBanks[mode];
        const q = questions[questionIndex % questions.length];

        if (
          mode === "multiple-choice" ||
          mode === "situation-response" ||
          mode === "dialogue-practice" ||
          mode === "teil2-practice"
        ) {
          if (gameState.selectedAnswer === -1) {
            isCorrect = false; // Timeout
          } else {
            isCorrect = gameState.selectedAnswer === q.correct;
          }

          document.querySelectorAll(".option-btn").forEach((btn, i) => {
            if (i === q.correct) {
              btn.classList.add("correct");
            } else if (i === gameState.selectedAnswer && !isCorrect) {
              btn.classList.add("wrong");
            }
            btn.style.pointerEvents = "none";
          });
        } else if (mode === "fill-blank") {
          userAnswer = document
            .getElementById("answerInput")
            .value.trim()
            .toLowerCase();
          isCorrect = userAnswer === q.answer.toLowerCase();

          document.getElementById("answerInput").style.borderColor = isCorrect
            ? "#28a745"
            : "#dc3545";
          document.getElementById("answerInput").disabled = true;
        } else if (mode === "speed-round") {
          userAnswer = document
            .getElementById("answerInput")
            .value.trim()
            .toLowerCase();
          isCorrect = userAnswer === q.a.toLowerCase();

          if (isCorrect) {
            gameState.currentQuestion++;
            gameState.score += 10;
            gameState.correct++;
            gameState.streak++;

            if (gameState.streak > gameState.bestStreak) {
              gameState.bestStreak = gameState.streak;
            }

            updateStats();

            if (gameState.timeLeft > 0) {
              loadQuestion();
            } else {
              showResults();
            }
            return;
          } else {
            gameState.wrong++;
            gameState.streak = 0;
            document.getElementById("answerInput").value = "";
            document.getElementById("answerInput").style.borderColor =
              "#dc3545";
            setTimeout(() => {
              document.getElementById("answerInput").style.borderColor =
                "#e0e0e0";
              document.getElementById("answerInput").focus();
            }, 500);
            updateStats();
            return;
          }
        } else if (mode === "sentence-builder") {
          const builder = document.getElementById("sentenceBuilder");
          userAnswer = Array.from(builder.children)
            .map((el) => el.textContent)
            .join(" ");
          isCorrect = userAnswer === q.correct;
        } else if (mode === "matching") {
          return; // Matching is handled separately
        }

        // Update score and streak
        if (isCorrect) {
          const timeBonusPoints = Math.max(0, gameState.timeLeft * 2);
          gameState.score += 10 + gameState.streak * 2 + timeBonusPoints;
          gameState.correct++;
          gameState.streak++;

          if (gameState.streak > gameState.bestStreak) {
            gameState.bestStreak = gameState.streak;
          }

          if (gameState.streak >= 3) {
            showCombo(gameState.streak);
          }
        } else {
          gameState.wrong++;
          gameState.streak = 0;
        }

        updateStats();
        showFeedback(isCorrect, mode, questionIndex);

        document.getElementById("submitBtn").style.display = "none";
        document.getElementById("nextBtn").style.display = "block";
      }

      // Show Feedback
      function showFeedback(isCorrect, mode, questionIndex) {
        const feedbackBox = document.getElementById("feedbackBox");
        const feedbackTitle = document.getElementById("feedbackTitle");
        const feedbackText = document.getElementById("feedbackText");

        let explanation = "";

        if (mode === "matching") {
          explanation = "B·∫°n ƒë√£ gh√©p ƒë√∫ng t·∫•t c·∫£ c√°c c·∫∑p!";
        } else {
          const questions = questionBanks[mode];
          const q = questions[questionIndex % questions.length];
          explanation = q.explanation || "";
        }

        if (isCorrect) {
          feedbackBox.className = "feedback-box correct show";
          feedbackTitle.textContent = "‚úÖ Ch√≠nh x√°c!";
          feedbackText.textContent = explanation;
        } else {
          feedbackBox.className = "feedback-box wrong show";
          feedbackTitle.textContent =
            gameState.selectedAnswer === -1 ? "‚è±Ô∏è H·∫øt gi·ªù!" : "‚ùå Ch∆∞a ƒë√∫ng";
          feedbackText.textContent = explanation;
        }
      }

      // Next Question
      function nextQuestion() {
        gameState.currentQuestion++;

        if (gameState.currentQuestion >= gameState.totalQuestions) {
          showResults();
        } else {
          loadQuestion();
        }
      }

      // Show Results
      function showResults() {
        if (gameState.timerInterval) {
          clearInterval(gameState.timerInterval);
        }
        if (gameState.questionTimer) {
          clearInterval(gameState.questionTimer);
        }

        document.getElementById("gameScreen").classList.remove("active");
        document.getElementById("resultsScreen").classList.add("active");

        const total = gameState.correct + gameState.wrong;
        const accuracy =
          total > 0 ? Math.round((gameState.correct / total) * 100) : 0;
        const avgTime =
          gameState.questionTimes.length > 0
            ? Math.round(gameState.totalTime / gameState.questionTimes.length)
            : 0;

        document.getElementById("finalScore").textContent = gameState.score;
        document.getElementById("correctCount").textContent = gameState.correct;
        document.getElementById("wrongCount").textContent = gameState.wrong;
        document.getElementById("finalAccuracy").textContent = accuracy + "%";
        document.getElementById("bestStreak").textContent =
          gameState.bestStreak;
        document.getElementById("finalAvgTime").textContent = avgTime + "s";

        // Performance message
        let message = "";
        let achievements = "";

        if (accuracy >= 90) {
          message = "üåü Xu·∫•t s·∫Øc! B·∫°n ƒë√£ th√†nh th·∫°o Redemittel!";
          achievements +=
            '<span class="achievement-badge">üèÜ B·∫≠c Th·∫ßy B1</span>';
        } else if (accuracy >= 75) {
          message = "üëç R·∫•t t·ªët! Ti·∫øp t·ª•c luy·ªán t·∫≠p!";
          achievements +=
            '<span class="achievement-badge">‚≠ê H·ªçc Vi√™n Gi·ªèi</span>';
        } else if (accuracy >= 60) {
          message = "üí™ Kh√° t·ªët! H√£y √¥n l·∫°i m·ªôt s·ªë ph·∫ßn.";
          achievements +=
            '<span class="achievement-badge">üìö H·ªçc Vi√™n ChƒÉm Ch·ªâ</span>';
        } else {
          message = "üìñ C·∫ßn c·ªë g·∫Øng th√™m! ƒê·ª´ng b·ªè cu·ªôc!";
        }

        if (gameState.bestStreak >= 5) {
          achievements +=
            '<span class="achievement-badge">üî• Streak Master</span>';
        }

        if (gameState.score >= 200) {
          achievements += '<span class="achievement-badge">üíØ ƒêi·ªÉm Cao</span>';
        }

        if (avgTime <= 10) {
          achievements +=
            '<span class="achievement-badge">‚ö° T·ªëc ƒê·ªô √Ånh S√°ng</span>';
        }

        document.getElementById("performanceMessage").textContent = message;
        document.getElementById("achievementsList").innerHTML = achievements;
      }

      // Update Stats
      function updateStats() {
        const total = gameState.correct + gameState.wrong;
        const accuracy =
          total > 0 ? Math.round((gameState.correct / total) * 100) : 0;

        document.getElementById("totalScore").textContent = gameState.score;
        document.getElementById("accuracy").textContent = accuracy + "%";
        document.getElementById("streak").textContent = gameState.streak;

        // Calculate level based on score
        gameState.level = Math.floor(gameState.score / 50) + 1;
        document.getElementById("level").textContent = gameState.level;
      }

      // Show Combo
      function showCombo(streak) {
        const comboCounter = document.getElementById("comboCounter");
        comboCounter.textContent = `üî• ${streak}x COMBO!`;
        comboCounter.classList.add("show");

        setTimeout(() => {
          comboCounter.classList.remove("show");
        }, 1000);
      }

      // Return to Menu
      function returnToMenu() {
        if (gameState.timerInterval) {
          clearInterval(gameState.timerInterval);
        }
        if (gameState.questionTimer) {
          clearInterval(gameState.questionTimer);
        }

        document
          .querySelectorAll(".menu-screen, .game-screen, .results-screen")
          .forEach((screen) => {
            screen.classList.remove("active");
          });

        document.getElementById("menuScreen").classList.add("active");
      }

      // Restart Game
      function restartGame() {
        startGame(gameState.mode);
      }

      // Initialize
      updateStats();
    </script>
  </body>
</html>
